{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"index.html","title":"\u4ecb\u7ecd","text":"ZgRoBot  <p> <p></p> <p><code>ZgRoBot</code> \u662f\u4e00\u4e2a\u57fa\u4e8e <code>WeRoBot</code> \u5f00\u53d1\u7684\u5fae\u4fe1\u516c\u4f17\u53f7\u540e\u53f0\u5f00\u53d1\u6846\u67b6\uff0c\u91c7\u7528MIT\u534f\u8bae\u53d1\u5e03\u3002</p> <p>\u6211\u662f\u6765\u770b\u3010 \u4f7f\u7528\u6587\u6863 \u3011\u7684\uff01</p>"},{"location":"index.html#\u5b89\u88c5","title":"\u5b89\u88c5","text":""},{"location":"index.html#\u63a8\u8350\u5b89\u88c5","title":"\u63a8\u8350\u5b89\u88c5","text":"<p>\u63a8\u8350\u4f7f\u7528 <code>pip</code> \u8fdb\u884c\u5b89\u88c5\uff1a <pre><code>pip install zgrobot\n</code></pre></p>"},{"location":"index.html#\u5176\u4ed6\u5b89\u88c5\u65b9\u6cd5","title":"\u5176\u4ed6\u5b89\u88c5\u65b9\u6cd5","text":"<ol> <li> <p>\u624b\u52a8\u4e0b\u8f7d\u5b89\u88c5\u5305</p> <ul> <li>\u4e0b\u8f7d\u5730\u57401\uff1a release</li> <li>\u4e0b\u8f7d\u5730\u57402\uff1a\u84dd\u594f\u4e91\u4ed3\u5e93 \u3001 \u84dd\u594f\u4e91\u5907\u7528\u5730\u5740 \u3010\u5bc6\u7801\uff1a1n86\u3011</li> </ul> </li> <li> <p>\u672c\u5730\u5b89\u88c5 <pre><code>pip install zgrobot-XXX.tar.gz\n</code></pre></p> </li> </ol>"},{"location":"index.html#\u66f4\u65b0","title":"\u66f4\u65b0","text":"<pre><code>pip install --upgrade zgrobot\n</code></pre>"},{"location":"index.html#\u4f7f\u7528","title":"\u4f7f\u7528","text":""},{"location":"index.html#hello-world","title":"Hello World","text":"<p>\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684 <code>Hello World</code> \u5fae\u4fe1\u516c\u4f17\u53f7\uff0c\u4f1a\u5bf9\u6536\u5230\u7684\u6240\u6709\u6587\u672c\u6d88\u606f\u56de\u590d <code>Hello World</code></p> <pre><code>import zgrobot\n\nrobot = zgrobot.ZgRoBot(token='tokenhere')\n\n@robot.text\ndef hello_world():\n    return 'Hello World!'\n\nrobot.run()\n</code></pre>"},{"location":"index.html#\u9ad8\u7ea7\u4f7f\u7528","title":"\u9ad8\u7ea7\u4f7f\u7528","text":"<p>\u8bf7\u53c2\u9605\u3010 \u4f7f\u7528\u6587\u6863 \u3011</p>"},{"location":"index.html#status","title":"Status","text":""},{"location":"api/client.html","title":"\u5ba2\u6237\u7aef","text":""},{"location":"api/client.html#zgrobot.client.Client","title":"<code>Client</code>","text":"<p>             Bases: <code>object</code></p> <p>\u5fae\u4fe1 API \u64cd\u4f5c\u7c7b \u901a\u8fc7\u8fd9\u4e2a\u7c7b\u53ef\u4ee5\u65b9\u4fbf\u7684\u901a\u8fc7\u5fae\u4fe1 API \u8fdb\u884c\u4e00\u7cfb\u5217\u64cd\u4f5c\uff0c\u6bd4\u5982\u4e3b\u52a8\u53d1\u9001\u6d88\u606f\u3001\u521b\u5efa\u81ea\u5b9a\u4e49\u83dc\u5355\u7b49</p> Source code in <code>zgrobot/client.py</code> <pre><code>class Client(object):\n    \"\"\"\n    \u5fae\u4fe1 API \u64cd\u4f5c\u7c7b\n    \u901a\u8fc7\u8fd9\u4e2a\u7c7b\u53ef\u4ee5\u65b9\u4fbf\u7684\u901a\u8fc7\u5fae\u4fe1 API \u8fdb\u884c\u4e00\u7cfb\u5217\u64cd\u4f5c\uff0c\u6bd4\u5982\u4e3b\u52a8\u53d1\u9001\u6d88\u606f\u3001\u521b\u5efa\u81ea\u5b9a\u4e49\u83dc\u5355\u7b49\n    \"\"\"\n\n    def __init__(self, config):\n        self.config = config\n        self._token = None\n        self.token_expires_at = None\n\n    @property\n    def appid(self):\n        return self.config.get(\"APP_ID\", None)\n\n    @property\n    def appsecret(self):\n        return self.config.get(\"APP_SECRET\", None)\n\n    @staticmethod\n    def _url_encode_files(file):\n        if hasattr(file, \"name\"):\n            file = (urllib.parse.quote(file.name), file)\n        return file\n\n    def request(self, method, url, **kwargs):\n        if \"params\" not in kwargs:\n            kwargs[\"params\"] = {\"access_token\": self.token}\n        if isinstance(kwargs.get(\"data\", \"\"), dict):\n            body = _json.dumps(kwargs[\"data\"], ensure_ascii=False)\n            body = body.encode('utf8')\n            kwargs[\"data\"] = body\n\n        r = requests.request(method=method, url=url, **kwargs)\n        r.raise_for_status()\n        r.encoding = \"utf-8\"\n        json = r.json()\n        if check_error(json):\n            return json\n\n    def get(self, url, **kwargs):\n        return self.request(method=\"get\", url=url, **kwargs)\n\n    def post(self, url, **kwargs):\n        if \"files\" in kwargs:\n            # Although there is only one key \"media\" possible in \"files\" now,\n            # we decide to check every key to support possible keys in the future\n            # Fix chinese file name error #292\n            kwargs[\"files\"] = dict(\n                zip(\n                    kwargs[\"files\"],\n                    map(self._url_encode_files, kwargs[\"files\"].values())\n                )\n            )\n        return self.request(method=\"post\", url=url, **kwargs)\n\n    def grant_token(self):\n        \"\"\"\n        \u83b7\u53d6 Access Token\u3002\n\n        :return: \u8fd4\u56de\u7684 ``JSON`` \u6570\u636e\u5305\n\n                \u6b63\u5e38\u65f6\u8fd4\u56de ``{\"access_token\":\"ACCESS_TOKEN\", \"expires_in\":7200}``\n\n                \u9519\u8bef\u65f6\u8fd4\u56de ``{\"errcode\":40013,\"errmsg\":\"invalid appid\"}``\n        \"\"\"\n        return self.get(\n            url=\"https://api.weixin.qq.com/cgi-bin/token\",\n            params={\n                \"grant_type\": \"client_credential\",\n                \"appid\": self.appid,\n                \"secret\": self.appsecret\n            }\n        )\n\n    def get_access_token(self) -&gt; str:\n        \"\"\"\n        \u5224\u65ad\u73b0\u6709\u7684token\u662f\u5426\u8fc7\u671f\u3002\n        \u7528\u6237\u9700\u8981\u591a\u8fdb\u7a0b\u6216\u8005\u591a\u673a\u90e8\u7f72\u53ef\u4ee5\u624b\u52a8\u91cd\u5199\u8fd9\u4e2a\u51fd\u6570\n        \u6765\u81ea\u5b9a\u4e49token\u7684\u5b58\u50a8\uff0c\u5237\u65b0\u7b56\u7565\u3002\n\n        :return: \u8fd4\u56de ``token``\n        \"\"\"\n        if self._token:\n            now = time.time()\n            if self.token_expires_at - now &gt; 60:\n                return self._token\n        with LOCK:\n            json_str = self.grant_token()\n            self._token = json_str[\"access_token\"]\n            self.token_expires_at = int(time.time()) + json_str[\"expires_in\"]\n        return self._token\n\n    @property\n    def token(self):\n        return self.get_access_token()\n\n    def get_ip_list(self):\n        \"\"\"\n        \u83b7\u53d6\u5fae\u4fe1\u670d\u52a1\u5668IP\u5730\u5740\u3002\n\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n\n                \u6b63\u5e38\u65f6\u8fd4\u56de ``{\"ip_list\": [\"127.0.0.1\", \"127.0.0.2\", \"101.226.103.0/25\"]}``\n\n                \u9519\u8bef\u65f6\u8fd4\u56de ``{\"errcode\":40013,\"errmsg\":\"invalid appid\"}``\n        \"\"\"\n        return self.get(url=\"https://api.weixin.qq.com/cgi-bin/getcallbackip\")\n\n    def create_menu(self, menu_data):\n        \"\"\"\n        \u521b\u5efa\u81ea\u5b9a\u4e49\u83dc\u5355::\n\n            client.create_menu({\n                \"button\":[\n                    {\n                        \"type\":\"click\",\n                        \"name\":\"\u4eca\u65e5\u6b4c\u66f2\",\n                        \"key\":\"V1001_TODAY_MUSIC\"\n                    },\n                    {\n                        \"type\":\"click\",\n                        \"name\":\"\u6b4c\u624b\u7b80\u4ecb\",\n                        \"key\":\"V1001_TODAY_SINGER\"\n                    },\n                    {\n                        \"name\":\"\u83dc\u5355\",\n                        \"sub_button\":[\n                            {\n                                \"type\":\"view\",\n                                \"name\":\"\u641c\u7d22\",\n                                \"url\":\"http://www.soso.com/\"\n                            },\n                            {\n                                \"type\":\"view\",\n                                \"name\":\"\u89c6\u9891\",\n                                \"url\":\"http://v.qq.com/\"\n                            },\n                            {\n                                \"type\":\"click\",\n                                \"name\":\"\u8d5e\u4e00\u4e0b\u6211\u4eec\",\n                                \"key\":\"V1001_GOOD\"\n                            }\n                        ]\n                    }\n                ]})\n\n        :param menu_data: Python \u5b57\u5178\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n\n                \u6b63\u786e\u65f6\u8fd4\u56de ``{\"errcode\":0,\"errmsg\":\"ok\"}``\n\n                \u9519\u8bef\u65f6\u8fd4\u56de ``{\"errcode\":40018,\"errmsg\":\"invalid button name size\"}``\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/menu/create\",\n            data=menu_data\n        )\n\n    def get_menu(self):\n        \"\"\"\n        \u67e5\u8be2\u81ea\u5b9a\u4e49\u83dc\u5355\u3002\n\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.get(\"https://api.weixin.qq.com/cgi-bin/menu/get\")\n\n    def delete_menu(self):\n        \"\"\"\n        \u5220\u9664\u81ea\u5b9a\u4e49\u83dc\u5355\u3002\n\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n\n                \u6b63\u786e\u65f6\u8fd4\u56de ``{\"errcode\":0,\"errmsg\":\"ok\"}``\n        \"\"\"\n        return self.get(\"https://api.weixin.qq.com/cgi-bin/menu/delete\")\n\n    def create_custom_menu(self, menu_data, matchrule):\n        \"\"\"\n        \u521b\u5efa\u4e2a\u6027\u5316\u83dc\u5355::\n\n            button = [\n                {\n                    \"type\":\"click\",\n                    \"name\":\"\u4eca\u65e5\u6b4c\u66f2\",\n                    \"key\":\"V1001_TODAY_MUSIC\"\n                },\n                {\n                    \"name\":\"\u83dc\u5355\",\n                    \"sub_button\":[\n                    {\n                        \"type\":\"view\",\n                        \"name\":\"\u641c\u7d22\",\n                        \"url\":\"http://www.soso.com/\"\n                    },\n                    {\n                        \"type\":\"view\",\n                        \"name\":\"\u89c6\u9891\",\n                        \"url\":\"http://v.qq.com/\"\n                    },\n                    {\n                        \"type\":\"click\",\n                        \"name\":\"\u8d5e\u4e00\u4e0b\u6211\u4eec\",\n                        \"key\":\"V1001_GOOD\"\n                    }]\n             }]\n             matchrule = {\n                \"group_id\":\"2\",\n                \"sex\":\"1\",\n                \"country\":\"\u4e2d\u56fd\",\n                \"province\":\"\u5e7f\u4e1c\",\n                \"city\":\"\u5e7f\u5dde\",\n                \"client_platform_type\":\"2\",\n                \"language\":\"zh_CN\"\n            }\n            client.create_custom_menu(button, matchrule)\n\n        :param menu_data: \u5982\u4e0a\u6240\u793a\u7684 Python \u5b57\u5178\n        :param matchrule: \u5982\u4e0a\u6240\u793a\u7684\u5339\u914d\u89c4\u5219\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n\n                \u6b63\u786e\u65f6\u8fd4\u56de ``{\"menuid\":\"208379533\"}``\n\n                \u9519\u8bef\u65f6\u7684\u8fd4\u56de\u7801\u8bf7\u89c1\u63a5\u53e3\u8fd4\u56de\u7801\u8bf4\u660e.\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/menu/addconditional\",\n            data={\n                \"button\": menu_data,\n                \"matchrule\": matchrule\n            }\n        )\n\n    def delete_custom_menu(self, menu_id):\n        \"\"\"\n        \u5220\u9664\u4e2a\u6027\u5316\u83dc\u5355\u3002\n\n        :param menu_id: \u83dc\u5355\u7684 ID\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n\n                \u6b63\u786e\u65f6\u8fd4\u56de ``{\"errcode\":0,\"errmsg\":\"ok\"}``\n\n                \u9519\u8bef\u65f6\u7684\u8fd4\u56de\u7801\u8bf7\u89c1\u63a5\u53e3\u8fd4\u56de\u7801\u8bf4\u660e\u3002\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/menu/delconditional\",\n            data={\"menuid\": menu_id}\n        )\n\n    def match_custom_menu(self, user_id):\n        \"\"\"\n        \u6d4b\u8bd5\u4e2a\u6027\u5316\u83dc\u5355\u5339\u914d\u7ed3\u679c\u3002\n\n        :param user_id: \u8981\u6d4b\u8bd5\u5339\u914d\u7684\u7528\u6237 ID\uff0c\u4e5f\u53ef\u4ee5\u662f\u7528\u6237\u7684\u5fae\u4fe1\u53f7\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/menu/trymatch\",\n            data={\"user_id\": user_id}\n        )\n\n    def get_custom_menu_config(self):\n        \"\"\"\n        \u83b7\u53d6\u81ea\u5b9a\u4e49\u83dc\u5355\u914d\u7f6e\u63a5\u53e3\u3002\n\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.get(\n            url=\"https://api.weixin.qq.com/cgi-bin/get_current_selfmenu_info\"\n        )\n\n    def add_custom_service_account(self, account, nickname):\n        \"\"\"\n        \u6dfb\u52a0\u5ba2\u670d\u5e10\u53f7\u3002\n\n        :param account: \u5ba2\u670d\u8d26\u53f7\u7684\u7528\u6237\u540d\n        :param nickname: \u5ba2\u670d\u8d26\u53f7\u7684\u6635\u79f0\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/customservice/kfaccount/add\",\n            data={\n                \"kf_account\": account,\n                \"nickname\": nickname,\n            }\n        )\n\n    def update_custom_service_account(self, account, nickname, password):\n        \"\"\"\n        \u4fee\u6539\u5ba2\u670d\u5e10\u53f7\u3002\n\n        :param account: \u5ba2\u670d\u8d26\u53f7\u7684\u7528\u6237\u540d\n        :param nickname: \u5ba2\u670d\u8d26\u53f7\u7684\u6635\u79f0\n        :param password: \u5ba2\u670d\u8d26\u53f7\u7684\u5bc6\u7801\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/customservice/kfaccount/update\",\n            data={\n                \"kf_account\": account,\n                \"nickname\": nickname,\n                \"password\": password\n            }\n        )\n\n    def delete_custom_service_account(self, account, nickname, password):\n        \"\"\"\n        \u5220\u9664\u5ba2\u670d\u5e10\u53f7\u3002\n\n        :param account: \u5ba2\u670d\u8d26\u53f7\u7684\u7528\u6237\u540d\n        :param nickname: \u5ba2\u670d\u8d26\u53f7\u7684\u6635\u79f0\n        :param password: \u5ba2\u670d\u8d26\u53f7\u7684\u5bc6\u7801\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/customservice/kfaccount/del\",\n            data={\n                \"kf_account\": account,\n                \"nickname\": nickname,\n                \"password\": password\n            }\n        )\n\n    def upload_custom_service_account_avatar(self, account, avatar):\n        \"\"\"\n        \u8bbe\u7f6e\u5ba2\u670d\u5e10\u53f7\u7684\u5934\u50cf\u3002\n\n        :param account: \u5ba2\u670d\u8d26\u53f7\u7684\u7528\u6237\u540d\n        :param avatar: \u5934\u50cf\u6587\u4ef6\uff0c\u5fc5\u987b\u662f jpg \u683c\u5f0f\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\n            \"https://api.weixin.qq.com/customservice/kfaccount/uploadheadimg\",\n            params={\n                \"access_token\": self.token,\n                \"kf_account\": account\n            },\n            files={\"media\": avatar}\n        )\n\n    def get_custom_service_account_list(self):\n        \"\"\"\n        \u83b7\u53d6\u6240\u6709\u5ba2\u670d\u8d26\u53f7\u3002\n\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.get(\n            url=\"https://api.weixin.qq.com/cgi-bin/customservice/getkflist\"\n        )\n\n    def get_online_custom_service_account_list(self):\n        \"\"\"\n        \u83b7\u53d6\u72b6\u6001\u4e3a\"\u5728\u7ebf\"\u7684\u5ba2\u670d\u8d26\u53f7\u5217\u8868\u3002\n\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.get(\n            url=\"https://api.weixin.qq.com/cgi-bin/customservice/getonlinekflist\"\n        )\n\n    def upload_media(self, media_type, media_file):\n        \"\"\"\n        \u4e0a\u4f20\u4e34\u65f6\u591a\u5a92\u4f53\u6587\u4ef6\u3002\n\n        :param media_type: \u5a92\u4f53\u6587\u4ef6\u7c7b\u578b\uff0c\u5206\u522b\u6709\u56fe\u7247\uff08image\uff09\u3001\u8bed\u97f3\uff08voice\uff09\u3001\u89c6\u9891\uff08video\uff09\u548c\u7f29\u7565\u56fe\uff08thumb\uff09\n        :param media_file: \u8981\u4e0a\u4f20\u7684\u6587\u4ef6\uff0c\u4e00\u4e2a File-object: open('xxx', 'rb')\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        check_file_type_and_size(file_type=media_type, file_object=media_file)\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/media/upload\",\n            params={\n                \"access_token\": self.token,\n                \"type\": media_type\n            },\n            files={\"media\": media_file}\n        )\n\n    def download_media(self, media_id):\n        \"\"\"\n        \u4e0b\u8f7d\u4e34\u65f6\u591a\u5a92\u4f53\u6587\u4ef6\u3002\n\n        :param media_id: \u5a92\u4f53\u6587\u4ef6 ID\n        :return: requests \u7684 Response \u5b9e\u4f8b\n        \"\"\"\n        return requests.get(\n            url=\"https://api.weixin.qq.com/cgi-bin/media/get\",\n            params={\n                \"access_token\": self.token,\n                \"media_id\": media_id\n            }\n        )\n\n    def add_news(self, articles):\n        \"\"\"\n        \u65b0\u589e\u6c38\u4e45\u56fe\u6587\u7d20\u6750::\n\n            articles = [{\n               \"title\": TITLE,\n               \"thumb_media_id\": THUMB_MEDIA_ID,\n               \"author\": AUTHOR,\n               \"digest\": DIGEST,\n               \"show_cover_pic\": SHOW_COVER_PIC(0 / 1),\n               \"content\": CONTENT,\n               \"content_source_url\": CONTENT_SOURCE_URL\n            }\n            # \u82e5\u65b0\u589e\u7684\u662f\u591a\u56fe\u6587\u7d20\u6750\uff0c\u5219\u6b64\u5904\u5e94\u6709\u51e0\u6bb5articles\u7ed3\u6784\uff0c\u6700\u591a8\u6bb5\n            ]\n            client.add_news(articles)\n\n        :param articles: \u5982\u793a\u4f8b\u4e2d\u7684\u6570\u7ec4\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/material/add_news\",\n            data={\"articles\": articles}\n        )\n\n    def upload_news_picture(self, file):\n        \"\"\"\n        \u4e0a\u4f20\u56fe\u6587\u6d88\u606f\u5185\u7684\u56fe\u7247\u3002\n\n        :param file: \u8981\u4e0a\u4f20\u7684\u56fe\u7247\u6587\u4ef6\uff0c\u7c7b\u578b\u4ec5\u652f\u6301 jpg/png \u683c\u5f0f\uff0c\u5927\u5c0f\u9650\u5236\u4e3a &lt;10Mb\uff0c\u5982\uff1aopen('xxx', 'rb')\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/media/uploadimg\",\n            params={\"access_token\": self.token},\n            files={\"media\": file}\n        )\n\n    def upload_permanent_media(self, media_type, media_file):\n        \"\"\"\n        \u4e0a\u4f20\u5176\u4ed6\u7c7b\u578b\u6c38\u4e45\u7d20\u6750\u3002\n\n        :param media_type: \u5a92\u4f53\u6587\u4ef6\u7c7b\u578b\uff0c\u5206\u522b\u6709\u56fe\u7247\uff08image\uff09\u3001\u8bed\u97f3\uff08voice\uff09\u548c\u7f29\u7565\u56fe\uff08thumb\uff09\n        :param media_file: \u8981\u4e0a\u4f20\u7684\u6587\u4ef6\uff0c\u4e00\u4e2a File-object: open('xxx', 'rb')\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        check_file_type_and_size(file_type=media_type, file_object=media_file)\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/material/add_material\",\n            params={\n                \"access_token\": self.token,\n                \"type\": media_type\n            },\n            files={\"media\": media_file}\n        )\n\n    def upload_permanent_video(self, title, introduction, video):\n        \"\"\"\n        \u4e0a\u4f20\u6c38\u4e45\u89c6\u9891\u3002\n\n        :param title: \u89c6\u9891\u7d20\u6750\u7684\u6807\u9898\n        :param introduction: \u89c6\u9891\u7d20\u6750\u7684\u63cf\u8ff0\n        :param video: \u8981\u4e0a\u4f20\u7684\u89c6\u9891\uff0c\u4e00\u4e2a File-object: open('xxx', 'rb')\uff0c \u5927\u5c0f\u9650\u5236 &lt;10Mb\n        :return: requests \u7684 Response \u5b9e\u4f8b\n        \"\"\"\n        check_file_type_and_size(file_type=\"video\", file_object=video)\n        return requests.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/material/add_material\",\n            params={\n                \"access_token\": self.token,\n                \"type\": \"video\"\n            },\n            data={\n                \"description\": _json.dumps(\n                    {\n                        \"title\": title,\n                        \"introduction\": introduction\n                    },\n                    ensure_ascii=False\n                ).encode(\"utf-8\")\n            },\n            files={\"media\": video}\n        )\n\n    def download_permanent_media(self, media_id):\n        \"\"\"\n        \u83b7\u53d6\u6c38\u4e45\u7d20\u6750\u3002\n\n        :param media_id: \u5a92\u4f53\u6587\u4ef6 ID\n        :return: requests \u7684 Response \u5b9e\u4f8b\n        \"\"\"\n        return requests.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/material/get_material\",\n            params={\"access_token\": self.token},\n            data=_json.dumps({\n                \"media_id\": media_id\n            }, ensure_ascii=False).encode(\"utf-8\")\n        )\n\n    def delete_permanent_media(self, media_id):\n        \"\"\"\n        \u5220\u9664\u6c38\u4e45\u7d20\u6750\u3002\n\n        :param media_id: \u5a92\u4f53\u6587\u4ef6 ID\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/material/del_material\",\n            data={\"media_id\": media_id}\n        )\n\n    def update_news(self, update_data):\n        \"\"\"\n        \u4fee\u6539\u6c38\u4e45\u56fe\u6587\u7d20\u6750::\n\n            update_data = {\n                \"media_id\":MEDIA_ID,\n                \"index\":INDEX,\n                \"articles\": {\n                    \"title\": TITLE,\n                    \"thumb_media_id\": THUMB_MEDIA_ID,\n                    \"author\": AUTHOR,\n                    \"digest\": DIGEST,\n                    \"show_cover_pic\": SHOW_COVER_PIC(0 / 1),\n                    \"content\": CONTENT,\n                    \"content_source_url\": CONTENT_SOURCE_URL\n                }\n            }\n            client.update_news(update_data)\n\n        :param update_data: \u66f4\u65b0\u7684\u6570\u636e\uff0c\u8981\u5305\u542b media_id\uff08\u56fe\u6587\u7d20\u6750\u7684 ID\uff09\uff0cindex\uff08\u8981\u66f4\u65b0\u7684\u6587\u7ae0\u5728\u56fe\u6587\u6d88\u606f\u4e2d\u7684\u4f4d\u7f6e\uff09\uff0carticles\uff08\u65b0\u7684\u56fe\u6587\u7d20\u6750\u6570\u636e\uff09\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/material/update_news\",\n            data=update_data\n        )\n\n    def get_media_count(self):\n        \"\"\"\n        \u83b7\u53d6\u7d20\u6750\u603b\u6570\u3002\n\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.get(\n            url=\"https://api.weixin.qq.com/cgi-bin/material/get_materialcount\"\n        )\n\n    def get_media_list(self, media_type, offset, count):\n        \"\"\"\n        \u83b7\u53d6\u7d20\u6750\u5217\u8868\u3002\n\n        :param media_type: \u7d20\u6750\u7684\u7c7b\u578b\uff0c\u56fe\u7247\uff08image\uff09\u3001\u89c6\u9891\uff08video\uff09\u3001\u8bed\u97f3 \uff08voice\uff09\u3001\u56fe\u6587\uff08news\uff09\n        :param offset: \u4ece\u5168\u90e8\u7d20\u6750\u7684\u8be5\u504f\u79fb\u4f4d\u7f6e\u5f00\u59cb\u8fd4\u56de\uff0c0\u8868\u793a\u4ece\u7b2c\u4e00\u4e2a\u7d20\u6750\u8fd4\u56de\n        :param count: \u8fd4\u56de\u7d20\u6750\u7684\u6570\u91cf\uff0c\u53d6\u503c\u57281\u523020\u4e4b\u95f4\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/material/batchget_material\",\n            data={\n                \"type\": media_type,\n                \"offset\": offset,\n                \"count\": count\n            }\n        )\n\n    def create_group(self, name):\n        \"\"\"\n        \u521b\u5efa\u5206\u7ec4\u3002\n\n        :param name: \u5206\u7ec4\u540d\u5b57\uff0830\u4e2a\u5b57\u7b26\u4ee5\u5185\uff09\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n\n        \"\"\"\n        name = to_text(name)\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/groups/create\",\n            data={\"group\": {\n                \"name\": name\n            }}\n        )\n\n    def get_groups(self):\n        \"\"\"\n        \u67e5\u8be2\u6240\u6709\u5206\u7ec4\u3002\n\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.get(\"https://api.weixin.qq.com/cgi-bin/groups/get\")\n\n    def get_group_by_id(self, openid):\n        \"\"\"\n        \u67e5\u8be2\u7528\u6237\u6240\u5728\u5206\u7ec4\u3002\n\n        :param openid: \u7528\u6237\u7684OpenID\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/groups/getid\",\n            data={\"openid\": openid}\n        )\n\n    def update_group(self, group_id, name):\n        \"\"\"\n        \u4fee\u6539\u5206\u7ec4\u540d\u3002\n\n        :param group_id: \u5206\u7ec4 ID\uff0c\u7531\u5fae\u4fe1\u5206\u914d\n        :param name: \u5206\u7ec4\u540d\u5b57\uff0830\u4e2a\u5b57\u7b26\u4ee5\u5185\uff09\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/groups/update\",\n            data={\"group\": {\n                \"id\": int(group_id),\n                \"name\": to_text(name)\n            }}\n        )\n\n    def move_user(self, user_id, group_id):\n        \"\"\"\n        \u79fb\u52a8\u7528\u6237\u5206\u7ec4\u3002\n\n        :param user_id: \u7528\u6237 ID\uff0c\u5373\u6536\u5230\u7684 `Message` \u7684 source\n        :param group_id: \u5206\u7ec4 ID\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/groups/members/update\",\n            data={\n                \"openid\": user_id,\n                \"to_groupid\": group_id\n            }\n        )\n\n    def move_users(self, user_id_list, group_id):\n        \"\"\"\n        \u6279\u91cf\u79fb\u52a8\u7528\u6237\u5206\u7ec4\u3002\n\n        :param user_id_list: \u7528\u6237 ID \u7684\u5217\u8868\uff08\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\uff09\n        :param group_id: \u5206\u7ec4 ID\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/groups/members/batchupdate\",\n            data={\n                \"openid_list\": user_id_list,\n                \"to_groupid\": group_id\n            }\n        )\n\n    def delete_group(self, group_id):\n        \"\"\"\n        \u5220\u9664\u5206\u7ec4\u3002\n\n        :param group_id: \u8981\u5220\u9664\u7684\u5206\u7ec4\u7684 ID\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/groups/delete\",\n            data={\"group\": {\n                \"id\": group_id\n            }}\n        )\n\n    def remark_user(self, user_id, remark):\n        \"\"\"\n        \u8bbe\u7f6e\u5907\u6ce8\u540d\u3002\n\n        :param user_id: \u8bbe\u7f6e\u5907\u6ce8\u540d\u7684\u7528\u6237 ID\n        :param remark: \u65b0\u7684\u5907\u6ce8\u540d\uff0c\u957f\u5ea6\u5fc5\u987b\u5c0f\u4e8e30\u5b57\u7b26\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/user/info/updateremark\",\n            data={\n                \"openid\": user_id,\n                \"remark\": remark\n            }\n        )\n\n    def get_user_info(self, user_id, lang=\"zh_CN\"):\n        \"\"\"\n        \u83b7\u53d6\u7528\u6237\u57fa\u672c\u4fe1\u606f\u3002\n\n        :param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 `Message` \u7684 source\n        :param lang: \u8fd4\u56de\u56fd\u5bb6\u5730\u533a\u8bed\u8a00\u7248\u672c\uff0czh_CN \u7b80\u4f53\uff0czh_TW \u7e41\u4f53\uff0cen \u82f1\u8bed\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.get(\n            url=\"https://api.weixin.qq.com/cgi-bin/user/info\",\n            params={\n                \"access_token\": self.token,\n                \"openid\": user_id,\n                \"lang\": lang\n            }\n        )\n\n    def get_users_info(self, user_id_list, lang=\"zh_CN\"):\n        \"\"\"\n        \u6279\u91cf\u83b7\u53d6\u7528\u6237\u57fa\u672c\u4fe1\u606f\u3002\n\n        :param user_id_list: \u7528\u6237 ID \u7684\u5217\u8868\n        :param lang: \u8fd4\u56de\u56fd\u5bb6\u5730\u533a\u8bed\u8a00\u7248\u672c\uff0czh_CN \u7b80\u4f53\uff0czh_TW \u7e41\u4f53\uff0cen \u82f1\u8bed\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/user/info/batchget\",\n            data={\n                \"user_list\": [\n                    {\n                        \"openid\": user_id,\n                        \"lang\": lang\n                    } for user_id in user_id_list\n                ]\n            }\n        )\n\n    def get_followers(self, first_user_id=None):\n        \"\"\"\n        \u83b7\u53d6\u5173\u6ce8\u8005\u5217\u8868\n        \u8be6\u60c5\u8bf7\u53c2\u8003 https://developers.weixin.qq.com/doc/offiaccount/User_Management/Getting_a_User_List.html\n\n        :param first_user_id: \u53ef\u9009\u3002\u7b2c\u4e00\u4e2a\u62c9\u53d6\u7684OPENID\uff0c\u4e0d\u586b\u9ed8\u8ba4\u4ece\u5934\u5f00\u59cb\u62c9\u53d6\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        params = {\"access_token\": self.token}\n        if first_user_id:\n            params[\"next_openid\"] = first_user_id\n        return self.get(\n            \"https://api.weixin.qq.com/cgi-bin/user/get\", params=params\n        )\n\n    def send_text_message(self, user_id, content, kf_account=None):\n        \"\"\"\n        \u53d1\u9001\u6587\u672c\u6d88\u606f\u3002\n\n        :param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 `Message` \u7684 source\n        :param content: \u6d88\u606f\u6b63\u6587\n        :param kf_account: \u53d1\u9001\u6d88\u606f\u7684\u5ba2\u670d\u8d26\u6237\uff0c\u9ed8\u8ba4\u503c\u4e3a None\uff0cNone \u4e3a\u4e0d\u6307\u5b9a\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        data = {\n            \"touser\": user_id,\n            \"msgtype\": \"text\",\n            \"text\": {\n                \"content\": content\n            }\n        }\n        if kf_account is not None:\n            data['customservice'] = {'kf_account': kf_account}\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/message/custom/send\",\n            data=data\n        )\n\n    def send_image_message(self, user_id, media_id, kf_account=None):\n        \"\"\"\n        \u53d1\u9001\u56fe\u7247\u6d88\u606f\u3002\n\n        :param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 `Message` \u7684 source\n        :param media_id: \u56fe\u7247\u7684\u5a92\u4f53ID\u3002 \u53ef\u4ee5\u901a\u8fc7 :func:`upload_media` \u4e0a\u4f20\u3002\n        :param kf_account: \u53d1\u9001\u6d88\u606f\u7684\u5ba2\u670d\u8d26\u6237\uff0c\u9ed8\u8ba4\u503c\u4e3a None\uff0cNone \u4e3a\u4e0d\u6307\u5b9a\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        data = {\n            \"touser\": user_id,\n            \"msgtype\": \"image\",\n            \"image\": {\n                \"media_id\": media_id\n            }\n        }\n        if kf_account is not None:\n            data['customservice'] = {'kf_account': kf_account}\n        return self.post(url=SEND_MESSAGE_URL, data=data)\n\n    def send_voice_message(self, user_id, media_id, kf_account=None):\n        \"\"\"\n        \u53d1\u9001\u8bed\u97f3\u6d88\u606f\u3002\n\n        :param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 `Message` \u7684 source\n        :param media_id: \u53d1\u9001\u7684\u8bed\u97f3\u7684\u5a92\u4f53ID\u3002 \u53ef\u4ee5\u901a\u8fc7 :func:`upload_media` \u4e0a\u4f20\u3002\n        :param kf_account: \u53d1\u9001\u6d88\u606f\u7684\u5ba2\u670d\u8d26\u6237\uff0c\u9ed8\u8ba4\u503c\u4e3a None\uff0cNone \u4e3a\u4e0d\u6307\u5b9a\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        data = {\n            \"touser\": user_id,\n            \"msgtype\": \"voice\",\n            \"voice\": {\n                \"media_id\": media_id\n            }\n        }\n        if kf_account is not None:\n            data['customservice'] = {'kf_account': kf_account}\n        return self.post(url=SEND_MESSAGE_URL, data=data)\n\n    def send_video_message(\n        self,\n        user_id,\n        media_id,\n        title=None,\n        description=None,\n        kf_account=None\n    ):\n        \"\"\"\n        \u53d1\u9001\u89c6\u9891\u6d88\u606f\u3002\n\n        :param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 `Message` \u7684 source\n        :param media_id: \u53d1\u9001\u7684\u89c6\u9891\u7684\u5a92\u4f53ID\u3002 \u53ef\u4ee5\u901a\u8fc7 :func:`upload_media` \u4e0a\u4f20\u3002\n        :param title: \u89c6\u9891\u6d88\u606f\u7684\u6807\u9898\n        :param description: \u89c6\u9891\u6d88\u606f\u7684\u63cf\u8ff0\n        :param kf_account: \u53d1\u9001\u6d88\u606f\u7684\u5ba2\u670d\u8d26\u6237\uff0c\u9ed8\u8ba4\u503c\u4e3a None\uff0cNone \u4e3a\u4e0d\u6307\u5b9a\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        video_data = {\n            \"media_id\": media_id,\n        }\n        if title:\n            video_data[\"title\"] = title\n        if description:\n            video_data[\"description\"] = description\n        data = {\"touser\": user_id, \"msgtype\": \"video\", \"video\": video_data}\n        if kf_account is not None:\n            data['customservice'] = {'kf_account': kf_account}\n        return self.post(url=SEND_MESSAGE_URL, data=data)\n\n    def send_music_message(\n        self,\n        user_id,\n        url,\n        hq_url,\n        thumb_media_id,\n        title=None,\n        description=None,\n        kf_account=None\n    ):\n        \"\"\"\n        \u53d1\u9001\u97f3\u4e50\u6d88\u606f\u3002\n        \u6ce8\u610f\u5982\u679c\u4f60\u9047\u5230\u4e86\u7f29\u7565\u56fe\u4e0d\u80fd\u6b63\u5e38\u663e\u793a\u7684\u95ee\u9898\uff0c \u4e0d\u8981\u614c\u5f20\uff1b \u76ee\u524d\u6765\u770b\u662f\u5fae\u4fe1\u670d\u52a1\u5668\u7aef\u7684\u95ee\u9898\u3002\n        \u5bf9\u6b64\u6211\u4eec\u4e5f\u65e0\u80fd\u4e3a\u529b ( `#197 &lt;https://github.com/whtsky/ZgRoBot/issues/197&gt;`_ )\n\n        :param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 `Message` \u7684 source\n        :param url: \u97f3\u4e50\u94fe\u63a5\n        :param hq_url: \u9ad8\u54c1\u8d28\u97f3\u4e50\u94fe\u63a5\uff0cwifi\u73af\u5883\u4f18\u5148\u4f7f\u7528\u8be5\u94fe\u63a5\u64ad\u653e\u97f3\u4e50\n        :param thumb_media_id: \u7f29\u7565\u56fe\u7684\u5a92\u4f53ID\u3002 \u53ef\u4ee5\u901a\u8fc7 :func:`upload_media` \u4e0a\u4f20\u3002\n        :param title: \u97f3\u4e50\u6807\u9898\n        :param description: \u97f3\u4e50\u63cf\u8ff0\n        :param kf_account: \u53d1\u9001\u6d88\u606f\u7684\u5ba2\u670d\u8d26\u6237\uff0c\u9ed8\u8ba4\u503c\u4e3a None\uff0cNone \u4e3a\u4e0d\u6307\u5b9a\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        music_data = {\n            \"musicurl\": url,\n            \"hqmusicurl\": hq_url,\n            \"thumb_media_id\": thumb_media_id\n        }\n        if title:\n            music_data[\"title\"] = title\n        if description:\n            music_data[\"description\"] = description\n        data = {\"touser\": user_id, \"msgtype\": \"music\", \"music\": music_data}\n        if kf_account is not None:\n            data['customservice'] = {'kf_account': kf_account}\n\n        return self.post(url=SEND_MESSAGE_URL, data=data)\n\n    def send_article_message(self, user_id, articles, kf_account=None):\n        \"\"\"\n        \u53d1\u9001\u56fe\u6587\u6d88\u606f::\n\n            articles = [\n                {\n                    \"title\":\"Happy Day\",\n                    \"description\":\"Is Really A Happy Day\",\n                    \"url\":\"URL\",\n                    \"picurl\":\"PIC_URL\"\n                },\n                {\n                    \"title\":\"Happy Day\",\n                    \"description\":\"Is Really A Happy Day\",\n                    \"url\":\"URL\",\n                    \"picurl\":\"PIC_URL\"\n                }\n            ]\n            client.send_acticle_message(\"user_id\", acticles)\n\n        :param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 `Message` \u7684 source\n        :param articles: \u4e00\u4e2a\u5305\u542b\u81f3\u591a8\u4e2a article \u5b57\u5178\u6216 Article \u5bf9\u8c61\u7684\u6570\u7ec4\n        :param kf_account: \u53d1\u9001\u6d88\u606f\u7684\u5ba2\u670d\u8d26\u6237\uff0c\u9ed8\u8ba4\u503c\u4e3a None\uff0cNone \u4e3a\u4e0d\u6307\u5b9a\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        if isinstance(articles[0], Article):\n            formatted_articles = []\n            for article in articles:\n                result = article.args\n                result[\"picurl\"] = result.pop(\"img\")\n                formatted_articles.append(result)\n        else:\n            formatted_articles = articles\n        data = {\n            \"touser\": user_id,\n            \"msgtype\": \"news\",\n            \"news\": {\n                \"articles\": formatted_articles\n            }\n        }\n        if kf_account is not None:\n            data['customservice'] = {'kf_account': kf_account}\n        return self.post(url=SEND_MESSAGE_URL, data=data)\n\n    def send_news_message(self, user_id, media_id, kf_account=None):\n        \"\"\"\n        \u53d1\u9001\u6c38\u4e45\u7d20\u6750\u4e2d\u7684\u56fe\u6587\u6d88\u606f\u3002\n\n        :param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 `Message` \u7684 source\n        :param media_id: \u5a92\u4f53\u6587\u4ef6 ID\n        :param kf_account: \u53d1\u9001\u6d88\u606f\u7684\u5ba2\u670d\u8d26\u6237\uff0c\u9ed8\u8ba4\u503c\u4e3a None\uff0cNone \u4e3a\u4e0d\u6307\u5b9a\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        data = {\n            \"touser\": user_id,\n            \"msgtype\": \"mpnews\",\n            \"mpnews\": {\n                \"media_id\": media_id\n            }\n        }\n        if kf_account is not None:\n            data['customservice'] = {'kf_account': kf_account}\n        return self.post(url=SEND_MESSAGE_URL, data=data)\n\n    def send_miniprogrampage_message(\n        self,\n        user_id,\n        title,\n        appid,\n        pagepath,\n        thumb_media_id,\n        kf_account=None\n    ):\n        \"\"\"\n        \u53d1\u9001\u5c0f\u7a0b\u5e8f\u5361\u7247\uff08\u8981\u6c42\u5c0f\u7a0b\u5e8f\u4e0e\u516c\u4f17\u53f7\u5df2\u5173\u8054\uff09\n\n        :param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 `Message` \u7684 source\n        :param title: \u5c0f\u7a0b\u5e8f\u5361\u7247\u7684\u6807\u9898\n        :param appid: \u5c0f\u7a0b\u5e8f\u7684 appid\uff0c\u8981\u6c42\u5c0f\u7a0b\u5e8f\u7684 appid \u9700\u8981\u4e0e\u516c\u4f17\u53f7\u6709\u5173\u8054\u5173\u7cfb\n        :param pagepath: \u5c0f\u7a0b\u5e8f\u7684\u9875\u9762\u8def\u5f84\uff0c\u8ddf app.json \u5bf9\u9f50\uff0c\u652f\u6301\u53c2\u6570\uff0c\u6bd4\u5982 pages/index/index?foo=bar\n        :param thumb_media_id: \u5c0f\u7a0b\u5e8f\u5361\u7247\u56fe\u7247\u7684\u5a92\u4f53 ID\uff0c\u5c0f\u7a0b\u5e8f\u5361\u7247\u56fe\u7247\u5efa\u8bae\u5927\u5c0f\u4e3a 520*416\n        :param kf_account: \u9700\u8981\u4ee5\u67d0\u4e2a\u5ba2\u670d\u5e10\u53f7\u6765\u53d1\u6d88\u606f\u65f6\u6307\u5b9a\u7684\u5ba2\u670d\u8d26\u6237\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        data = {\n            \"touser\": user_id,\n            \"msgtype\": \"miniprogrampage\",\n            \"miniprogrampage\": {\n                \"title\": title,\n                \"appid\": appid,\n                \"pagepath\": pagepath,\n                \"thumb_media_id\": thumb_media_id\n            }\n        }\n        if kf_account is not None:\n            data[\"customservice\"] = {\"kf_account\": kf_account}\n        return self.post(url=SEND_MESSAGE_URL, data=data)\n\n    def create_qrcode(self, data):\n        \"\"\"\n        \u521b\u5efa\u4e8c\u7ef4\u7801\u3002\n\n        :param data: \u4f60\u8981\u53d1\u9001\u7684\u53c2\u6570 dict\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/qrcode/create\", data=data\n        )\n\n    def show_qrcode(self, ticket):\n        \"\"\"\n        \u901a\u8fc7ticket\u6362\u53d6\u4e8c\u7ef4\u7801\u3002\n\n        :param ticket: \u4e8c\u7ef4\u7801 ticket \u3002\u53ef\u4ee5\u901a\u8fc7 :func:`create_qrcode` \u83b7\u53d6\u5230\n        :return: \u8fd4\u56de\u7684 Request \u5bf9\u8c61\n        \"\"\"\n        return requests.get(\n            url=\"https://mp.weixin.qq.com/cgi-bin/showqrcode\",\n            params={\"ticket\": ticket}\n        )\n\n    def send_template_message(\n        self, user_id, template_id, data, url='', miniprogram=None\n    ):\n        \"\"\"\n        \u53d1\u9001\u6a21\u677f\u6d88\u606f\n        \u8be6\u60c5\u8bf7\u53c2\u8003 https://developers.weixin.qq.com/doc/offiaccount/Message_Management/Template_Message_Interface.html\n\n        :param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 `Message` \u7684 source\n        :param template_id: \u6a21\u677f ID\u3002\n        :param data: \u7528\u4e8e\u6e32\u67d3\u6a21\u677f\u7684\u6570\u636e\u3002\n        :param url: \u6a21\u677f\u6d88\u606f\u7684\u53ef\u9009\u94fe\u63a5\u3002\n        :param miniprogram: \u8df3\u5c0f\u7a0b\u5e8f\u6240\u9700\u6570\u636e\u7684\u53ef\u9009\u6570\u636e\u3002\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        payload = {\n            \"touser\": user_id,\n            \"template_id\": template_id,\n            \"url\": url,\n            \"data\": data\n        }\n        if miniprogram:\n            payload[\"miniprogram\"] = miniprogram\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/message/template/send\",\n            data=payload\n        )\n\n    def create_tag(self, tag_name):\n        \"\"\"\n        \u521b\u5efa\u4e00\u4e2a\u65b0\u6807\u7b7e\n\n        :param tag_name: \u6807\u7b7e\u540d\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/tags/create\",\n            data={\"tag\": {\n                \"name\": tag_name\n            }}\n        )\n\n    def get_tags(self):\n        \"\"\"\n        \u83b7\u53d6\u5df2\u7ecf\u5b58\u5728\u7684\u6807\u7b7e\n\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.get(url=\"https://api.weixin.qq.com/cgi-bin/tags/get\", )\n\n    def update_tag(self, tag_id, tag_name):\n        \"\"\"\n        \u4fee\u6539\u6807\u7b7e\n\n        :param tag_id: \u6807\u7b7e ID\n        :param tag_name: \u65b0\u7684\u6807\u7b7e\u540d\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/tags/update\",\n            data={\"tag\": {\n                \"id\": tag_id,\n                \"name\": tag_name\n            }}\n        )\n\n    def delete_tag(self, tag_id):\n        \"\"\"\n        \u5220\u9664\u6807\u7b7e\n\n        :param tag_id: \u6807\u7b7e ID\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/tags/delete\",\n            data={\"tag\": {\n                \"id\": tag_id,\n            }}\n        )\n\n    def get_users_by_tag(self, tag_id, next_open_id=\"\"):\n        \"\"\"\n        \u83b7\u53d6\u6807\u7b7e\u4e0b\u7c89\u4e1d\u5217\u8868\n\n        :param tag_id: \u6807\u7b7e ID\n        :param next_open_id: \u7b2c\u4e00\u4e2a\u62c9\u53d6\u7528\u6237\u7684 OPENID\uff0c\u9ed8\u8ba4\u4ece\u5934\u5f00\u59cb\u62c9\u53d6\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/user/tag/get\",\n            data={\n                \"tagid\": tag_id,\n                \"next_openid\": next_open_id\n            }\n        )\n\n    def get_tags_by_user(self, open_id):\n        \"\"\"\n        \u83b7\u53d6\u7528\u6237\u8eab\u4e0a\u7684\u6807\u7b7e\u5217\u8868\n\n        :param open_id: \u7528\u6237\u7684 OPENID\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/tags/getidlist\",\n            data={\n                \"openid\": open_id,\n            }\n        )\n\n    def tag_users(self, tag_id, open_id_list):\n        \"\"\"\n        \u6279\u91cf\u4e3a\u7528\u6237\u6253\u6807\u7b7e\n\n        :param tag_id: \u6807\u7b7e ID\n        :param open_id_list: \u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u7528\u6237\u7684 OPENID \u7684\u5217\u8868\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/tags/members/batchtagging\",\n            data={\n                \"openid_list\": open_id_list,\n                \"tagid\": tag_id\n            }\n        )\n\n    def untag_users(self, tag_id, open_id_list):\n        \"\"\"\n        \u6279\u91cf\u4e3a\u7528\u6237\u53d6\u6d88\u6807\u7b7e\n\n        :param tag_id: \u6807\u7b7e ID\n        :param open_id_list: \u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u7528\u6237\u7684 OPENID \u7684\u5217\u8868\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/tags/members/batchuntagging\",\n            data={\n                \"openid_list\": open_id_list,\n                \"tagid\": tag_id\n            }\n        )\n\n    def upload_news(self, articles):\n        \"\"\"\n        \u4e0a\u4f20\u56fe\u6587\u6d88\u606f\u7d20\u6750 ::\n\n            articles = [{\n                \"thumb_media_id\":\"qI6_Ze_6PtV7svjolgs-rN6stStuHIjs9_DidOHaj0Q-mwvBelOXCFZiq2OsIU-p\",\n                \"author\":\"xxx\",\n                \"title\":\"Happy Day\",\n                \"content_source_url\":\"www.qq.com\",\n                \"content\":\"content\",\n                \"digest\":\"digest\",\n                \"show_cover_pic\":1,\n                \"need_open_comment\":1,\n                \"only_fans_can_comment\":1\n            }]\n\n        \u5177\u4f53\u8bf7\u53c2\u8003: https://developers.weixin.qq.com/doc/offiaccount/Message_Management/Batch_Sends_and_Originality_Checks.html#1\n\n\n        :param articles: \u4e0a\u4f20\u7684\u56fe\u6587\u6d88\u606f\u6570\u636e\u3002\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\u3002\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/media/uploadnews\",\n            data={\n                \"articles\": articles,\n            }\n        )\n\n    def send_mass_msg(\n        self,\n        msg_type,\n        content,\n        user_list=None,\n        send_ignore_reprint=False,\n        client_msg_id=None\n    ):\n        \"\"\"\n        \u5411\u6307\u5b9a\u5bf9\u8c61\u7fa4\u53d1\u4fe1\u606f\u3002\n\n        :param msg_type: \u7fa4\u53d1\u7c7b\u578b\uff0c\u56fe\u6587\u6d88\u606f\u4e3a mpnews\uff0c\u6587\u672c\u6d88\u606f\u4e3a text\uff0c\u8bed\u97f3\u4e3a voice\uff0c\u97f3\u4e50\u4e3a music\uff0c\u56fe\u7247\u4e3a image\uff0c\u89c6\u9891\u4e3a video\uff0c\u5361\u5238\u4e3a wxcard\u3002\n        :param content: \u7fa4\u53d1\u5185\u5bb9\u3002\n        :param user_list: \u53d1\u9001\u5bf9\u8c61\uff0c\u6574\u578b\u4ee3\u8868\u7528\u6237\u7ec4\uff0c\u5217\u8868\u4ee3\u8868\u6307\u5b9a\u7528\u6237\uff0c\u5982\u679c\u4e3a None \u5219\u4ee3\u8868\u5168\u90e8\u53d1\u9001\u3002\n        :param send_ignore_reprint: \u56fe\u6587\u6d88\u606f\u88ab\u5224\u5b9a\u4e3a\u8f6c\u8f7d\u65f6\uff0c\u662f\u5426\u7ee7\u7eed\u7fa4\u53d1\u3002 True \u4e3a\u7ee7\u7eed\u7fa4\u53d1\uff08\u8f6c\u8f7d\uff09\uff0cFalse \u4e3a\u505c\u6b62\u7fa4\u53d1\u3002 \u8be5\u53c2\u6570\u9ed8\u8ba4\u4e3a False\u3002\n        :param client_msg_id: \u7fa4\u53d1\u65f6\uff0c\u5fae\u4fe1\u540e\u53f0\u5c06\u5bf9 24 \u5c0f\u65f6\u5185\u7684\u7fa4\u53d1\u8bb0\u5f55\u8fdb\u884c\u68c0\u67e5\uff0c\u5982\u679c\u8be5 clientmsgid \u5df2\u7ecf\u5b58\u5728\u4e00\u6761\u7fa4\u53d1\u8bb0\u5f55\uff0c\u5219\u4f1a\u62d2\u7edd\u672c\u6b21\u7fa4\u53d1\u8bf7\u6c42\uff0c\u8fd4\u56de\u5df2\u5b58\u5728\u7684\u7fa4\u53d1 msgid, \u63a7\u5236\u518d 64 \u4e2a\u5b57\u7b26\u5185\u3002\n        :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\u3002\n        \"\"\"\n        send_data = _build_send_data(msg_type, content)\n        send_data['send_ignore_reprint'] = send_ignore_reprint\n        if client_msg_id is not None:\n            send_data['clientmsgid'] = client_msg_id\n        if isinstance(user_list, list):\n            url = 'https://api.weixin.qq.com/cgi-bin/message/mass/send'\n            send_data['touser'] = user_list\n        else:\n            url = 'https://api.weixin.qq.com/cgi-bin/message/mass/sendall'\n            if user_list == None:\n                send_data['filter'] = {\n                    \"is_to_all\": True,\n                }\n            else:\n                send_data['filter'] = {\"is_to_all\": False, \"tag_id\": user_list}\n\n        return self.post(url=url, data=send_data)\n\n    def delete_mass_msg(self, msg_id, article_idx=0):\n        \"\"\"\n        \u7fa4\u53d1\u4e4b\u540e\uff0c\u968f\u65f6\u53ef\u4ee5\u901a\u8fc7\u8be5\u63a5\u53e3\u5220\u9664\u7fa4\u53d1\u3002\n\n        :param msg_id: \u53d1\u9001\u51fa\u53bb\u7684\u6d88\u606f ID\u3002\n        :param article_idx: \u8981\u5220\u9664\u7684\u6587\u7ae0\u5728\u56fe\u6587\u6d88\u606f\u4e2d\u7684\u4f4d\u7f6e\uff0c\u7b2c\u4e00\u7bc7\u7f16\u53f7\u4e3a 1\uff0c\u8be5\u5b57\u6bb5\u4e0d\u586b\u6216\u586b 0 \u4f1a\u5220\u9664\u5168\u90e8\u6587\u7ae0\u3002\n        :return: \u5fae\u4fe1\u8fd4\u56de\u7684 json \u6570\u636e\u3002\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/message/mass/delete\",\n            data={\n                \"msg_id\": msg_id,\n                \"article_idx\": article_idx\n            }\n        )\n\n    def send_mass_preview_to_user(\n        self, msg_type, content, user, user_type='openid'\n    ):\n        \"\"\"\n        \u5f00\u53d1\u8005\u53ef\u901a\u8fc7\u8be5\u63a5\u53e3\u53d1\u9001\u6d88\u606f\u7ed9\u6307\u5b9a\u7528\u6237\uff0c\u5728\u624b\u673a\u7aef\u67e5\u770b\u6d88\u606f\u7684\u6837\u5f0f\u548c\u6392\u7248\u3002\u4e3a\u4e86\u6ee1\u8db3\u7b2c\u4e09\u65b9\u5e73\u53f0\u5f00\u53d1\u8005\u7684\u9700\u6c42\uff0c\u5728\u4fdd\u7559\u5bf9 openID \u9884\u89c8\u80fd\u529b\u7684\u540c\u65f6\uff0c\u589e\u52a0\u4e86\u5bf9\u6307\u5b9a\u5fae\u4fe1\u53f7\u53d1\u9001\u9884\u89c8\u7684\u80fd\u529b\uff0c\u4f46\u8be5\u80fd\u529b\u6bcf\u65e5\u8c03\u7528\u6b21\u6570\u6709\u9650\u5236\uff08100 \u6b21\uff09\uff0c\u8bf7\u52ff\u6ee5\u7528\u3002\n\n        :param user_type: \u9884\u89c8\u5bf9\u8c61\uff0c`openid` \u4ee3\u8868\u4ee5 openid \u53d1\u9001\uff0c`wxname` \u4ee3\u8868\u4ee5\u5fae\u4fe1\u53f7\u53d1\u9001\u3002\n        :param msg_type: \u53d1\u9001\u7c7b\u578b\uff0c\u56fe\u6587\u6d88\u606f\u4e3a mpnews\uff0c\u6587\u672c\u6d88\u606f\u4e3a text\uff0c\u8bed\u97f3\u4e3a voice\uff0c\u97f3\u4e50\u4e3a music\uff0c\u56fe\u7247\u4e3a image\uff0c\u89c6\u9891\u4e3a video\uff0c\u5361\u5238\u4e3a wxcard\u3002\n        :param content: \u9884\u89c8\u5185\u5bb9\u3002\n        :param user: \u9884\u89c8\u7528\u6237\u3002\n        :return: \u8fd4\u56de\u7684 json\u3002\n        \"\"\"\n        send_data = _build_send_data(msg_type, content)\n        if user_type == 'openid':\n            send_data['touser'] = user\n        else:\n            send_data['towxname'] = user\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/message/mass/preview\",\n            data=send_data\n        )\n\n    def get_mass_msg_status(self, msg_id):\n        \"\"\"\n        \u67e5\u8be2\u7fa4\u53d1\u6d88\u606f\u53d1\u9001\u72b6\u6001\u3002\n\n        :param msg_id: \u7fa4\u53d1\u6d88\u606f\u540e\u8fd4\u56de\u7684\u6d88\u606f id\u3002\n        :return: \u8fd4\u56de\u7684 json\u3002\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/message/mass/get\",\n            data={'msg_id': msg_id}\n        )\n\n    def get_mass_msg_speed(self):\n        \"\"\"\n        \u83b7\u53d6\u7fa4\u53d1\u901f\u5ea6\u3002\n\n        :return: \u8fd4\u56de\u7684 json\u3002\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/message/mass/speed/get\",\n            data={}\n        )\n\n    def set_mass_msg_speed(self, speed):\n        \"\"\"\n        \u8bbe\u7f6e\u7fa4\u53d1\u901f\u5ea6\u3002\n\n        :param speed: \u7fa4\u53d1\u901f\u5ea6\u7684\u7ea7\u522b\uff0c\u662f\u4e00\u4e2a 0 \u5230 4 \u7684\u6574\u6570\uff0c\u6570\u5b57\u8d8a\u5927\u8868\u793a\u7fa4\u53d1\u901f\u5ea6\u8d8a\u6162\u3002\n        :return: \u8fd4\u56de\u7684 json\u3002\n        \"\"\"\n        return self.post(\n            url=\"https://api.weixin.qq.com/cgi-bin/message/mass/speed/set\",\n            data={\"speed\": speed}\n        )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.add_custom_service_account","title":"<code>add_custom_service_account(account, nickname)</code>","text":"<p>\u6dfb\u52a0\u5ba2\u670d\u5e10\u53f7\u3002</p> <p>:param account: \u5ba2\u670d\u8d26\u53f7\u7684\u7528\u6237\u540d :param nickname: \u5ba2\u670d\u8d26\u53f7\u7684\u6635\u79f0 :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def add_custom_service_account(self, account, nickname):\n    \"\"\"\n    \u6dfb\u52a0\u5ba2\u670d\u5e10\u53f7\u3002\n\n    :param account: \u5ba2\u670d\u8d26\u53f7\u7684\u7528\u6237\u540d\n    :param nickname: \u5ba2\u670d\u8d26\u53f7\u7684\u6635\u79f0\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/customservice/kfaccount/add\",\n        data={\n            \"kf_account\": account,\n            \"nickname\": nickname,\n        }\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.add_news","title":"<code>add_news(articles)</code>","text":"<p>\u65b0\u589e\u6c38\u4e45\u56fe\u6587\u7d20\u6750::</p> <pre><code>articles = [{\n   \"title\": TITLE,\n   \"thumb_media_id\": THUMB_MEDIA_ID,\n   \"author\": AUTHOR,\n   \"digest\": DIGEST,\n   \"show_cover_pic\": SHOW_COVER_PIC(0 / 1),\n   \"content\": CONTENT,\n   \"content_source_url\": CONTENT_SOURCE_URL\n}\n# \u82e5\u65b0\u589e\u7684\u662f\u591a\u56fe\u6587\u7d20\u6750\uff0c\u5219\u6b64\u5904\u5e94\u6709\u51e0\u6bb5articles\u7ed3\u6784\uff0c\u6700\u591a8\u6bb5\n]\nclient.add_news(articles)\n</code></pre> <p>:param articles: \u5982\u793a\u4f8b\u4e2d\u7684\u6570\u7ec4 :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def add_news(self, articles):\n    \"\"\"\n    \u65b0\u589e\u6c38\u4e45\u56fe\u6587\u7d20\u6750::\n\n        articles = [{\n           \"title\": TITLE,\n           \"thumb_media_id\": THUMB_MEDIA_ID,\n           \"author\": AUTHOR,\n           \"digest\": DIGEST,\n           \"show_cover_pic\": SHOW_COVER_PIC(0 / 1),\n           \"content\": CONTENT,\n           \"content_source_url\": CONTENT_SOURCE_URL\n        }\n        # \u82e5\u65b0\u589e\u7684\u662f\u591a\u56fe\u6587\u7d20\u6750\uff0c\u5219\u6b64\u5904\u5e94\u6709\u51e0\u6bb5articles\u7ed3\u6784\uff0c\u6700\u591a8\u6bb5\n        ]\n        client.add_news(articles)\n\n    :param articles: \u5982\u793a\u4f8b\u4e2d\u7684\u6570\u7ec4\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/material/add_news\",\n        data={\"articles\": articles}\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.create_custom_menu","title":"<code>create_custom_menu(menu_data, matchrule)</code>","text":"<p>\u521b\u5efa\u4e2a\u6027\u5316\u83dc\u5355::</p> <pre><code>button = [\n    {\n        \"type\":\"click\",\n        \"name\":\"\u4eca\u65e5\u6b4c\u66f2\",\n        \"key\":\"V1001_TODAY_MUSIC\"\n    },\n    {\n        \"name\":\"\u83dc\u5355\",\n        \"sub_button\":[\n        {\n            \"type\":\"view\",\n            \"name\":\"\u641c\u7d22\",\n            \"url\":\"http://www.soso.com/\"\n        },\n        {\n            \"type\":\"view\",\n            \"name\":\"\u89c6\u9891\",\n            \"url\":\"http://v.qq.com/\"\n        },\n        {\n            \"type\":\"click\",\n            \"name\":\"\u8d5e\u4e00\u4e0b\u6211\u4eec\",\n            \"key\":\"V1001_GOOD\"\n        }]\n }]\n matchrule = {\n    \"group_id\":\"2\",\n    \"sex\":\"1\",\n    \"country\":\"\u4e2d\u56fd\",\n    \"province\":\"\u5e7f\u4e1c\",\n    \"city\":\"\u5e7f\u5dde\",\n    \"client_platform_type\":\"2\",\n    \"language\":\"zh_CN\"\n}\nclient.create_custom_menu(button, matchrule)\n</code></pre> <p>:param menu_data: \u5982\u4e0a\u6240\u793a\u7684 Python \u5b57\u5178 :param matchrule: \u5982\u4e0a\u6240\u793a\u7684\u5339\u914d\u89c4\u5219 :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> <pre><code>    \u6b63\u786e\u65f6\u8fd4\u56de ``{\"menuid\":\"208379533\"}``\n\n    \u9519\u8bef\u65f6\u7684\u8fd4\u56de\u7801\u8bf7\u89c1\u63a5\u53e3\u8fd4\u56de\u7801\u8bf4\u660e.\n</code></pre> Source code in <code>zgrobot/client.py</code> <pre><code>def create_custom_menu(self, menu_data, matchrule):\n    \"\"\"\n    \u521b\u5efa\u4e2a\u6027\u5316\u83dc\u5355::\n\n        button = [\n            {\n                \"type\":\"click\",\n                \"name\":\"\u4eca\u65e5\u6b4c\u66f2\",\n                \"key\":\"V1001_TODAY_MUSIC\"\n            },\n            {\n                \"name\":\"\u83dc\u5355\",\n                \"sub_button\":[\n                {\n                    \"type\":\"view\",\n                    \"name\":\"\u641c\u7d22\",\n                    \"url\":\"http://www.soso.com/\"\n                },\n                {\n                    \"type\":\"view\",\n                    \"name\":\"\u89c6\u9891\",\n                    \"url\":\"http://v.qq.com/\"\n                },\n                {\n                    \"type\":\"click\",\n                    \"name\":\"\u8d5e\u4e00\u4e0b\u6211\u4eec\",\n                    \"key\":\"V1001_GOOD\"\n                }]\n         }]\n         matchrule = {\n            \"group_id\":\"2\",\n            \"sex\":\"1\",\n            \"country\":\"\u4e2d\u56fd\",\n            \"province\":\"\u5e7f\u4e1c\",\n            \"city\":\"\u5e7f\u5dde\",\n            \"client_platform_type\":\"2\",\n            \"language\":\"zh_CN\"\n        }\n        client.create_custom_menu(button, matchrule)\n\n    :param menu_data: \u5982\u4e0a\u6240\u793a\u7684 Python \u5b57\u5178\n    :param matchrule: \u5982\u4e0a\u6240\u793a\u7684\u5339\u914d\u89c4\u5219\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n\n            \u6b63\u786e\u65f6\u8fd4\u56de ``{\"menuid\":\"208379533\"}``\n\n            \u9519\u8bef\u65f6\u7684\u8fd4\u56de\u7801\u8bf7\u89c1\u63a5\u53e3\u8fd4\u56de\u7801\u8bf4\u660e.\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/menu/addconditional\",\n        data={\n            \"button\": menu_data,\n            \"matchrule\": matchrule\n        }\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.create_group","title":"<code>create_group(name)</code>","text":"<p>\u521b\u5efa\u5206\u7ec4\u3002</p> <p>:param name: \u5206\u7ec4\u540d\u5b57\uff0830\u4e2a\u5b57\u7b26\u4ee5\u5185\uff09 :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def create_group(self, name):\n    \"\"\"\n    \u521b\u5efa\u5206\u7ec4\u3002\n\n    :param name: \u5206\u7ec4\u540d\u5b57\uff0830\u4e2a\u5b57\u7b26\u4ee5\u5185\uff09\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n\n    \"\"\"\n    name = to_text(name)\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/groups/create\",\n        data={\"group\": {\n            \"name\": name\n        }}\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.create_menu","title":"<code>create_menu(menu_data)</code>","text":"<p>\u521b\u5efa\u81ea\u5b9a\u4e49\u83dc\u5355::</p> <pre><code>client.create_menu({\n    \"button\":[\n        {\n            \"type\":\"click\",\n            \"name\":\"\u4eca\u65e5\u6b4c\u66f2\",\n            \"key\":\"V1001_TODAY_MUSIC\"\n        },\n        {\n            \"type\":\"click\",\n            \"name\":\"\u6b4c\u624b\u7b80\u4ecb\",\n            \"key\":\"V1001_TODAY_SINGER\"\n        },\n        {\n            \"name\":\"\u83dc\u5355\",\n            \"sub_button\":[\n                {\n                    \"type\":\"view\",\n                    \"name\":\"\u641c\u7d22\",\n                    \"url\":\"http://www.soso.com/\"\n                },\n                {\n                    \"type\":\"view\",\n                    \"name\":\"\u89c6\u9891\",\n                    \"url\":\"http://v.qq.com/\"\n                },\n                {\n                    \"type\":\"click\",\n                    \"name\":\"\u8d5e\u4e00\u4e0b\u6211\u4eec\",\n                    \"key\":\"V1001_GOOD\"\n                }\n            ]\n        }\n    ]})\n</code></pre> <p>:param menu_data: Python \u5b57\u5178 :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> <pre><code>    \u6b63\u786e\u65f6\u8fd4\u56de ``{\"errcode\":0,\"errmsg\":\"ok\"}``\n\n    \u9519\u8bef\u65f6\u8fd4\u56de ``{\"errcode\":40018,\"errmsg\":\"invalid button name size\"}``\n</code></pre> Source code in <code>zgrobot/client.py</code> <pre><code>def create_menu(self, menu_data):\n    \"\"\"\n    \u521b\u5efa\u81ea\u5b9a\u4e49\u83dc\u5355::\n\n        client.create_menu({\n            \"button\":[\n                {\n                    \"type\":\"click\",\n                    \"name\":\"\u4eca\u65e5\u6b4c\u66f2\",\n                    \"key\":\"V1001_TODAY_MUSIC\"\n                },\n                {\n                    \"type\":\"click\",\n                    \"name\":\"\u6b4c\u624b\u7b80\u4ecb\",\n                    \"key\":\"V1001_TODAY_SINGER\"\n                },\n                {\n                    \"name\":\"\u83dc\u5355\",\n                    \"sub_button\":[\n                        {\n                            \"type\":\"view\",\n                            \"name\":\"\u641c\u7d22\",\n                            \"url\":\"http://www.soso.com/\"\n                        },\n                        {\n                            \"type\":\"view\",\n                            \"name\":\"\u89c6\u9891\",\n                            \"url\":\"http://v.qq.com/\"\n                        },\n                        {\n                            \"type\":\"click\",\n                            \"name\":\"\u8d5e\u4e00\u4e0b\u6211\u4eec\",\n                            \"key\":\"V1001_GOOD\"\n                        }\n                    ]\n                }\n            ]})\n\n    :param menu_data: Python \u5b57\u5178\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n\n            \u6b63\u786e\u65f6\u8fd4\u56de ``{\"errcode\":0,\"errmsg\":\"ok\"}``\n\n            \u9519\u8bef\u65f6\u8fd4\u56de ``{\"errcode\":40018,\"errmsg\":\"invalid button name size\"}``\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/menu/create\",\n        data=menu_data\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.create_qrcode","title":"<code>create_qrcode(data)</code>","text":"<p>\u521b\u5efa\u4e8c\u7ef4\u7801\u3002</p> <p>:param data: \u4f60\u8981\u53d1\u9001\u7684\u53c2\u6570 dict :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def create_qrcode(self, data):\n    \"\"\"\n    \u521b\u5efa\u4e8c\u7ef4\u7801\u3002\n\n    :param data: \u4f60\u8981\u53d1\u9001\u7684\u53c2\u6570 dict\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/qrcode/create\", data=data\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.create_tag","title":"<code>create_tag(tag_name)</code>","text":"<p>\u521b\u5efa\u4e00\u4e2a\u65b0\u6807\u7b7e</p> <p>:param tag_name: \u6807\u7b7e\u540d :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def create_tag(self, tag_name):\n    \"\"\"\n    \u521b\u5efa\u4e00\u4e2a\u65b0\u6807\u7b7e\n\n    :param tag_name: \u6807\u7b7e\u540d\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/tags/create\",\n        data={\"tag\": {\n            \"name\": tag_name\n        }}\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.delete_custom_menu","title":"<code>delete_custom_menu(menu_id)</code>","text":"<p>\u5220\u9664\u4e2a\u6027\u5316\u83dc\u5355\u3002</p> <p>:param menu_id: \u83dc\u5355\u7684 ID :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> <pre><code>    \u6b63\u786e\u65f6\u8fd4\u56de ``{\"errcode\":0,\"errmsg\":\"ok\"}``\n\n    \u9519\u8bef\u65f6\u7684\u8fd4\u56de\u7801\u8bf7\u89c1\u63a5\u53e3\u8fd4\u56de\u7801\u8bf4\u660e\u3002\n</code></pre> Source code in <code>zgrobot/client.py</code> <pre><code>def delete_custom_menu(self, menu_id):\n    \"\"\"\n    \u5220\u9664\u4e2a\u6027\u5316\u83dc\u5355\u3002\n\n    :param menu_id: \u83dc\u5355\u7684 ID\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n\n            \u6b63\u786e\u65f6\u8fd4\u56de ``{\"errcode\":0,\"errmsg\":\"ok\"}``\n\n            \u9519\u8bef\u65f6\u7684\u8fd4\u56de\u7801\u8bf7\u89c1\u63a5\u53e3\u8fd4\u56de\u7801\u8bf4\u660e\u3002\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/menu/delconditional\",\n        data={\"menuid\": menu_id}\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.delete_custom_service_account","title":"<code>delete_custom_service_account(account, nickname, password)</code>","text":"<p>\u5220\u9664\u5ba2\u670d\u5e10\u53f7\u3002</p> <p>:param account: \u5ba2\u670d\u8d26\u53f7\u7684\u7528\u6237\u540d :param nickname: \u5ba2\u670d\u8d26\u53f7\u7684\u6635\u79f0 :param password: \u5ba2\u670d\u8d26\u53f7\u7684\u5bc6\u7801 :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def delete_custom_service_account(self, account, nickname, password):\n    \"\"\"\n    \u5220\u9664\u5ba2\u670d\u5e10\u53f7\u3002\n\n    :param account: \u5ba2\u670d\u8d26\u53f7\u7684\u7528\u6237\u540d\n    :param nickname: \u5ba2\u670d\u8d26\u53f7\u7684\u6635\u79f0\n    :param password: \u5ba2\u670d\u8d26\u53f7\u7684\u5bc6\u7801\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/customservice/kfaccount/del\",\n        data={\n            \"kf_account\": account,\n            \"nickname\": nickname,\n            \"password\": password\n        }\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.delete_group","title":"<code>delete_group(group_id)</code>","text":"<p>\u5220\u9664\u5206\u7ec4\u3002</p> <p>:param group_id: \u8981\u5220\u9664\u7684\u5206\u7ec4\u7684 ID :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def delete_group(self, group_id):\n    \"\"\"\n    \u5220\u9664\u5206\u7ec4\u3002\n\n    :param group_id: \u8981\u5220\u9664\u7684\u5206\u7ec4\u7684 ID\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/groups/delete\",\n        data={\"group\": {\n            \"id\": group_id\n        }}\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.delete_mass_msg","title":"<code>delete_mass_msg(msg_id, article_idx=0)</code>","text":"<p>\u7fa4\u53d1\u4e4b\u540e\uff0c\u968f\u65f6\u53ef\u4ee5\u901a\u8fc7\u8be5\u63a5\u53e3\u5220\u9664\u7fa4\u53d1\u3002</p> <p>:param msg_id: \u53d1\u9001\u51fa\u53bb\u7684\u6d88\u606f ID\u3002 :param article_idx: \u8981\u5220\u9664\u7684\u6587\u7ae0\u5728\u56fe\u6587\u6d88\u606f\u4e2d\u7684\u4f4d\u7f6e\uff0c\u7b2c\u4e00\u7bc7\u7f16\u53f7\u4e3a 1\uff0c\u8be5\u5b57\u6bb5\u4e0d\u586b\u6216\u586b 0 \u4f1a\u5220\u9664\u5168\u90e8\u6587\u7ae0\u3002 :return: \u5fae\u4fe1\u8fd4\u56de\u7684 json \u6570\u636e\u3002</p> Source code in <code>zgrobot/client.py</code> <pre><code>def delete_mass_msg(self, msg_id, article_idx=0):\n    \"\"\"\n    \u7fa4\u53d1\u4e4b\u540e\uff0c\u968f\u65f6\u53ef\u4ee5\u901a\u8fc7\u8be5\u63a5\u53e3\u5220\u9664\u7fa4\u53d1\u3002\n\n    :param msg_id: \u53d1\u9001\u51fa\u53bb\u7684\u6d88\u606f ID\u3002\n    :param article_idx: \u8981\u5220\u9664\u7684\u6587\u7ae0\u5728\u56fe\u6587\u6d88\u606f\u4e2d\u7684\u4f4d\u7f6e\uff0c\u7b2c\u4e00\u7bc7\u7f16\u53f7\u4e3a 1\uff0c\u8be5\u5b57\u6bb5\u4e0d\u586b\u6216\u586b 0 \u4f1a\u5220\u9664\u5168\u90e8\u6587\u7ae0\u3002\n    :return: \u5fae\u4fe1\u8fd4\u56de\u7684 json \u6570\u636e\u3002\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/message/mass/delete\",\n        data={\n            \"msg_id\": msg_id,\n            \"article_idx\": article_idx\n        }\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.delete_menu","title":"<code>delete_menu()</code>","text":"<p>\u5220\u9664\u81ea\u5b9a\u4e49\u83dc\u5355\u3002</p> <p>:return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> <pre><code>    \u6b63\u786e\u65f6\u8fd4\u56de ``{\"errcode\":0,\"errmsg\":\"ok\"}``\n</code></pre> Source code in <code>zgrobot/client.py</code> <pre><code>def delete_menu(self):\n    \"\"\"\n    \u5220\u9664\u81ea\u5b9a\u4e49\u83dc\u5355\u3002\n\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n\n            \u6b63\u786e\u65f6\u8fd4\u56de ``{\"errcode\":0,\"errmsg\":\"ok\"}``\n    \"\"\"\n    return self.get(\"https://api.weixin.qq.com/cgi-bin/menu/delete\")\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.delete_permanent_media","title":"<code>delete_permanent_media(media_id)</code>","text":"<p>\u5220\u9664\u6c38\u4e45\u7d20\u6750\u3002</p> <p>:param media_id: \u5a92\u4f53\u6587\u4ef6 ID :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def delete_permanent_media(self, media_id):\n    \"\"\"\n    \u5220\u9664\u6c38\u4e45\u7d20\u6750\u3002\n\n    :param media_id: \u5a92\u4f53\u6587\u4ef6 ID\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/material/del_material\",\n        data={\"media_id\": media_id}\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.delete_tag","title":"<code>delete_tag(tag_id)</code>","text":"<p>\u5220\u9664\u6807\u7b7e</p> <p>:param tag_id: \u6807\u7b7e ID :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def delete_tag(self, tag_id):\n    \"\"\"\n    \u5220\u9664\u6807\u7b7e\n\n    :param tag_id: \u6807\u7b7e ID\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/tags/delete\",\n        data={\"tag\": {\n            \"id\": tag_id,\n        }}\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.download_media","title":"<code>download_media(media_id)</code>","text":"<p>\u4e0b\u8f7d\u4e34\u65f6\u591a\u5a92\u4f53\u6587\u4ef6\u3002</p> <p>:param media_id: \u5a92\u4f53\u6587\u4ef6 ID :return: requests \u7684 Response \u5b9e\u4f8b</p> Source code in <code>zgrobot/client.py</code> <pre><code>def download_media(self, media_id):\n    \"\"\"\n    \u4e0b\u8f7d\u4e34\u65f6\u591a\u5a92\u4f53\u6587\u4ef6\u3002\n\n    :param media_id: \u5a92\u4f53\u6587\u4ef6 ID\n    :return: requests \u7684 Response \u5b9e\u4f8b\n    \"\"\"\n    return requests.get(\n        url=\"https://api.weixin.qq.com/cgi-bin/media/get\",\n        params={\n            \"access_token\": self.token,\n            \"media_id\": media_id\n        }\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.download_permanent_media","title":"<code>download_permanent_media(media_id)</code>","text":"<p>\u83b7\u53d6\u6c38\u4e45\u7d20\u6750\u3002</p> <p>:param media_id: \u5a92\u4f53\u6587\u4ef6 ID :return: requests \u7684 Response \u5b9e\u4f8b</p> Source code in <code>zgrobot/client.py</code> <pre><code>def download_permanent_media(self, media_id):\n    \"\"\"\n    \u83b7\u53d6\u6c38\u4e45\u7d20\u6750\u3002\n\n    :param media_id: \u5a92\u4f53\u6587\u4ef6 ID\n    :return: requests \u7684 Response \u5b9e\u4f8b\n    \"\"\"\n    return requests.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/material/get_material\",\n        params={\"access_token\": self.token},\n        data=_json.dumps({\n            \"media_id\": media_id\n        }, ensure_ascii=False).encode(\"utf-8\")\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.get_access_token","title":"<code>get_access_token()</code>","text":"<p>\u5224\u65ad\u73b0\u6709\u7684token\u662f\u5426\u8fc7\u671f\u3002 \u7528\u6237\u9700\u8981\u591a\u8fdb\u7a0b\u6216\u8005\u591a\u673a\u90e8\u7f72\u53ef\u4ee5\u624b\u52a8\u91cd\u5199\u8fd9\u4e2a\u51fd\u6570 \u6765\u81ea\u5b9a\u4e49token\u7684\u5b58\u50a8\uff0c\u5237\u65b0\u7b56\u7565\u3002</p> <p>:return: \u8fd4\u56de <code>token</code></p> Source code in <code>zgrobot/client.py</code> <pre><code>def get_access_token(self) -&gt; str:\n    \"\"\"\n    \u5224\u65ad\u73b0\u6709\u7684token\u662f\u5426\u8fc7\u671f\u3002\n    \u7528\u6237\u9700\u8981\u591a\u8fdb\u7a0b\u6216\u8005\u591a\u673a\u90e8\u7f72\u53ef\u4ee5\u624b\u52a8\u91cd\u5199\u8fd9\u4e2a\u51fd\u6570\n    \u6765\u81ea\u5b9a\u4e49token\u7684\u5b58\u50a8\uff0c\u5237\u65b0\u7b56\u7565\u3002\n\n    :return: \u8fd4\u56de ``token``\n    \"\"\"\n    if self._token:\n        now = time.time()\n        if self.token_expires_at - now &gt; 60:\n            return self._token\n    with LOCK:\n        json_str = self.grant_token()\n        self._token = json_str[\"access_token\"]\n        self.token_expires_at = int(time.time()) + json_str[\"expires_in\"]\n    return self._token\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.get_custom_menu_config","title":"<code>get_custom_menu_config()</code>","text":"<p>\u83b7\u53d6\u81ea\u5b9a\u4e49\u83dc\u5355\u914d\u7f6e\u63a5\u53e3\u3002</p> <p>:return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def get_custom_menu_config(self):\n    \"\"\"\n    \u83b7\u53d6\u81ea\u5b9a\u4e49\u83dc\u5355\u914d\u7f6e\u63a5\u53e3\u3002\n\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.get(\n        url=\"https://api.weixin.qq.com/cgi-bin/get_current_selfmenu_info\"\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.get_custom_service_account_list","title":"<code>get_custom_service_account_list()</code>","text":"<p>\u83b7\u53d6\u6240\u6709\u5ba2\u670d\u8d26\u53f7\u3002</p> <p>:return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def get_custom_service_account_list(self):\n    \"\"\"\n    \u83b7\u53d6\u6240\u6709\u5ba2\u670d\u8d26\u53f7\u3002\n\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.get(\n        url=\"https://api.weixin.qq.com/cgi-bin/customservice/getkflist\"\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.get_followers","title":"<code>get_followers(first_user_id=None)</code>","text":"<p>\u83b7\u53d6\u5173\u6ce8\u8005\u5217\u8868 \u8be6\u60c5\u8bf7\u53c2\u8003 https://developers.weixin.qq.com/doc/offiaccount/User_Management/Getting_a_User_List.html</p> <p>:param first_user_id: \u53ef\u9009\u3002\u7b2c\u4e00\u4e2a\u62c9\u53d6\u7684OPENID\uff0c\u4e0d\u586b\u9ed8\u8ba4\u4ece\u5934\u5f00\u59cb\u62c9\u53d6 :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def get_followers(self, first_user_id=None):\n    \"\"\"\n    \u83b7\u53d6\u5173\u6ce8\u8005\u5217\u8868\n    \u8be6\u60c5\u8bf7\u53c2\u8003 https://developers.weixin.qq.com/doc/offiaccount/User_Management/Getting_a_User_List.html\n\n    :param first_user_id: \u53ef\u9009\u3002\u7b2c\u4e00\u4e2a\u62c9\u53d6\u7684OPENID\uff0c\u4e0d\u586b\u9ed8\u8ba4\u4ece\u5934\u5f00\u59cb\u62c9\u53d6\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    params = {\"access_token\": self.token}\n    if first_user_id:\n        params[\"next_openid\"] = first_user_id\n    return self.get(\n        \"https://api.weixin.qq.com/cgi-bin/user/get\", params=params\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.get_group_by_id","title":"<code>get_group_by_id(openid)</code>","text":"<p>\u67e5\u8be2\u7528\u6237\u6240\u5728\u5206\u7ec4\u3002</p> <p>:param openid: \u7528\u6237\u7684OpenID :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def get_group_by_id(self, openid):\n    \"\"\"\n    \u67e5\u8be2\u7528\u6237\u6240\u5728\u5206\u7ec4\u3002\n\n    :param openid: \u7528\u6237\u7684OpenID\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/groups/getid\",\n        data={\"openid\": openid}\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.get_groups","title":"<code>get_groups()</code>","text":"<p>\u67e5\u8be2\u6240\u6709\u5206\u7ec4\u3002</p> <p>:return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def get_groups(self):\n    \"\"\"\n    \u67e5\u8be2\u6240\u6709\u5206\u7ec4\u3002\n\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.get(\"https://api.weixin.qq.com/cgi-bin/groups/get\")\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.get_ip_list","title":"<code>get_ip_list()</code>","text":"<p>\u83b7\u53d6\u5fae\u4fe1\u670d\u52a1\u5668IP\u5730\u5740\u3002</p> <p>:return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> <pre><code>    \u6b63\u5e38\u65f6\u8fd4\u56de ``{\"ip_list\": [\"127.0.0.1\", \"127.0.0.2\", \"101.226.103.0/25\"]}``\n\n    \u9519\u8bef\u65f6\u8fd4\u56de ``{\"errcode\":40013,\"errmsg\":\"invalid appid\"}``\n</code></pre> Source code in <code>zgrobot/client.py</code> <pre><code>def get_ip_list(self):\n    \"\"\"\n    \u83b7\u53d6\u5fae\u4fe1\u670d\u52a1\u5668IP\u5730\u5740\u3002\n\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n\n            \u6b63\u5e38\u65f6\u8fd4\u56de ``{\"ip_list\": [\"127.0.0.1\", \"127.0.0.2\", \"101.226.103.0/25\"]}``\n\n            \u9519\u8bef\u65f6\u8fd4\u56de ``{\"errcode\":40013,\"errmsg\":\"invalid appid\"}``\n    \"\"\"\n    return self.get(url=\"https://api.weixin.qq.com/cgi-bin/getcallbackip\")\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.get_mass_msg_speed","title":"<code>get_mass_msg_speed()</code>","text":"<p>\u83b7\u53d6\u7fa4\u53d1\u901f\u5ea6\u3002</p> <p>:return: \u8fd4\u56de\u7684 json\u3002</p> Source code in <code>zgrobot/client.py</code> <pre><code>def get_mass_msg_speed(self):\n    \"\"\"\n    \u83b7\u53d6\u7fa4\u53d1\u901f\u5ea6\u3002\n\n    :return: \u8fd4\u56de\u7684 json\u3002\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/message/mass/speed/get\",\n        data={}\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.get_mass_msg_status","title":"<code>get_mass_msg_status(msg_id)</code>","text":"<p>\u67e5\u8be2\u7fa4\u53d1\u6d88\u606f\u53d1\u9001\u72b6\u6001\u3002</p> <p>:param msg_id: \u7fa4\u53d1\u6d88\u606f\u540e\u8fd4\u56de\u7684\u6d88\u606f id\u3002 :return: \u8fd4\u56de\u7684 json\u3002</p> Source code in <code>zgrobot/client.py</code> <pre><code>def get_mass_msg_status(self, msg_id):\n    \"\"\"\n    \u67e5\u8be2\u7fa4\u53d1\u6d88\u606f\u53d1\u9001\u72b6\u6001\u3002\n\n    :param msg_id: \u7fa4\u53d1\u6d88\u606f\u540e\u8fd4\u56de\u7684\u6d88\u606f id\u3002\n    :return: \u8fd4\u56de\u7684 json\u3002\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/message/mass/get\",\n        data={'msg_id': msg_id}\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.get_media_count","title":"<code>get_media_count()</code>","text":"<p>\u83b7\u53d6\u7d20\u6750\u603b\u6570\u3002</p> <p>:return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def get_media_count(self):\n    \"\"\"\n    \u83b7\u53d6\u7d20\u6750\u603b\u6570\u3002\n\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.get(\n        url=\"https://api.weixin.qq.com/cgi-bin/material/get_materialcount\"\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.get_media_list","title":"<code>get_media_list(media_type, offset, count)</code>","text":"<p>\u83b7\u53d6\u7d20\u6750\u5217\u8868\u3002</p> <p>:param media_type: \u7d20\u6750\u7684\u7c7b\u578b\uff0c\u56fe\u7247\uff08image\uff09\u3001\u89c6\u9891\uff08video\uff09\u3001\u8bed\u97f3 \uff08voice\uff09\u3001\u56fe\u6587\uff08news\uff09 :param offset: \u4ece\u5168\u90e8\u7d20\u6750\u7684\u8be5\u504f\u79fb\u4f4d\u7f6e\u5f00\u59cb\u8fd4\u56de\uff0c0\u8868\u793a\u4ece\u7b2c\u4e00\u4e2a\u7d20\u6750\u8fd4\u56de :param count: \u8fd4\u56de\u7d20\u6750\u7684\u6570\u91cf\uff0c\u53d6\u503c\u57281\u523020\u4e4b\u95f4 :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def get_media_list(self, media_type, offset, count):\n    \"\"\"\n    \u83b7\u53d6\u7d20\u6750\u5217\u8868\u3002\n\n    :param media_type: \u7d20\u6750\u7684\u7c7b\u578b\uff0c\u56fe\u7247\uff08image\uff09\u3001\u89c6\u9891\uff08video\uff09\u3001\u8bed\u97f3 \uff08voice\uff09\u3001\u56fe\u6587\uff08news\uff09\n    :param offset: \u4ece\u5168\u90e8\u7d20\u6750\u7684\u8be5\u504f\u79fb\u4f4d\u7f6e\u5f00\u59cb\u8fd4\u56de\uff0c0\u8868\u793a\u4ece\u7b2c\u4e00\u4e2a\u7d20\u6750\u8fd4\u56de\n    :param count: \u8fd4\u56de\u7d20\u6750\u7684\u6570\u91cf\uff0c\u53d6\u503c\u57281\u523020\u4e4b\u95f4\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/material/batchget_material\",\n        data={\n            \"type\": media_type,\n            \"offset\": offset,\n            \"count\": count\n        }\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.get_menu","title":"<code>get_menu()</code>","text":"<p>\u67e5\u8be2\u81ea\u5b9a\u4e49\u83dc\u5355\u3002</p> <p>:return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def get_menu(self):\n    \"\"\"\n    \u67e5\u8be2\u81ea\u5b9a\u4e49\u83dc\u5355\u3002\n\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.get(\"https://api.weixin.qq.com/cgi-bin/menu/get\")\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.get_online_custom_service_account_list","title":"<code>get_online_custom_service_account_list()</code>","text":"<p>\u83b7\u53d6\u72b6\u6001\u4e3a\"\u5728\u7ebf\"\u7684\u5ba2\u670d\u8d26\u53f7\u5217\u8868\u3002</p> <p>:return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def get_online_custom_service_account_list(self):\n    \"\"\"\n    \u83b7\u53d6\u72b6\u6001\u4e3a\"\u5728\u7ebf\"\u7684\u5ba2\u670d\u8d26\u53f7\u5217\u8868\u3002\n\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.get(\n        url=\"https://api.weixin.qq.com/cgi-bin/customservice/getonlinekflist\"\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.get_tags","title":"<code>get_tags()</code>","text":"<p>\u83b7\u53d6\u5df2\u7ecf\u5b58\u5728\u7684\u6807\u7b7e</p> <p>:return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def get_tags(self):\n    \"\"\"\n    \u83b7\u53d6\u5df2\u7ecf\u5b58\u5728\u7684\u6807\u7b7e\n\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.get(url=\"https://api.weixin.qq.com/cgi-bin/tags/get\", )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.get_tags_by_user","title":"<code>get_tags_by_user(open_id)</code>","text":"<p>\u83b7\u53d6\u7528\u6237\u8eab\u4e0a\u7684\u6807\u7b7e\u5217\u8868</p> <p>:param open_id: \u7528\u6237\u7684 OPENID :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def get_tags_by_user(self, open_id):\n    \"\"\"\n    \u83b7\u53d6\u7528\u6237\u8eab\u4e0a\u7684\u6807\u7b7e\u5217\u8868\n\n    :param open_id: \u7528\u6237\u7684 OPENID\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/tags/getidlist\",\n        data={\n            \"openid\": open_id,\n        }\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.get_user_info","title":"<code>get_user_info(user_id, lang='zh_CN')</code>","text":"<p>\u83b7\u53d6\u7528\u6237\u57fa\u672c\u4fe1\u606f\u3002</p> <p>:param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 <code>Message</code> \u7684 source :param lang: \u8fd4\u56de\u56fd\u5bb6\u5730\u533a\u8bed\u8a00\u7248\u672c\uff0czh_CN \u7b80\u4f53\uff0czh_TW \u7e41\u4f53\uff0cen \u82f1\u8bed :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def get_user_info(self, user_id, lang=\"zh_CN\"):\n    \"\"\"\n    \u83b7\u53d6\u7528\u6237\u57fa\u672c\u4fe1\u606f\u3002\n\n    :param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 `Message` \u7684 source\n    :param lang: \u8fd4\u56de\u56fd\u5bb6\u5730\u533a\u8bed\u8a00\u7248\u672c\uff0czh_CN \u7b80\u4f53\uff0czh_TW \u7e41\u4f53\uff0cen \u82f1\u8bed\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.get(\n        url=\"https://api.weixin.qq.com/cgi-bin/user/info\",\n        params={\n            \"access_token\": self.token,\n            \"openid\": user_id,\n            \"lang\": lang\n        }\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.get_users_by_tag","title":"<code>get_users_by_tag(tag_id, next_open_id='')</code>","text":"<p>\u83b7\u53d6\u6807\u7b7e\u4e0b\u7c89\u4e1d\u5217\u8868</p> <p>:param tag_id: \u6807\u7b7e ID :param next_open_id: \u7b2c\u4e00\u4e2a\u62c9\u53d6\u7528\u6237\u7684 OPENID\uff0c\u9ed8\u8ba4\u4ece\u5934\u5f00\u59cb\u62c9\u53d6 :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def get_users_by_tag(self, tag_id, next_open_id=\"\"):\n    \"\"\"\n    \u83b7\u53d6\u6807\u7b7e\u4e0b\u7c89\u4e1d\u5217\u8868\n\n    :param tag_id: \u6807\u7b7e ID\n    :param next_open_id: \u7b2c\u4e00\u4e2a\u62c9\u53d6\u7528\u6237\u7684 OPENID\uff0c\u9ed8\u8ba4\u4ece\u5934\u5f00\u59cb\u62c9\u53d6\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/user/tag/get\",\n        data={\n            \"tagid\": tag_id,\n            \"next_openid\": next_open_id\n        }\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.get_users_info","title":"<code>get_users_info(user_id_list, lang='zh_CN')</code>","text":"<p>\u6279\u91cf\u83b7\u53d6\u7528\u6237\u57fa\u672c\u4fe1\u606f\u3002</p> <p>:param user_id_list: \u7528\u6237 ID \u7684\u5217\u8868 :param lang: \u8fd4\u56de\u56fd\u5bb6\u5730\u533a\u8bed\u8a00\u7248\u672c\uff0czh_CN \u7b80\u4f53\uff0czh_TW \u7e41\u4f53\uff0cen \u82f1\u8bed :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def get_users_info(self, user_id_list, lang=\"zh_CN\"):\n    \"\"\"\n    \u6279\u91cf\u83b7\u53d6\u7528\u6237\u57fa\u672c\u4fe1\u606f\u3002\n\n    :param user_id_list: \u7528\u6237 ID \u7684\u5217\u8868\n    :param lang: \u8fd4\u56de\u56fd\u5bb6\u5730\u533a\u8bed\u8a00\u7248\u672c\uff0czh_CN \u7b80\u4f53\uff0czh_TW \u7e41\u4f53\uff0cen \u82f1\u8bed\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/user/info/batchget\",\n        data={\n            \"user_list\": [\n                {\n                    \"openid\": user_id,\n                    \"lang\": lang\n                } for user_id in user_id_list\n            ]\n        }\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.grant_token","title":"<code>grant_token()</code>","text":"<p>\u83b7\u53d6 Access Token\u3002</p> <p>:return: \u8fd4\u56de\u7684 <code>JSON</code> \u6570\u636e\u5305</p> <pre><code>    \u6b63\u5e38\u65f6\u8fd4\u56de ``{\"access_token\":\"ACCESS_TOKEN\", \"expires_in\":7200}``\n\n    \u9519\u8bef\u65f6\u8fd4\u56de ``{\"errcode\":40013,\"errmsg\":\"invalid appid\"}``\n</code></pre> Source code in <code>zgrobot/client.py</code> <pre><code>def grant_token(self):\n    \"\"\"\n    \u83b7\u53d6 Access Token\u3002\n\n    :return: \u8fd4\u56de\u7684 ``JSON`` \u6570\u636e\u5305\n\n            \u6b63\u5e38\u65f6\u8fd4\u56de ``{\"access_token\":\"ACCESS_TOKEN\", \"expires_in\":7200}``\n\n            \u9519\u8bef\u65f6\u8fd4\u56de ``{\"errcode\":40013,\"errmsg\":\"invalid appid\"}``\n    \"\"\"\n    return self.get(\n        url=\"https://api.weixin.qq.com/cgi-bin/token\",\n        params={\n            \"grant_type\": \"client_credential\",\n            \"appid\": self.appid,\n            \"secret\": self.appsecret\n        }\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.match_custom_menu","title":"<code>match_custom_menu(user_id)</code>","text":"<p>\u6d4b\u8bd5\u4e2a\u6027\u5316\u83dc\u5355\u5339\u914d\u7ed3\u679c\u3002</p> <p>:param user_id: \u8981\u6d4b\u8bd5\u5339\u914d\u7684\u7528\u6237 ID\uff0c\u4e5f\u53ef\u4ee5\u662f\u7528\u6237\u7684\u5fae\u4fe1\u53f7 :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def match_custom_menu(self, user_id):\n    \"\"\"\n    \u6d4b\u8bd5\u4e2a\u6027\u5316\u83dc\u5355\u5339\u914d\u7ed3\u679c\u3002\n\n    :param user_id: \u8981\u6d4b\u8bd5\u5339\u914d\u7684\u7528\u6237 ID\uff0c\u4e5f\u53ef\u4ee5\u662f\u7528\u6237\u7684\u5fae\u4fe1\u53f7\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/menu/trymatch\",\n        data={\"user_id\": user_id}\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.move_user","title":"<code>move_user(user_id, group_id)</code>","text":"<p>\u79fb\u52a8\u7528\u6237\u5206\u7ec4\u3002</p> <p>:param user_id: \u7528\u6237 ID\uff0c\u5373\u6536\u5230\u7684 <code>Message</code> \u7684 source :param group_id: \u5206\u7ec4 ID :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def move_user(self, user_id, group_id):\n    \"\"\"\n    \u79fb\u52a8\u7528\u6237\u5206\u7ec4\u3002\n\n    :param user_id: \u7528\u6237 ID\uff0c\u5373\u6536\u5230\u7684 `Message` \u7684 source\n    :param group_id: \u5206\u7ec4 ID\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/groups/members/update\",\n        data={\n            \"openid\": user_id,\n            \"to_groupid\": group_id\n        }\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.move_users","title":"<code>move_users(user_id_list, group_id)</code>","text":"<p>\u6279\u91cf\u79fb\u52a8\u7528\u6237\u5206\u7ec4\u3002</p> <p>:param user_id_list: \u7528\u6237 ID \u7684\u5217\u8868\uff08\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\uff09 :param group_id: \u5206\u7ec4 ID :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def move_users(self, user_id_list, group_id):\n    \"\"\"\n    \u6279\u91cf\u79fb\u52a8\u7528\u6237\u5206\u7ec4\u3002\n\n    :param user_id_list: \u7528\u6237 ID \u7684\u5217\u8868\uff08\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\uff09\n    :param group_id: \u5206\u7ec4 ID\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/groups/members/batchupdate\",\n        data={\n            \"openid_list\": user_id_list,\n            \"to_groupid\": group_id\n        }\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.remark_user","title":"<code>remark_user(user_id, remark)</code>","text":"<p>\u8bbe\u7f6e\u5907\u6ce8\u540d\u3002</p> <p>:param user_id: \u8bbe\u7f6e\u5907\u6ce8\u540d\u7684\u7528\u6237 ID :param remark: \u65b0\u7684\u5907\u6ce8\u540d\uff0c\u957f\u5ea6\u5fc5\u987b\u5c0f\u4e8e30\u5b57\u7b26 :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def remark_user(self, user_id, remark):\n    \"\"\"\n    \u8bbe\u7f6e\u5907\u6ce8\u540d\u3002\n\n    :param user_id: \u8bbe\u7f6e\u5907\u6ce8\u540d\u7684\u7528\u6237 ID\n    :param remark: \u65b0\u7684\u5907\u6ce8\u540d\uff0c\u957f\u5ea6\u5fc5\u987b\u5c0f\u4e8e30\u5b57\u7b26\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/user/info/updateremark\",\n        data={\n            \"openid\": user_id,\n            \"remark\": remark\n        }\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.send_article_message","title":"<code>send_article_message(user_id, articles, kf_account=None)</code>","text":"<p>\u53d1\u9001\u56fe\u6587\u6d88\u606f::</p> <pre><code>articles = [\n    {\n        \"title\":\"Happy Day\",\n        \"description\":\"Is Really A Happy Day\",\n        \"url\":\"URL\",\n        \"picurl\":\"PIC_URL\"\n    },\n    {\n        \"title\":\"Happy Day\",\n        \"description\":\"Is Really A Happy Day\",\n        \"url\":\"URL\",\n        \"picurl\":\"PIC_URL\"\n    }\n]\nclient.send_acticle_message(\"user_id\", acticles)\n</code></pre> <p>:param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 <code>Message</code> \u7684 source :param articles: \u4e00\u4e2a\u5305\u542b\u81f3\u591a8\u4e2a article \u5b57\u5178\u6216 Article \u5bf9\u8c61\u7684\u6570\u7ec4 :param kf_account: \u53d1\u9001\u6d88\u606f\u7684\u5ba2\u670d\u8d26\u6237\uff0c\u9ed8\u8ba4\u503c\u4e3a None\uff0cNone \u4e3a\u4e0d\u6307\u5b9a :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def send_article_message(self, user_id, articles, kf_account=None):\n    \"\"\"\n    \u53d1\u9001\u56fe\u6587\u6d88\u606f::\n\n        articles = [\n            {\n                \"title\":\"Happy Day\",\n                \"description\":\"Is Really A Happy Day\",\n                \"url\":\"URL\",\n                \"picurl\":\"PIC_URL\"\n            },\n            {\n                \"title\":\"Happy Day\",\n                \"description\":\"Is Really A Happy Day\",\n                \"url\":\"URL\",\n                \"picurl\":\"PIC_URL\"\n            }\n        ]\n        client.send_acticle_message(\"user_id\", acticles)\n\n    :param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 `Message` \u7684 source\n    :param articles: \u4e00\u4e2a\u5305\u542b\u81f3\u591a8\u4e2a article \u5b57\u5178\u6216 Article \u5bf9\u8c61\u7684\u6570\u7ec4\n    :param kf_account: \u53d1\u9001\u6d88\u606f\u7684\u5ba2\u670d\u8d26\u6237\uff0c\u9ed8\u8ba4\u503c\u4e3a None\uff0cNone \u4e3a\u4e0d\u6307\u5b9a\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    if isinstance(articles[0], Article):\n        formatted_articles = []\n        for article in articles:\n            result = article.args\n            result[\"picurl\"] = result.pop(\"img\")\n            formatted_articles.append(result)\n    else:\n        formatted_articles = articles\n    data = {\n        \"touser\": user_id,\n        \"msgtype\": \"news\",\n        \"news\": {\n            \"articles\": formatted_articles\n        }\n    }\n    if kf_account is not None:\n        data['customservice'] = {'kf_account': kf_account}\n    return self.post(url=SEND_MESSAGE_URL, data=data)\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.send_image_message","title":"<code>send_image_message(user_id, media_id, kf_account=None)</code>","text":"<p>\u53d1\u9001\u56fe\u7247\u6d88\u606f\u3002</p> <p>:param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 <code>Message</code> \u7684 source :param media_id: \u56fe\u7247\u7684\u5a92\u4f53ID\u3002 \u53ef\u4ee5\u901a\u8fc7 :func:<code>upload_media</code> \u4e0a\u4f20\u3002 :param kf_account: \u53d1\u9001\u6d88\u606f\u7684\u5ba2\u670d\u8d26\u6237\uff0c\u9ed8\u8ba4\u503c\u4e3a None\uff0cNone \u4e3a\u4e0d\u6307\u5b9a :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def send_image_message(self, user_id, media_id, kf_account=None):\n    \"\"\"\n    \u53d1\u9001\u56fe\u7247\u6d88\u606f\u3002\n\n    :param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 `Message` \u7684 source\n    :param media_id: \u56fe\u7247\u7684\u5a92\u4f53ID\u3002 \u53ef\u4ee5\u901a\u8fc7 :func:`upload_media` \u4e0a\u4f20\u3002\n    :param kf_account: \u53d1\u9001\u6d88\u606f\u7684\u5ba2\u670d\u8d26\u6237\uff0c\u9ed8\u8ba4\u503c\u4e3a None\uff0cNone \u4e3a\u4e0d\u6307\u5b9a\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    data = {\n        \"touser\": user_id,\n        \"msgtype\": \"image\",\n        \"image\": {\n            \"media_id\": media_id\n        }\n    }\n    if kf_account is not None:\n        data['customservice'] = {'kf_account': kf_account}\n    return self.post(url=SEND_MESSAGE_URL, data=data)\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.send_mass_msg","title":"<code>send_mass_msg(msg_type, content, user_list=None, send_ignore_reprint=False, client_msg_id=None)</code>","text":"<p>\u5411\u6307\u5b9a\u5bf9\u8c61\u7fa4\u53d1\u4fe1\u606f\u3002</p> <p>:param msg_type: \u7fa4\u53d1\u7c7b\u578b\uff0c\u56fe\u6587\u6d88\u606f\u4e3a mpnews\uff0c\u6587\u672c\u6d88\u606f\u4e3a text\uff0c\u8bed\u97f3\u4e3a voice\uff0c\u97f3\u4e50\u4e3a music\uff0c\u56fe\u7247\u4e3a image\uff0c\u89c6\u9891\u4e3a video\uff0c\u5361\u5238\u4e3a wxcard\u3002 :param content: \u7fa4\u53d1\u5185\u5bb9\u3002 :param user_list: \u53d1\u9001\u5bf9\u8c61\uff0c\u6574\u578b\u4ee3\u8868\u7528\u6237\u7ec4\uff0c\u5217\u8868\u4ee3\u8868\u6307\u5b9a\u7528\u6237\uff0c\u5982\u679c\u4e3a None \u5219\u4ee3\u8868\u5168\u90e8\u53d1\u9001\u3002 :param send_ignore_reprint: \u56fe\u6587\u6d88\u606f\u88ab\u5224\u5b9a\u4e3a\u8f6c\u8f7d\u65f6\uff0c\u662f\u5426\u7ee7\u7eed\u7fa4\u53d1\u3002 True \u4e3a\u7ee7\u7eed\u7fa4\u53d1\uff08\u8f6c\u8f7d\uff09\uff0cFalse \u4e3a\u505c\u6b62\u7fa4\u53d1\u3002 \u8be5\u53c2\u6570\u9ed8\u8ba4\u4e3a False\u3002 :param client_msg_id: \u7fa4\u53d1\u65f6\uff0c\u5fae\u4fe1\u540e\u53f0\u5c06\u5bf9 24 \u5c0f\u65f6\u5185\u7684\u7fa4\u53d1\u8bb0\u5f55\u8fdb\u884c\u68c0\u67e5\uff0c\u5982\u679c\u8be5 clientmsgid \u5df2\u7ecf\u5b58\u5728\u4e00\u6761\u7fa4\u53d1\u8bb0\u5f55\uff0c\u5219\u4f1a\u62d2\u7edd\u672c\u6b21\u7fa4\u53d1\u8bf7\u6c42\uff0c\u8fd4\u56de\u5df2\u5b58\u5728\u7684\u7fa4\u53d1 msgid, \u63a7\u5236\u518d 64 \u4e2a\u5b57\u7b26\u5185\u3002 :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\u3002</p> Source code in <code>zgrobot/client.py</code> <pre><code>def send_mass_msg(\n    self,\n    msg_type,\n    content,\n    user_list=None,\n    send_ignore_reprint=False,\n    client_msg_id=None\n):\n    \"\"\"\n    \u5411\u6307\u5b9a\u5bf9\u8c61\u7fa4\u53d1\u4fe1\u606f\u3002\n\n    :param msg_type: \u7fa4\u53d1\u7c7b\u578b\uff0c\u56fe\u6587\u6d88\u606f\u4e3a mpnews\uff0c\u6587\u672c\u6d88\u606f\u4e3a text\uff0c\u8bed\u97f3\u4e3a voice\uff0c\u97f3\u4e50\u4e3a music\uff0c\u56fe\u7247\u4e3a image\uff0c\u89c6\u9891\u4e3a video\uff0c\u5361\u5238\u4e3a wxcard\u3002\n    :param content: \u7fa4\u53d1\u5185\u5bb9\u3002\n    :param user_list: \u53d1\u9001\u5bf9\u8c61\uff0c\u6574\u578b\u4ee3\u8868\u7528\u6237\u7ec4\uff0c\u5217\u8868\u4ee3\u8868\u6307\u5b9a\u7528\u6237\uff0c\u5982\u679c\u4e3a None \u5219\u4ee3\u8868\u5168\u90e8\u53d1\u9001\u3002\n    :param send_ignore_reprint: \u56fe\u6587\u6d88\u606f\u88ab\u5224\u5b9a\u4e3a\u8f6c\u8f7d\u65f6\uff0c\u662f\u5426\u7ee7\u7eed\u7fa4\u53d1\u3002 True \u4e3a\u7ee7\u7eed\u7fa4\u53d1\uff08\u8f6c\u8f7d\uff09\uff0cFalse \u4e3a\u505c\u6b62\u7fa4\u53d1\u3002 \u8be5\u53c2\u6570\u9ed8\u8ba4\u4e3a False\u3002\n    :param client_msg_id: \u7fa4\u53d1\u65f6\uff0c\u5fae\u4fe1\u540e\u53f0\u5c06\u5bf9 24 \u5c0f\u65f6\u5185\u7684\u7fa4\u53d1\u8bb0\u5f55\u8fdb\u884c\u68c0\u67e5\uff0c\u5982\u679c\u8be5 clientmsgid \u5df2\u7ecf\u5b58\u5728\u4e00\u6761\u7fa4\u53d1\u8bb0\u5f55\uff0c\u5219\u4f1a\u62d2\u7edd\u672c\u6b21\u7fa4\u53d1\u8bf7\u6c42\uff0c\u8fd4\u56de\u5df2\u5b58\u5728\u7684\u7fa4\u53d1 msgid, \u63a7\u5236\u518d 64 \u4e2a\u5b57\u7b26\u5185\u3002\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\u3002\n    \"\"\"\n    send_data = _build_send_data(msg_type, content)\n    send_data['send_ignore_reprint'] = send_ignore_reprint\n    if client_msg_id is not None:\n        send_data['clientmsgid'] = client_msg_id\n    if isinstance(user_list, list):\n        url = 'https://api.weixin.qq.com/cgi-bin/message/mass/send'\n        send_data['touser'] = user_list\n    else:\n        url = 'https://api.weixin.qq.com/cgi-bin/message/mass/sendall'\n        if user_list == None:\n            send_data['filter'] = {\n                \"is_to_all\": True,\n            }\n        else:\n            send_data['filter'] = {\"is_to_all\": False, \"tag_id\": user_list}\n\n    return self.post(url=url, data=send_data)\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.send_mass_preview_to_user","title":"<code>send_mass_preview_to_user(msg_type, content, user, user_type='openid')</code>","text":"<p>\u5f00\u53d1\u8005\u53ef\u901a\u8fc7\u8be5\u63a5\u53e3\u53d1\u9001\u6d88\u606f\u7ed9\u6307\u5b9a\u7528\u6237\uff0c\u5728\u624b\u673a\u7aef\u67e5\u770b\u6d88\u606f\u7684\u6837\u5f0f\u548c\u6392\u7248\u3002\u4e3a\u4e86\u6ee1\u8db3\u7b2c\u4e09\u65b9\u5e73\u53f0\u5f00\u53d1\u8005\u7684\u9700\u6c42\uff0c\u5728\u4fdd\u7559\u5bf9 openID \u9884\u89c8\u80fd\u529b\u7684\u540c\u65f6\uff0c\u589e\u52a0\u4e86\u5bf9\u6307\u5b9a\u5fae\u4fe1\u53f7\u53d1\u9001\u9884\u89c8\u7684\u80fd\u529b\uff0c\u4f46\u8be5\u80fd\u529b\u6bcf\u65e5\u8c03\u7528\u6b21\u6570\u6709\u9650\u5236\uff08100 \u6b21\uff09\uff0c\u8bf7\u52ff\u6ee5\u7528\u3002</p> <p>:param user_type: \u9884\u89c8\u5bf9\u8c61\uff0c<code>openid</code> \u4ee3\u8868\u4ee5 openid \u53d1\u9001\uff0c<code>wxname</code> \u4ee3\u8868\u4ee5\u5fae\u4fe1\u53f7\u53d1\u9001\u3002 :param msg_type: \u53d1\u9001\u7c7b\u578b\uff0c\u56fe\u6587\u6d88\u606f\u4e3a mpnews\uff0c\u6587\u672c\u6d88\u606f\u4e3a text\uff0c\u8bed\u97f3\u4e3a voice\uff0c\u97f3\u4e50\u4e3a music\uff0c\u56fe\u7247\u4e3a image\uff0c\u89c6\u9891\u4e3a video\uff0c\u5361\u5238\u4e3a wxcard\u3002 :param content: \u9884\u89c8\u5185\u5bb9\u3002 :param user: \u9884\u89c8\u7528\u6237\u3002 :return: \u8fd4\u56de\u7684 json\u3002</p> Source code in <code>zgrobot/client.py</code> <pre><code>def send_mass_preview_to_user(\n    self, msg_type, content, user, user_type='openid'\n):\n    \"\"\"\n    \u5f00\u53d1\u8005\u53ef\u901a\u8fc7\u8be5\u63a5\u53e3\u53d1\u9001\u6d88\u606f\u7ed9\u6307\u5b9a\u7528\u6237\uff0c\u5728\u624b\u673a\u7aef\u67e5\u770b\u6d88\u606f\u7684\u6837\u5f0f\u548c\u6392\u7248\u3002\u4e3a\u4e86\u6ee1\u8db3\u7b2c\u4e09\u65b9\u5e73\u53f0\u5f00\u53d1\u8005\u7684\u9700\u6c42\uff0c\u5728\u4fdd\u7559\u5bf9 openID \u9884\u89c8\u80fd\u529b\u7684\u540c\u65f6\uff0c\u589e\u52a0\u4e86\u5bf9\u6307\u5b9a\u5fae\u4fe1\u53f7\u53d1\u9001\u9884\u89c8\u7684\u80fd\u529b\uff0c\u4f46\u8be5\u80fd\u529b\u6bcf\u65e5\u8c03\u7528\u6b21\u6570\u6709\u9650\u5236\uff08100 \u6b21\uff09\uff0c\u8bf7\u52ff\u6ee5\u7528\u3002\n\n    :param user_type: \u9884\u89c8\u5bf9\u8c61\uff0c`openid` \u4ee3\u8868\u4ee5 openid \u53d1\u9001\uff0c`wxname` \u4ee3\u8868\u4ee5\u5fae\u4fe1\u53f7\u53d1\u9001\u3002\n    :param msg_type: \u53d1\u9001\u7c7b\u578b\uff0c\u56fe\u6587\u6d88\u606f\u4e3a mpnews\uff0c\u6587\u672c\u6d88\u606f\u4e3a text\uff0c\u8bed\u97f3\u4e3a voice\uff0c\u97f3\u4e50\u4e3a music\uff0c\u56fe\u7247\u4e3a image\uff0c\u89c6\u9891\u4e3a video\uff0c\u5361\u5238\u4e3a wxcard\u3002\n    :param content: \u9884\u89c8\u5185\u5bb9\u3002\n    :param user: \u9884\u89c8\u7528\u6237\u3002\n    :return: \u8fd4\u56de\u7684 json\u3002\n    \"\"\"\n    send_data = _build_send_data(msg_type, content)\n    if user_type == 'openid':\n        send_data['touser'] = user\n    else:\n        send_data['towxname'] = user\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/message/mass/preview\",\n        data=send_data\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.send_miniprogrampage_message","title":"<code>send_miniprogrampage_message(user_id, title, appid, pagepath, thumb_media_id, kf_account=None)</code>","text":"<p>\u53d1\u9001\u5c0f\u7a0b\u5e8f\u5361\u7247\uff08\u8981\u6c42\u5c0f\u7a0b\u5e8f\u4e0e\u516c\u4f17\u53f7\u5df2\u5173\u8054\uff09</p> <p>:param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 <code>Message</code> \u7684 source :param title: \u5c0f\u7a0b\u5e8f\u5361\u7247\u7684\u6807\u9898 :param appid: \u5c0f\u7a0b\u5e8f\u7684 appid\uff0c\u8981\u6c42\u5c0f\u7a0b\u5e8f\u7684 appid \u9700\u8981\u4e0e\u516c\u4f17\u53f7\u6709\u5173\u8054\u5173\u7cfb :param pagepath: \u5c0f\u7a0b\u5e8f\u7684\u9875\u9762\u8def\u5f84\uff0c\u8ddf app.json \u5bf9\u9f50\uff0c\u652f\u6301\u53c2\u6570\uff0c\u6bd4\u5982 pages/index/index?foo=bar :param thumb_media_id: \u5c0f\u7a0b\u5e8f\u5361\u7247\u56fe\u7247\u7684\u5a92\u4f53 ID\uff0c\u5c0f\u7a0b\u5e8f\u5361\u7247\u56fe\u7247\u5efa\u8bae\u5927\u5c0f\u4e3a 520*416 :param kf_account: \u9700\u8981\u4ee5\u67d0\u4e2a\u5ba2\u670d\u5e10\u53f7\u6765\u53d1\u6d88\u606f\u65f6\u6307\u5b9a\u7684\u5ba2\u670d\u8d26\u6237 :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def send_miniprogrampage_message(\n    self,\n    user_id,\n    title,\n    appid,\n    pagepath,\n    thumb_media_id,\n    kf_account=None\n):\n    \"\"\"\n    \u53d1\u9001\u5c0f\u7a0b\u5e8f\u5361\u7247\uff08\u8981\u6c42\u5c0f\u7a0b\u5e8f\u4e0e\u516c\u4f17\u53f7\u5df2\u5173\u8054\uff09\n\n    :param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 `Message` \u7684 source\n    :param title: \u5c0f\u7a0b\u5e8f\u5361\u7247\u7684\u6807\u9898\n    :param appid: \u5c0f\u7a0b\u5e8f\u7684 appid\uff0c\u8981\u6c42\u5c0f\u7a0b\u5e8f\u7684 appid \u9700\u8981\u4e0e\u516c\u4f17\u53f7\u6709\u5173\u8054\u5173\u7cfb\n    :param pagepath: \u5c0f\u7a0b\u5e8f\u7684\u9875\u9762\u8def\u5f84\uff0c\u8ddf app.json \u5bf9\u9f50\uff0c\u652f\u6301\u53c2\u6570\uff0c\u6bd4\u5982 pages/index/index?foo=bar\n    :param thumb_media_id: \u5c0f\u7a0b\u5e8f\u5361\u7247\u56fe\u7247\u7684\u5a92\u4f53 ID\uff0c\u5c0f\u7a0b\u5e8f\u5361\u7247\u56fe\u7247\u5efa\u8bae\u5927\u5c0f\u4e3a 520*416\n    :param kf_account: \u9700\u8981\u4ee5\u67d0\u4e2a\u5ba2\u670d\u5e10\u53f7\u6765\u53d1\u6d88\u606f\u65f6\u6307\u5b9a\u7684\u5ba2\u670d\u8d26\u6237\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    data = {\n        \"touser\": user_id,\n        \"msgtype\": \"miniprogrampage\",\n        \"miniprogrampage\": {\n            \"title\": title,\n            \"appid\": appid,\n            \"pagepath\": pagepath,\n            \"thumb_media_id\": thumb_media_id\n        }\n    }\n    if kf_account is not None:\n        data[\"customservice\"] = {\"kf_account\": kf_account}\n    return self.post(url=SEND_MESSAGE_URL, data=data)\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.send_music_message","title":"<code>send_music_message(user_id, url, hq_url, thumb_media_id, title=None, description=None, kf_account=None)</code>","text":"<p>\u53d1\u9001\u97f3\u4e50\u6d88\u606f\u3002 \u6ce8\u610f\u5982\u679c\u4f60\u9047\u5230\u4e86\u7f29\u7565\u56fe\u4e0d\u80fd\u6b63\u5e38\u663e\u793a\u7684\u95ee\u9898\uff0c \u4e0d\u8981\u614c\u5f20\uff1b \u76ee\u524d\u6765\u770b\u662f\u5fae\u4fe1\u670d\u52a1\u5668\u7aef\u7684\u95ee\u9898\u3002 \u5bf9\u6b64\u6211\u4eec\u4e5f\u65e0\u80fd\u4e3a\u529b ( <code>#197 &lt;https://github.com/whtsky/ZgRoBot/issues/197&gt;</code>_ )</p> <p>:param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 <code>Message</code> \u7684 source :param url: \u97f3\u4e50\u94fe\u63a5 :param hq_url: \u9ad8\u54c1\u8d28\u97f3\u4e50\u94fe\u63a5\uff0cwifi\u73af\u5883\u4f18\u5148\u4f7f\u7528\u8be5\u94fe\u63a5\u64ad\u653e\u97f3\u4e50 :param thumb_media_id: \u7f29\u7565\u56fe\u7684\u5a92\u4f53ID\u3002 \u53ef\u4ee5\u901a\u8fc7 :func:<code>upload_media</code> \u4e0a\u4f20\u3002 :param title: \u97f3\u4e50\u6807\u9898 :param description: \u97f3\u4e50\u63cf\u8ff0 :param kf_account: \u53d1\u9001\u6d88\u606f\u7684\u5ba2\u670d\u8d26\u6237\uff0c\u9ed8\u8ba4\u503c\u4e3a None\uff0cNone \u4e3a\u4e0d\u6307\u5b9a :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def send_music_message(\n    self,\n    user_id,\n    url,\n    hq_url,\n    thumb_media_id,\n    title=None,\n    description=None,\n    kf_account=None\n):\n    \"\"\"\n    \u53d1\u9001\u97f3\u4e50\u6d88\u606f\u3002\n    \u6ce8\u610f\u5982\u679c\u4f60\u9047\u5230\u4e86\u7f29\u7565\u56fe\u4e0d\u80fd\u6b63\u5e38\u663e\u793a\u7684\u95ee\u9898\uff0c \u4e0d\u8981\u614c\u5f20\uff1b \u76ee\u524d\u6765\u770b\u662f\u5fae\u4fe1\u670d\u52a1\u5668\u7aef\u7684\u95ee\u9898\u3002\n    \u5bf9\u6b64\u6211\u4eec\u4e5f\u65e0\u80fd\u4e3a\u529b ( `#197 &lt;https://github.com/whtsky/ZgRoBot/issues/197&gt;`_ )\n\n    :param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 `Message` \u7684 source\n    :param url: \u97f3\u4e50\u94fe\u63a5\n    :param hq_url: \u9ad8\u54c1\u8d28\u97f3\u4e50\u94fe\u63a5\uff0cwifi\u73af\u5883\u4f18\u5148\u4f7f\u7528\u8be5\u94fe\u63a5\u64ad\u653e\u97f3\u4e50\n    :param thumb_media_id: \u7f29\u7565\u56fe\u7684\u5a92\u4f53ID\u3002 \u53ef\u4ee5\u901a\u8fc7 :func:`upload_media` \u4e0a\u4f20\u3002\n    :param title: \u97f3\u4e50\u6807\u9898\n    :param description: \u97f3\u4e50\u63cf\u8ff0\n    :param kf_account: \u53d1\u9001\u6d88\u606f\u7684\u5ba2\u670d\u8d26\u6237\uff0c\u9ed8\u8ba4\u503c\u4e3a None\uff0cNone \u4e3a\u4e0d\u6307\u5b9a\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    music_data = {\n        \"musicurl\": url,\n        \"hqmusicurl\": hq_url,\n        \"thumb_media_id\": thumb_media_id\n    }\n    if title:\n        music_data[\"title\"] = title\n    if description:\n        music_data[\"description\"] = description\n    data = {\"touser\": user_id, \"msgtype\": \"music\", \"music\": music_data}\n    if kf_account is not None:\n        data['customservice'] = {'kf_account': kf_account}\n\n    return self.post(url=SEND_MESSAGE_URL, data=data)\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.send_news_message","title":"<code>send_news_message(user_id, media_id, kf_account=None)</code>","text":"<p>\u53d1\u9001\u6c38\u4e45\u7d20\u6750\u4e2d\u7684\u56fe\u6587\u6d88\u606f\u3002</p> <p>:param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 <code>Message</code> \u7684 source :param media_id: \u5a92\u4f53\u6587\u4ef6 ID :param kf_account: \u53d1\u9001\u6d88\u606f\u7684\u5ba2\u670d\u8d26\u6237\uff0c\u9ed8\u8ba4\u503c\u4e3a None\uff0cNone \u4e3a\u4e0d\u6307\u5b9a :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def send_news_message(self, user_id, media_id, kf_account=None):\n    \"\"\"\n    \u53d1\u9001\u6c38\u4e45\u7d20\u6750\u4e2d\u7684\u56fe\u6587\u6d88\u606f\u3002\n\n    :param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 `Message` \u7684 source\n    :param media_id: \u5a92\u4f53\u6587\u4ef6 ID\n    :param kf_account: \u53d1\u9001\u6d88\u606f\u7684\u5ba2\u670d\u8d26\u6237\uff0c\u9ed8\u8ba4\u503c\u4e3a None\uff0cNone \u4e3a\u4e0d\u6307\u5b9a\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    data = {\n        \"touser\": user_id,\n        \"msgtype\": \"mpnews\",\n        \"mpnews\": {\n            \"media_id\": media_id\n        }\n    }\n    if kf_account is not None:\n        data['customservice'] = {'kf_account': kf_account}\n    return self.post(url=SEND_MESSAGE_URL, data=data)\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.send_template_message","title":"<code>send_template_message(user_id, template_id, data, url='', miniprogram=None)</code>","text":"<p>\u53d1\u9001\u6a21\u677f\u6d88\u606f \u8be6\u60c5\u8bf7\u53c2\u8003 https://developers.weixin.qq.com/doc/offiaccount/Message_Management/Template_Message_Interface.html</p> <p>:param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 <code>Message</code> \u7684 source :param template_id: \u6a21\u677f ID\u3002 :param data: \u7528\u4e8e\u6e32\u67d3\u6a21\u677f\u7684\u6570\u636e\u3002 :param url: \u6a21\u677f\u6d88\u606f\u7684\u53ef\u9009\u94fe\u63a5\u3002 :param miniprogram: \u8df3\u5c0f\u7a0b\u5e8f\u6240\u9700\u6570\u636e\u7684\u53ef\u9009\u6570\u636e\u3002 :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def send_template_message(\n    self, user_id, template_id, data, url='', miniprogram=None\n):\n    \"\"\"\n    \u53d1\u9001\u6a21\u677f\u6d88\u606f\n    \u8be6\u60c5\u8bf7\u53c2\u8003 https://developers.weixin.qq.com/doc/offiaccount/Message_Management/Template_Message_Interface.html\n\n    :param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 `Message` \u7684 source\n    :param template_id: \u6a21\u677f ID\u3002\n    :param data: \u7528\u4e8e\u6e32\u67d3\u6a21\u677f\u7684\u6570\u636e\u3002\n    :param url: \u6a21\u677f\u6d88\u606f\u7684\u53ef\u9009\u94fe\u63a5\u3002\n    :param miniprogram: \u8df3\u5c0f\u7a0b\u5e8f\u6240\u9700\u6570\u636e\u7684\u53ef\u9009\u6570\u636e\u3002\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    payload = {\n        \"touser\": user_id,\n        \"template_id\": template_id,\n        \"url\": url,\n        \"data\": data\n    }\n    if miniprogram:\n        payload[\"miniprogram\"] = miniprogram\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/message/template/send\",\n        data=payload\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.send_text_message","title":"<code>send_text_message(user_id, content, kf_account=None)</code>","text":"<p>\u53d1\u9001\u6587\u672c\u6d88\u606f\u3002</p> <p>:param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 <code>Message</code> \u7684 source :param content: \u6d88\u606f\u6b63\u6587 :param kf_account: \u53d1\u9001\u6d88\u606f\u7684\u5ba2\u670d\u8d26\u6237\uff0c\u9ed8\u8ba4\u503c\u4e3a None\uff0cNone \u4e3a\u4e0d\u6307\u5b9a :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def send_text_message(self, user_id, content, kf_account=None):\n    \"\"\"\n    \u53d1\u9001\u6587\u672c\u6d88\u606f\u3002\n\n    :param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 `Message` \u7684 source\n    :param content: \u6d88\u606f\u6b63\u6587\n    :param kf_account: \u53d1\u9001\u6d88\u606f\u7684\u5ba2\u670d\u8d26\u6237\uff0c\u9ed8\u8ba4\u503c\u4e3a None\uff0cNone \u4e3a\u4e0d\u6307\u5b9a\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    data = {\n        \"touser\": user_id,\n        \"msgtype\": \"text\",\n        \"text\": {\n            \"content\": content\n        }\n    }\n    if kf_account is not None:\n        data['customservice'] = {'kf_account': kf_account}\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/message/custom/send\",\n        data=data\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.send_video_message","title":"<code>send_video_message(user_id, media_id, title=None, description=None, kf_account=None)</code>","text":"<p>\u53d1\u9001\u89c6\u9891\u6d88\u606f\u3002</p> <p>:param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 <code>Message</code> \u7684 source :param media_id: \u53d1\u9001\u7684\u89c6\u9891\u7684\u5a92\u4f53ID\u3002 \u53ef\u4ee5\u901a\u8fc7 :func:<code>upload_media</code> \u4e0a\u4f20\u3002 :param title: \u89c6\u9891\u6d88\u606f\u7684\u6807\u9898 :param description: \u89c6\u9891\u6d88\u606f\u7684\u63cf\u8ff0 :param kf_account: \u53d1\u9001\u6d88\u606f\u7684\u5ba2\u670d\u8d26\u6237\uff0c\u9ed8\u8ba4\u503c\u4e3a None\uff0cNone \u4e3a\u4e0d\u6307\u5b9a :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def send_video_message(\n    self,\n    user_id,\n    media_id,\n    title=None,\n    description=None,\n    kf_account=None\n):\n    \"\"\"\n    \u53d1\u9001\u89c6\u9891\u6d88\u606f\u3002\n\n    :param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 `Message` \u7684 source\n    :param media_id: \u53d1\u9001\u7684\u89c6\u9891\u7684\u5a92\u4f53ID\u3002 \u53ef\u4ee5\u901a\u8fc7 :func:`upload_media` \u4e0a\u4f20\u3002\n    :param title: \u89c6\u9891\u6d88\u606f\u7684\u6807\u9898\n    :param description: \u89c6\u9891\u6d88\u606f\u7684\u63cf\u8ff0\n    :param kf_account: \u53d1\u9001\u6d88\u606f\u7684\u5ba2\u670d\u8d26\u6237\uff0c\u9ed8\u8ba4\u503c\u4e3a None\uff0cNone \u4e3a\u4e0d\u6307\u5b9a\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    video_data = {\n        \"media_id\": media_id,\n    }\n    if title:\n        video_data[\"title\"] = title\n    if description:\n        video_data[\"description\"] = description\n    data = {\"touser\": user_id, \"msgtype\": \"video\", \"video\": video_data}\n    if kf_account is not None:\n        data['customservice'] = {'kf_account': kf_account}\n    return self.post(url=SEND_MESSAGE_URL, data=data)\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.send_voice_message","title":"<code>send_voice_message(user_id, media_id, kf_account=None)</code>","text":"<p>\u53d1\u9001\u8bed\u97f3\u6d88\u606f\u3002</p> <p>:param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 <code>Message</code> \u7684 source :param media_id: \u53d1\u9001\u7684\u8bed\u97f3\u7684\u5a92\u4f53ID\u3002 \u53ef\u4ee5\u901a\u8fc7 :func:<code>upload_media</code> \u4e0a\u4f20\u3002 :param kf_account: \u53d1\u9001\u6d88\u606f\u7684\u5ba2\u670d\u8d26\u6237\uff0c\u9ed8\u8ba4\u503c\u4e3a None\uff0cNone \u4e3a\u4e0d\u6307\u5b9a :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def send_voice_message(self, user_id, media_id, kf_account=None):\n    \"\"\"\n    \u53d1\u9001\u8bed\u97f3\u6d88\u606f\u3002\n\n    :param user_id: \u7528\u6237 ID \u3002 \u5c31\u662f\u4f60\u6536\u5230\u7684 `Message` \u7684 source\n    :param media_id: \u53d1\u9001\u7684\u8bed\u97f3\u7684\u5a92\u4f53ID\u3002 \u53ef\u4ee5\u901a\u8fc7 :func:`upload_media` \u4e0a\u4f20\u3002\n    :param kf_account: \u53d1\u9001\u6d88\u606f\u7684\u5ba2\u670d\u8d26\u6237\uff0c\u9ed8\u8ba4\u503c\u4e3a None\uff0cNone \u4e3a\u4e0d\u6307\u5b9a\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    data = {\n        \"touser\": user_id,\n        \"msgtype\": \"voice\",\n        \"voice\": {\n            \"media_id\": media_id\n        }\n    }\n    if kf_account is not None:\n        data['customservice'] = {'kf_account': kf_account}\n    return self.post(url=SEND_MESSAGE_URL, data=data)\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.set_mass_msg_speed","title":"<code>set_mass_msg_speed(speed)</code>","text":"<p>\u8bbe\u7f6e\u7fa4\u53d1\u901f\u5ea6\u3002</p> <p>:param speed: \u7fa4\u53d1\u901f\u5ea6\u7684\u7ea7\u522b\uff0c\u662f\u4e00\u4e2a 0 \u5230 4 \u7684\u6574\u6570\uff0c\u6570\u5b57\u8d8a\u5927\u8868\u793a\u7fa4\u53d1\u901f\u5ea6\u8d8a\u6162\u3002 :return: \u8fd4\u56de\u7684 json\u3002</p> Source code in <code>zgrobot/client.py</code> <pre><code>def set_mass_msg_speed(self, speed):\n    \"\"\"\n    \u8bbe\u7f6e\u7fa4\u53d1\u901f\u5ea6\u3002\n\n    :param speed: \u7fa4\u53d1\u901f\u5ea6\u7684\u7ea7\u522b\uff0c\u662f\u4e00\u4e2a 0 \u5230 4 \u7684\u6574\u6570\uff0c\u6570\u5b57\u8d8a\u5927\u8868\u793a\u7fa4\u53d1\u901f\u5ea6\u8d8a\u6162\u3002\n    :return: \u8fd4\u56de\u7684 json\u3002\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/message/mass/speed/set\",\n        data={\"speed\": speed}\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.show_qrcode","title":"<code>show_qrcode(ticket)</code>","text":"<p>\u901a\u8fc7ticket\u6362\u53d6\u4e8c\u7ef4\u7801\u3002</p> <p>:param ticket: \u4e8c\u7ef4\u7801 ticket \u3002\u53ef\u4ee5\u901a\u8fc7 :func:<code>create_qrcode</code> \u83b7\u53d6\u5230 :return: \u8fd4\u56de\u7684 Request \u5bf9\u8c61</p> Source code in <code>zgrobot/client.py</code> <pre><code>def show_qrcode(self, ticket):\n    \"\"\"\n    \u901a\u8fc7ticket\u6362\u53d6\u4e8c\u7ef4\u7801\u3002\n\n    :param ticket: \u4e8c\u7ef4\u7801 ticket \u3002\u53ef\u4ee5\u901a\u8fc7 :func:`create_qrcode` \u83b7\u53d6\u5230\n    :return: \u8fd4\u56de\u7684 Request \u5bf9\u8c61\n    \"\"\"\n    return requests.get(\n        url=\"https://mp.weixin.qq.com/cgi-bin/showqrcode\",\n        params={\"ticket\": ticket}\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.tag_users","title":"<code>tag_users(tag_id, open_id_list)</code>","text":"<p>\u6279\u91cf\u4e3a\u7528\u6237\u6253\u6807\u7b7e</p> <p>:param tag_id: \u6807\u7b7e ID :param open_id_list: \u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u7528\u6237\u7684 OPENID \u7684\u5217\u8868 :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def tag_users(self, tag_id, open_id_list):\n    \"\"\"\n    \u6279\u91cf\u4e3a\u7528\u6237\u6253\u6807\u7b7e\n\n    :param tag_id: \u6807\u7b7e ID\n    :param open_id_list: \u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u7528\u6237\u7684 OPENID \u7684\u5217\u8868\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/tags/members/batchtagging\",\n        data={\n            \"openid_list\": open_id_list,\n            \"tagid\": tag_id\n        }\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.untag_users","title":"<code>untag_users(tag_id, open_id_list)</code>","text":"<p>\u6279\u91cf\u4e3a\u7528\u6237\u53d6\u6d88\u6807\u7b7e</p> <p>:param tag_id: \u6807\u7b7e ID :param open_id_list: \u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u7528\u6237\u7684 OPENID \u7684\u5217\u8868 :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def untag_users(self, tag_id, open_id_list):\n    \"\"\"\n    \u6279\u91cf\u4e3a\u7528\u6237\u53d6\u6d88\u6807\u7b7e\n\n    :param tag_id: \u6807\u7b7e ID\n    :param open_id_list: \u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u7528\u6237\u7684 OPENID \u7684\u5217\u8868\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/tags/members/batchuntagging\",\n        data={\n            \"openid_list\": open_id_list,\n            \"tagid\": tag_id\n        }\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.update_custom_service_account","title":"<code>update_custom_service_account(account, nickname, password)</code>","text":"<p>\u4fee\u6539\u5ba2\u670d\u5e10\u53f7\u3002</p> <p>:param account: \u5ba2\u670d\u8d26\u53f7\u7684\u7528\u6237\u540d :param nickname: \u5ba2\u670d\u8d26\u53f7\u7684\u6635\u79f0 :param password: \u5ba2\u670d\u8d26\u53f7\u7684\u5bc6\u7801 :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def update_custom_service_account(self, account, nickname, password):\n    \"\"\"\n    \u4fee\u6539\u5ba2\u670d\u5e10\u53f7\u3002\n\n    :param account: \u5ba2\u670d\u8d26\u53f7\u7684\u7528\u6237\u540d\n    :param nickname: \u5ba2\u670d\u8d26\u53f7\u7684\u6635\u79f0\n    :param password: \u5ba2\u670d\u8d26\u53f7\u7684\u5bc6\u7801\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/customservice/kfaccount/update\",\n        data={\n            \"kf_account\": account,\n            \"nickname\": nickname,\n            \"password\": password\n        }\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.update_group","title":"<code>update_group(group_id, name)</code>","text":"<p>\u4fee\u6539\u5206\u7ec4\u540d\u3002</p> <p>:param group_id: \u5206\u7ec4 ID\uff0c\u7531\u5fae\u4fe1\u5206\u914d :param name: \u5206\u7ec4\u540d\u5b57\uff0830\u4e2a\u5b57\u7b26\u4ee5\u5185\uff09 :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def update_group(self, group_id, name):\n    \"\"\"\n    \u4fee\u6539\u5206\u7ec4\u540d\u3002\n\n    :param group_id: \u5206\u7ec4 ID\uff0c\u7531\u5fae\u4fe1\u5206\u914d\n    :param name: \u5206\u7ec4\u540d\u5b57\uff0830\u4e2a\u5b57\u7b26\u4ee5\u5185\uff09\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/groups/update\",\n        data={\"group\": {\n            \"id\": int(group_id),\n            \"name\": to_text(name)\n        }}\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.update_news","title":"<code>update_news(update_data)</code>","text":"<p>\u4fee\u6539\u6c38\u4e45\u56fe\u6587\u7d20\u6750::</p> <pre><code>update_data = {\n    \"media_id\":MEDIA_ID,\n    \"index\":INDEX,\n    \"articles\": {\n        \"title\": TITLE,\n        \"thumb_media_id\": THUMB_MEDIA_ID,\n        \"author\": AUTHOR,\n        \"digest\": DIGEST,\n        \"show_cover_pic\": SHOW_COVER_PIC(0 / 1),\n        \"content\": CONTENT,\n        \"content_source_url\": CONTENT_SOURCE_URL\n    }\n}\nclient.update_news(update_data)\n</code></pre> <p>:param update_data: \u66f4\u65b0\u7684\u6570\u636e\uff0c\u8981\u5305\u542b media_id\uff08\u56fe\u6587\u7d20\u6750\u7684 ID\uff09\uff0cindex\uff08\u8981\u66f4\u65b0\u7684\u6587\u7ae0\u5728\u56fe\u6587\u6d88\u606f\u4e2d\u7684\u4f4d\u7f6e\uff09\uff0carticles\uff08\u65b0\u7684\u56fe\u6587\u7d20\u6750\u6570\u636e\uff09 :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def update_news(self, update_data):\n    \"\"\"\n    \u4fee\u6539\u6c38\u4e45\u56fe\u6587\u7d20\u6750::\n\n        update_data = {\n            \"media_id\":MEDIA_ID,\n            \"index\":INDEX,\n            \"articles\": {\n                \"title\": TITLE,\n                \"thumb_media_id\": THUMB_MEDIA_ID,\n                \"author\": AUTHOR,\n                \"digest\": DIGEST,\n                \"show_cover_pic\": SHOW_COVER_PIC(0 / 1),\n                \"content\": CONTENT,\n                \"content_source_url\": CONTENT_SOURCE_URL\n            }\n        }\n        client.update_news(update_data)\n\n    :param update_data: \u66f4\u65b0\u7684\u6570\u636e\uff0c\u8981\u5305\u542b media_id\uff08\u56fe\u6587\u7d20\u6750\u7684 ID\uff09\uff0cindex\uff08\u8981\u66f4\u65b0\u7684\u6587\u7ae0\u5728\u56fe\u6587\u6d88\u606f\u4e2d\u7684\u4f4d\u7f6e\uff09\uff0carticles\uff08\u65b0\u7684\u56fe\u6587\u7d20\u6750\u6570\u636e\uff09\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/material/update_news\",\n        data=update_data\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.update_tag","title":"<code>update_tag(tag_id, tag_name)</code>","text":"<p>\u4fee\u6539\u6807\u7b7e</p> <p>:param tag_id: \u6807\u7b7e ID :param tag_name: \u65b0\u7684\u6807\u7b7e\u540d :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def update_tag(self, tag_id, tag_name):\n    \"\"\"\n    \u4fee\u6539\u6807\u7b7e\n\n    :param tag_id: \u6807\u7b7e ID\n    :param tag_name: \u65b0\u7684\u6807\u7b7e\u540d\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/tags/update\",\n        data={\"tag\": {\n            \"id\": tag_id,\n            \"name\": tag_name\n        }}\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.upload_custom_service_account_avatar","title":"<code>upload_custom_service_account_avatar(account, avatar)</code>","text":"<p>\u8bbe\u7f6e\u5ba2\u670d\u5e10\u53f7\u7684\u5934\u50cf\u3002</p> <p>:param account: \u5ba2\u670d\u8d26\u53f7\u7684\u7528\u6237\u540d :param avatar: \u5934\u50cf\u6587\u4ef6\uff0c\u5fc5\u987b\u662f jpg \u683c\u5f0f :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def upload_custom_service_account_avatar(self, account, avatar):\n    \"\"\"\n    \u8bbe\u7f6e\u5ba2\u670d\u5e10\u53f7\u7684\u5934\u50cf\u3002\n\n    :param account: \u5ba2\u670d\u8d26\u53f7\u7684\u7528\u6237\u540d\n    :param avatar: \u5934\u50cf\u6587\u4ef6\uff0c\u5fc5\u987b\u662f jpg \u683c\u5f0f\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\n        \"https://api.weixin.qq.com/customservice/kfaccount/uploadheadimg\",\n        params={\n            \"access_token\": self.token,\n            \"kf_account\": account\n        },\n        files={\"media\": avatar}\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.upload_media","title":"<code>upload_media(media_type, media_file)</code>","text":"<p>\u4e0a\u4f20\u4e34\u65f6\u591a\u5a92\u4f53\u6587\u4ef6\u3002</p> <p>:param media_type: \u5a92\u4f53\u6587\u4ef6\u7c7b\u578b\uff0c\u5206\u522b\u6709\u56fe\u7247\uff08image\uff09\u3001\u8bed\u97f3\uff08voice\uff09\u3001\u89c6\u9891\uff08video\uff09\u548c\u7f29\u7565\u56fe\uff08thumb\uff09 :param media_file: \u8981\u4e0a\u4f20\u7684\u6587\u4ef6\uff0c\u4e00\u4e2a File-object: open('xxx', 'rb') :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def upload_media(self, media_type, media_file):\n    \"\"\"\n    \u4e0a\u4f20\u4e34\u65f6\u591a\u5a92\u4f53\u6587\u4ef6\u3002\n\n    :param media_type: \u5a92\u4f53\u6587\u4ef6\u7c7b\u578b\uff0c\u5206\u522b\u6709\u56fe\u7247\uff08image\uff09\u3001\u8bed\u97f3\uff08voice\uff09\u3001\u89c6\u9891\uff08video\uff09\u548c\u7f29\u7565\u56fe\uff08thumb\uff09\n    :param media_file: \u8981\u4e0a\u4f20\u7684\u6587\u4ef6\uff0c\u4e00\u4e2a File-object: open('xxx', 'rb')\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    check_file_type_and_size(file_type=media_type, file_object=media_file)\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/media/upload\",\n        params={\n            \"access_token\": self.token,\n            \"type\": media_type\n        },\n        files={\"media\": media_file}\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.upload_news","title":"<code>upload_news(articles)</code>","text":"<p>\u4e0a\u4f20\u56fe\u6587\u6d88\u606f\u7d20\u6750 ::</p> <pre><code>articles = [{\n    \"thumb_media_id\":\"qI6_Ze_6PtV7svjolgs-rN6stStuHIjs9_DidOHaj0Q-mwvBelOXCFZiq2OsIU-p\",\n    \"author\":\"xxx\",\n    \"title\":\"Happy Day\",\n    \"content_source_url\":\"www.qq.com\",\n    \"content\":\"content\",\n    \"digest\":\"digest\",\n    \"show_cover_pic\":1,\n    \"need_open_comment\":1,\n    \"only_fans_can_comment\":1\n}]\n</code></pre> <p>\u5177\u4f53\u8bf7\u53c2\u8003: https://developers.weixin.qq.com/doc/offiaccount/Message_Management/Batch_Sends_and_Originality_Checks.html#1</p> <p>:param articles: \u4e0a\u4f20\u7684\u56fe\u6587\u6d88\u606f\u6570\u636e\u3002 :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\u3002</p> Source code in <code>zgrobot/client.py</code> <pre><code>def upload_news(self, articles):\n    \"\"\"\n    \u4e0a\u4f20\u56fe\u6587\u6d88\u606f\u7d20\u6750 ::\n\n        articles = [{\n            \"thumb_media_id\":\"qI6_Ze_6PtV7svjolgs-rN6stStuHIjs9_DidOHaj0Q-mwvBelOXCFZiq2OsIU-p\",\n            \"author\":\"xxx\",\n            \"title\":\"Happy Day\",\n            \"content_source_url\":\"www.qq.com\",\n            \"content\":\"content\",\n            \"digest\":\"digest\",\n            \"show_cover_pic\":1,\n            \"need_open_comment\":1,\n            \"only_fans_can_comment\":1\n        }]\n\n    \u5177\u4f53\u8bf7\u53c2\u8003: https://developers.weixin.qq.com/doc/offiaccount/Message_Management/Batch_Sends_and_Originality_Checks.html#1\n\n\n    :param articles: \u4e0a\u4f20\u7684\u56fe\u6587\u6d88\u606f\u6570\u636e\u3002\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\u3002\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/media/uploadnews\",\n        data={\n            \"articles\": articles,\n        }\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.upload_news_picture","title":"<code>upload_news_picture(file)</code>","text":"<p>\u4e0a\u4f20\u56fe\u6587\u6d88\u606f\u5185\u7684\u56fe\u7247\u3002</p> <p>:param file: \u8981\u4e0a\u4f20\u7684\u56fe\u7247\u6587\u4ef6\uff0c\u7c7b\u578b\u4ec5\u652f\u6301 jpg/png \u683c\u5f0f\uff0c\u5927\u5c0f\u9650\u5236\u4e3a &lt;10Mb\uff0c\u5982\uff1aopen('xxx', 'rb') :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def upload_news_picture(self, file):\n    \"\"\"\n    \u4e0a\u4f20\u56fe\u6587\u6d88\u606f\u5185\u7684\u56fe\u7247\u3002\n\n    :param file: \u8981\u4e0a\u4f20\u7684\u56fe\u7247\u6587\u4ef6\uff0c\u7c7b\u578b\u4ec5\u652f\u6301 jpg/png \u683c\u5f0f\uff0c\u5927\u5c0f\u9650\u5236\u4e3a &lt;10Mb\uff0c\u5982\uff1aopen('xxx', 'rb')\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/media/uploadimg\",\n        params={\"access_token\": self.token},\n        files={\"media\": file}\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.upload_permanent_media","title":"<code>upload_permanent_media(media_type, media_file)</code>","text":"<p>\u4e0a\u4f20\u5176\u4ed6\u7c7b\u578b\u6c38\u4e45\u7d20\u6750\u3002</p> <p>:param media_type: \u5a92\u4f53\u6587\u4ef6\u7c7b\u578b\uff0c\u5206\u522b\u6709\u56fe\u7247\uff08image\uff09\u3001\u8bed\u97f3\uff08voice\uff09\u548c\u7f29\u7565\u56fe\uff08thumb\uff09 :param media_file: \u8981\u4e0a\u4f20\u7684\u6587\u4ef6\uff0c\u4e00\u4e2a File-object: open('xxx', 'rb') :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305</p> Source code in <code>zgrobot/client.py</code> <pre><code>def upload_permanent_media(self, media_type, media_file):\n    \"\"\"\n    \u4e0a\u4f20\u5176\u4ed6\u7c7b\u578b\u6c38\u4e45\u7d20\u6750\u3002\n\n    :param media_type: \u5a92\u4f53\u6587\u4ef6\u7c7b\u578b\uff0c\u5206\u522b\u6709\u56fe\u7247\uff08image\uff09\u3001\u8bed\u97f3\uff08voice\uff09\u548c\u7f29\u7565\u56fe\uff08thumb\uff09\n    :param media_file: \u8981\u4e0a\u4f20\u7684\u6587\u4ef6\uff0c\u4e00\u4e2a File-object: open('xxx', 'rb')\n    :return: \u8fd4\u56de\u7684 JSON \u6570\u636e\u5305\n    \"\"\"\n    check_file_type_and_size(file_type=media_type, file_object=media_file)\n    return self.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/material/add_material\",\n        params={\n            \"access_token\": self.token,\n            \"type\": media_type\n        },\n        files={\"media\": media_file}\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.Client.upload_permanent_video","title":"<code>upload_permanent_video(title, introduction, video)</code>","text":"<p>\u4e0a\u4f20\u6c38\u4e45\u89c6\u9891\u3002</p> <p>:param title: \u89c6\u9891\u7d20\u6750\u7684\u6807\u9898 :param introduction: \u89c6\u9891\u7d20\u6750\u7684\u63cf\u8ff0 :param video: \u8981\u4e0a\u4f20\u7684\u89c6\u9891\uff0c\u4e00\u4e2a File-object: open('xxx', 'rb')\uff0c \u5927\u5c0f\u9650\u5236 &lt;10Mb :return: requests \u7684 Response \u5b9e\u4f8b</p> Source code in <code>zgrobot/client.py</code> <pre><code>def upload_permanent_video(self, title, introduction, video):\n    \"\"\"\n    \u4e0a\u4f20\u6c38\u4e45\u89c6\u9891\u3002\n\n    :param title: \u89c6\u9891\u7d20\u6750\u7684\u6807\u9898\n    :param introduction: \u89c6\u9891\u7d20\u6750\u7684\u63cf\u8ff0\n    :param video: \u8981\u4e0a\u4f20\u7684\u89c6\u9891\uff0c\u4e00\u4e2a File-object: open('xxx', 'rb')\uff0c \u5927\u5c0f\u9650\u5236 &lt;10Mb\n    :return: requests \u7684 Response \u5b9e\u4f8b\n    \"\"\"\n    check_file_type_and_size(file_type=\"video\", file_object=video)\n    return requests.post(\n        url=\"https://api.weixin.qq.com/cgi-bin/material/add_material\",\n        params={\n            \"access_token\": self.token,\n            \"type\": \"video\"\n        },\n        data={\n            \"description\": _json.dumps(\n                {\n                    \"title\": title,\n                    \"introduction\": introduction\n                },\n                ensure_ascii=False\n            ).encode(\"utf-8\")\n        },\n        files={\"media\": video}\n    )\n</code></pre>"},{"location":"api/client.html#zgrobot.client.check_error","title":"<code>check_error(json)</code>","text":"<p>\u68c0\u6d4b\u5fae\u4fe1\u516c\u4f17\u5e73\u53f0\u8fd4\u56de\u503c\u4e2d\u662f\u5426\u5305\u542b\u9519\u8bef\u7684\u8fd4\u56de\u7801\u3002 \u5982\u679c\u8fd4\u56de\u7801\u63d0\u793a\u6709\u9519\u8bef\uff0c\u629b\u51fa\u4e00\u4e2a :class:<code>ClientException</code> \u5f02\u5e38\u3002\u5426\u5219\u8fd4\u56de True \u3002</p> Source code in <code>zgrobot/client.py</code> <pre><code>def check_error(json):\n    \"\"\"\n    \u68c0\u6d4b\u5fae\u4fe1\u516c\u4f17\u5e73\u53f0\u8fd4\u56de\u503c\u4e2d\u662f\u5426\u5305\u542b\u9519\u8bef\u7684\u8fd4\u56de\u7801\u3002\n    \u5982\u679c\u8fd4\u56de\u7801\u63d0\u793a\u6709\u9519\u8bef\uff0c\u629b\u51fa\u4e00\u4e2a :class:`ClientException` \u5f02\u5e38\u3002\u5426\u5219\u8fd4\u56de True \u3002\n    \"\"\"\n    if \"errcode\" in json and json[\"errcode\"] != 0:\n        raise ClientException(\"{}: {}\".format(json[\"errcode\"], json[\"errmsg\"]))\n    return json\n</code></pre>"},{"location":"api/config.html","title":"\u914d\u7f6e","text":""},{"location":"api/config.html#zgrobot.config.Config","title":"<code>Config</code>","text":"<p>             Bases: <code>dict</code></p> Source code in <code>zgrobot/config.py</code> <pre><code>class Config(dict):\n\n    def from_pyfile(self, filename):\n        \"\"\"\n        \u5728\u4e00\u4e2a Python \u6587\u4ef6\u4e2d\u8bfb\u53d6\u914d\u7f6e\u3002\n\n        :param filename: \u914d\u7f6e\u6587\u4ef6\u7684\u6587\u4ef6\u540d\n        :return: \u5982\u679c\u8bfb\u53d6\u6210\u529f\uff0c\u8fd4\u56de ``True``\uff0c\u5982\u679c\u5931\u8d25\uff0c\u4f1a\u629b\u51fa\u9519\u8bef\u5f02\u5e38\n        \"\"\"\n        d = types.ModuleType('config')\n        d.__file__ = filename\n        with open(filename) as config_file:\n            exec(compile(config_file.read(), filename, 'exec'), d.__dict__)\n        self.from_object(d)\n        return True\n\n    def from_object(self, obj):\n        \"\"\"\n        \u5728\u7ed9\u5b9a\u7684 Python \u5bf9\u8c61\u4e2d\u8bfb\u53d6\u914d\u7f6e\u3002\n\n        :param obj: \u4e00\u4e2a Python \u5bf9\u8c61\n        \"\"\"\n        for key in dir(obj):\n            if key.isupper():\n                self[key] = getattr(obj, key)\n</code></pre>"},{"location":"api/config.html#zgrobot.config.Config.from_object","title":"<code>from_object(obj)</code>","text":"<p>\u5728\u7ed9\u5b9a\u7684 Python \u5bf9\u8c61\u4e2d\u8bfb\u53d6\u914d\u7f6e\u3002</p> <p>:param obj: \u4e00\u4e2a Python \u5bf9\u8c61</p> Source code in <code>zgrobot/config.py</code> <pre><code>def from_object(self, obj):\n    \"\"\"\n    \u5728\u7ed9\u5b9a\u7684 Python \u5bf9\u8c61\u4e2d\u8bfb\u53d6\u914d\u7f6e\u3002\n\n    :param obj: \u4e00\u4e2a Python \u5bf9\u8c61\n    \"\"\"\n    for key in dir(obj):\n        if key.isupper():\n            self[key] = getattr(obj, key)\n</code></pre>"},{"location":"api/config.html#zgrobot.config.Config.from_pyfile","title":"<code>from_pyfile(filename)</code>","text":"<p>\u5728\u4e00\u4e2a Python \u6587\u4ef6\u4e2d\u8bfb\u53d6\u914d\u7f6e\u3002</p> <p>:param filename: \u914d\u7f6e\u6587\u4ef6\u7684\u6587\u4ef6\u540d :return: \u5982\u679c\u8bfb\u53d6\u6210\u529f\uff0c\u8fd4\u56de <code>True</code>\uff0c\u5982\u679c\u5931\u8d25\uff0c\u4f1a\u629b\u51fa\u9519\u8bef\u5f02\u5e38</p> Source code in <code>zgrobot/config.py</code> <pre><code>def from_pyfile(self, filename):\n    \"\"\"\n    \u5728\u4e00\u4e2a Python \u6587\u4ef6\u4e2d\u8bfb\u53d6\u914d\u7f6e\u3002\n\n    :param filename: \u914d\u7f6e\u6587\u4ef6\u7684\u6587\u4ef6\u540d\n    :return: \u5982\u679c\u8bfb\u53d6\u6210\u529f\uff0c\u8fd4\u56de ``True``\uff0c\u5982\u679c\u5931\u8d25\uff0c\u4f1a\u629b\u51fa\u9519\u8bef\u5f02\u5e38\n    \"\"\"\n    d = types.ModuleType('config')\n    d.__file__ = filename\n    with open(filename) as config_file:\n        exec(compile(config_file.read(), filename, 'exec'), d.__dict__)\n    self.from_object(d)\n    return True\n</code></pre>"},{"location":"api/config.html#zgrobot.config.ConfigAttribute","title":"<code>ConfigAttribute</code>","text":"<p>             Bases: <code>object</code></p> <p>\u8ba9\u4e00\u4e2a\u5c5e\u6027\u6307\u5411\u4e00\u4e2a\u914d\u7f6e</p> Source code in <code>zgrobot/config.py</code> <pre><code>class ConfigAttribute(object):\n    \"\"\"\n    \u8ba9\u4e00\u4e2a\u5c5e\u6027\u6307\u5411\u4e00\u4e2a\u914d\u7f6e\n    \"\"\"\n\n    def __init__(self, name):\n        self.__name__ = name\n\n    def __get__(self, obj, type=None):\n        if obj is None:\n            return self\n        rv = obj.config[self.__name__]\n        return rv\n\n    def __set__(self, obj, value):\n        obj.config[self.__name__] = value\n</code></pre>"},{"location":"api/robot.html","title":"\u5e94\u7528","text":""},{"location":"api/robot.html#zgrobot.robot.BaseRoBot","title":"<code>BaseRoBot</code>","text":"<p>             Bases: <code>object</code></p> <p>BaseRoBot \u662f\u6574\u4e2a\u5e94\u7528\u7684\u6838\u5fc3\u5bf9\u8c61\uff0c\u8d1f\u8d23\u63d0\u4f9b handler \u7684\u7ef4\u62a4\uff0c\u6d88\u606f\u548c\u4e8b\u4ef6\u7684\u5904\u7406\u7b49\u6838\u5fc3\u529f\u80fd\u3002</p> <p>:param logger: \u7528\u6765\u8f93\u51fa log \u7684 logger\uff0c\u5982\u679c\u662f <code>None</code>\uff0c\u5c06\u4f7f\u7528 zgrobot.logger :param config: \u7528\u6765\u8bbe\u7f6e\u7684 :class:<code>zgrobot.config.Config</code> \u5bf9\u8c61 \\</p> <p>.. note:: \u5bf9\u4e8e\u4e0b\u9762\u7684\u53c2\u6570\u63a8\u8350\u4f7f\u7528 :class:<code>~zgrobot.config.Config</code> \u8fdb\u884c\u8bbe\u7f6e\uff0c    \u5e76\u4e14\u4ee5\u4e0b\u53c2\u6570\u5747\u5df2 deprecated\u3002</p> <p>:param token: \u5fae\u4fe1\u516c\u4f17\u53f7\u8bbe\u7f6e\u7684 token (deprecated) :param enable_session: \u662f\u5426\u5f00\u542f session (deprecated) :param session_storage: \u7528\u6765\u50a8\u5b58 session \u7684\u5bf9\u8c61\uff0c\u5982\u679c\u4e3a <code>None</code>\uff0c    \u5c06\u4f7f\u7528 zgrobot.session.sqlitestorage.SQLiteStorage (deprecated) :param app_id: \u5fae\u4fe1\u516c\u4f17\u53f7\u8bbe\u7f6e\u7684 app id (deprecated) :param app_secret: \u5fae\u4fe1\u516c\u4f17\u53f7\u8bbe\u7f6e\u7684 app secret (deprecated) :param encoding_aes_key: \u7528\u6765\u52a0\u89e3\u5bc6\u6d88\u606f\u7684 aes key (deprecated)</p> Source code in <code>zgrobot/robot.py</code> <pre><code>class BaseRoBot(object):\n    \"\"\"\n    BaseRoBot \u662f\u6574\u4e2a\u5e94\u7528\u7684\u6838\u5fc3\u5bf9\u8c61\uff0c\u8d1f\u8d23\u63d0\u4f9b handler \u7684\u7ef4\u62a4\uff0c\u6d88\u606f\u548c\u4e8b\u4ef6\u7684\u5904\u7406\u7b49\u6838\u5fc3\u529f\u80fd\u3002\n\n    :param logger: \u7528\u6765\u8f93\u51fa log \u7684 logger\uff0c\u5982\u679c\u662f ``None``\uff0c\u5c06\u4f7f\u7528 zgrobot.logger\n    :param config: \u7528\u6765\u8bbe\u7f6e\u7684 :class:`zgrobot.config.Config` \u5bf9\u8c61 \\\\\n\n    .. note:: \u5bf9\u4e8e\u4e0b\u9762\u7684\u53c2\u6570\u63a8\u8350\u4f7f\u7528 :class:`~zgrobot.config.Config` \u8fdb\u884c\u8bbe\u7f6e\uff0c\\\n    \u5e76\u4e14\u4ee5\u4e0b\u53c2\u6570\u5747\u5df2 **deprecated**\u3002\n\n    :param token: \u5fae\u4fe1\u516c\u4f17\u53f7\u8bbe\u7f6e\u7684 token **(deprecated)**\n    :param enable_session: \u662f\u5426\u5f00\u542f session **(deprecated)**\n    :param session_storage: \u7528\u6765\u50a8\u5b58 session \u7684\u5bf9\u8c61\uff0c\u5982\u679c\u4e3a ``None``\uff0c\\\n    \u5c06\u4f7f\u7528 zgrobot.session.sqlitestorage.SQLiteStorage **(deprecated)**\n    :param app_id: \u5fae\u4fe1\u516c\u4f17\u53f7\u8bbe\u7f6e\u7684 app id **(deprecated)**\n    :param app_secret: \u5fae\u4fe1\u516c\u4f17\u53f7\u8bbe\u7f6e\u7684 app secret **(deprecated)**\n    :param encoding_aes_key: \u7528\u6765\u52a0\u89e3\u5bc6\u6d88\u606f\u7684 aes key **(deprecated)**\n    \"\"\"\n    message_types = [\n        'subscribe_event',\n        'unsubscribe_event',\n        'click_event',\n        'view_event',\n        'scan_event',\n        'scancode_waitmsg_event',\n        'scancode_push_event',\n        'pic_sysphoto_event',\n        'pic_photo_or_album_event',\n        'pic_weixin_event',\n        'location_select_event',\n        'location_event',\n        'unknown_event',\n        'user_scan_product_event',\n        'user_scan_product_enter_session_event',\n        'user_scan_product_async_event',\n        'user_scan_product_verify_action_event',\n        'card_pass_check_event',\n        'card_not_pass_check_event',\n        'user_get_card_event',\n        'user_gifting_card_event',\n        'user_del_card_event',\n        'user_consume_card_event',\n        'user_pay_from_pay_cell_event',\n        'user_view_card_event',\n        'user_enter_session_from_card_event',\n        'update_member_card_event',\n        'card_sku_remind_event',\n        'card_pay_order_event',\n        'templatesendjobfinish_event',\n        'submit_membercard_user_info_event',  # event\n        'text',\n        'image',\n        'link',\n        'location',\n        'voice',\n        'unknown',\n        'video',\n        'shortvideo'\n    ]\n\n    token = ConfigAttribute(\"TOKEN\")\n    session_storage = ConfigAttribute(\"SESSION_STORAGE\")\n\n    def __init__(\n        self,\n        token=None,\n        logger=None,\n        enable_session=None,\n        session_storage=None,\n        app_id=None,\n        app_secret=None,\n        encoding_aes_key=None,\n        config=None,\n        **kwargs\n    ):\n\n        self._handlers = {k: [] for k in self.message_types}\n        self._handlers['all'] = []\n        self.make_error_page = make_error_page\n\n        if logger is None:\n            import zgrobot.logger\n            logger = zgrobot.logger.logger\n        self.logger = logger\n\n        if config is None:\n            self.config = Config(_DEFAULT_CONFIG)\n            self.config.update(\n                TOKEN=token,\n                APP_ID=app_id,\n                APP_SECRET=app_secret,\n                ENCODING_AES_KEY=encoding_aes_key\n            )\n            for k, v in kwargs.items():\n                self.config[k.upper()] = v\n\n            if enable_session is not None:\n                warnings.warn(\n                    \"enable_session is deprecated.\"\n                    \"set SESSION_STORAGE to False if you want to disable Session\",\n                    DeprecationWarning,\n                    stacklevel=2\n                )\n                if not enable_session:\n                    self.config[\"SESSION_STORAGE\"] = False\n\n            if session_storage:\n                self.config[\"SESSION_STORAGE\"] = session_storage\n        else:\n            self.config = config\n\n        self.use_encryption = False\n\n    @cached_property\n    def crypto(self):\n        app_id = self.config.get(\"APP_ID\", None)\n        if not app_id:\n            raise ConfigError(\n                \"You need to provide app_id to encrypt/decrypt messages\"\n            )\n\n        encoding_aes_key = self.config.get(\"ENCODING_AES_KEY\", None)\n        if not encoding_aes_key:\n            raise ConfigError(\n                \"You need to provide encoding_aes_key \"\n                \"to encrypt/decrypt messages\"\n            )\n        self.use_encryption = True\n\n        from .crypto import MessageCrypt\n        return MessageCrypt(\n            token=self.config[\"TOKEN\"],\n            encoding_aes_key=encoding_aes_key,\n            app_id=app_id\n        )\n\n    @cached_property\n    def client(self):\n        return Client(self.config)\n\n    @cached_property\n    def session_storage(self):\n        if self.config[\"SESSION_STORAGE\"] is False:\n            return None\n        if not self.config[\"SESSION_STORAGE\"]:\n            from .session.sqlitestorage import SQLiteStorage\n            self.config[\"SESSION_STORAGE\"] = SQLiteStorage()\n        return self.config[\"SESSION_STORAGE\"]\n\n    @session_storage.setter\n    def session_storage(self, value):\n        warnings.warn(\n            \"You should set session storage in config\",\n            DeprecationWarning,\n            stacklevel=2\n        )\n        self.config[\"SESSION_STORAGE\"] = value\n\n    def handler(self, f):\n        \"\"\"\n        \u4e3a\u6bcf\u4e00\u6761\u6d88\u606f\u6216\u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='all')\n        return f\n\n    def text(self, f):\n        \"\"\"\n        \u4e3a\u6587\u672c ``(text)`` \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='text')\n        return f\n\n    def image(self, f):\n        \"\"\"\n        \u4e3a\u56fe\u50cf ``(image)`` \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='image')\n        return f\n\n    def location(self, f):\n        \"\"\"\n        \u4e3a\u4f4d\u7f6e ``(location)`` \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='location')\n        return f\n\n    def link(self, f):\n        \"\"\"\n        \u4e3a\u94fe\u63a5 ``(link)`` \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='link')\n        return f\n\n    def voice(self, f):\n        \"\"\"\n        \u4e3a\u8bed\u97f3 ``(voice)`` \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='voice')\n        return f\n\n    def video(self, f):\n        \"\"\"\n        \u4e3a\u89c6\u9891 ``(video)`` \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='video')\n        return f\n\n    def shortvideo(self, f):\n        \"\"\"\n        \u4e3a\u5c0f\u89c6\u9891 ``(shortvideo)`` \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='shortvideo')\n        return f\n\n    def unknown(self, f):\n        \"\"\"\n        \u4e3a\u672a\u77e5\u7c7b\u578b ``(unknown)`` \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='unknown')\n        return f\n\n    def subscribe(self, f):\n        \"\"\"\n        \u4e3a\u88ab\u5173\u6ce8 ``(subscribe)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='subscribe_event')\n        return f\n\n    def unsubscribe(self, f):\n        \"\"\"\n        \u4e3a\u88ab\u53d6\u6d88\u5173\u6ce8 ``(unsubscribe)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='unsubscribe_event')\n        return f\n\n    def click(self, f):\n        \"\"\"\n        \u4e3a\u81ea\u5b9a\u4e49\u83dc\u5355\u4e8b\u4ef6 ``(click)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='click_event')\n        return f\n\n    def scan(self, f):\n        \"\"\"\n        \u4e3a\u626b\u63cf\u63a8\u9001 ``(scan)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='scan_event')\n        return f\n\n    def scancode_push(self, f):\n        \"\"\"\n        \u4e3a\u626b\u63cf\u63a8\u9001 ``(scancode_push)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='scancode_push_event')\n        return f\n\n    def scancode_waitmsg(self, f):\n        \"\"\"\n        \u4e3a\u626b\u63cf\u5f39\u6d88\u606f ``(scancode_waitmsg)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='scancode_waitmsg_event')\n        return f\n\n    def pic_sysphoto(self, f):\n        \"\"\"\n        \u4e3a\u5f39\u51fa\u7cfb\u7edf\u62cd\u7167\u53d1\u56fe\u7684\u4e8b\u4ef6\u63a8\u9001 ``(pic_sysphoto_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='pic_sysphoto_event')\n        return f\n\n    def pic_photo_or_album(self, f):\n        \"\"\"\n        \u4e3a\u5f39\u51fa\u62cd\u7167\u6216\u8005\u76f8\u518c\u53d1\u56fe\u7684\u4e8b\u4ef6\u63a8\u9001 ``(pic_photo_or_album_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='pic_photo_or_album_event')\n        return f\n\n    def pic_weixin(self, f):\n        \"\"\"\n        \u4e3a\u5f39\u51fa\u5fae\u4fe1\u76f8\u518c\u53d1\u56fe\u5668\u7684\u4e8b\u4ef6\u63a8\u9001 ``(pic_weixin_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='pic_weixin_event')\n        return f\n\n    def location_select(self, f):\n        \"\"\"\n        \u4e3a\u5f39\u51fa\u5730\u7406\u4f4d\u7f6e\u9009\u62e9\u5668\u7684\u4e8b\u4ef6\u63a8\u9001 ``(location_select_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='location_select_event')\n        return f\n\n    def location_event(self, f):\n        \"\"\"\n        \u4e3a\u4e0a\u62a5\u4f4d\u7f6e ``(location_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='location_event')\n        return f\n\n    def view(self, f):\n        \"\"\"\n        \u4e3a\u94fe\u63a5 ``(view)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='view_event')\n        return f\n\n    def user_scan_product(self, f):\n        \"\"\"\n        \u4e3a\u6253\u5f00\u5546\u54c1\u4e3b\u9875\u4e8b\u4ef6\u63a8\u9001 ``(user_scan_product_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='user_scan_product_event')\n        return f\n\n    def user_scan_product_enter_session(self, f):\n        \"\"\"\n        \u4e3a\u8fdb\u5165\u516c\u4f17\u53f7\u4e8b\u4ef6\u63a8\u9001 ``(user_scan_product_enter_session_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='user_scan_product_enter_session_event')\n        return f\n\n    def user_scan_product_async(self, f):\n        \"\"\"\n        \u4e3a\u5730\u7406\u4f4d\u7f6e\u4fe1\u606f\u5f02\u6b65\u63a8\u9001 ``(user_scan_product_async_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='user_scan_product_async_event')\n        return f\n\n    def user_scan_product_verify_action(self, f):\n        \"\"\"\n        \u4e3a\u5546\u54c1\u5ba1\u6838\u7ed3\u679c\u63a8\u9001 ``(user_scan_product_verify_action_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='user_scan_product_verify_action_event')\n        return f\n\n    def card_pass_check(self, f):\n        \"\"\"\n        \u4e3a\u751f\u6210\u7684\u5361\u5238\u901a\u8fc7\u5ba1\u6838 ``(card_pass_check_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='card_pass_check_event')\n        return f\n\n    def card_not_pass_check(self, f):\n        \"\"\"\n        \u4e3a\u751f\u6210\u7684\u5361\u5238\u672a\u901a\u8fc7\u5ba1\u6838 ``(card_not_pass_check_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='card_not_pass_check_event')\n        return f\n\n    def user_get_card(self, f):\n        \"\"\"\n        \u4e3a\u7528\u6237\u9886\u53d6\u5361\u5238 ``(user_get_card_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='user_get_card_event')\n        return f\n\n    def user_gifting_card(self, f):\n        \"\"\"\n        \u4e3a\u7528\u6237\u8f6c\u8d60\u5361\u5238 ``(user_gifting_card_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='user_gifting_card_event')\n        return f\n\n    def user_del_card(self, f):\n        \"\"\"\n        \u4e3a\u7528\u6237\u5220\u9664\u5361\u5238 ``(user_del_card_event)``  \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='user_del_card_event')\n        return f\n\n    def user_consume_card(self, f):\n        \"\"\"\n        \u4e3a\u5361\u5238\u88ab\u6838\u9500 ``(user_consume_card_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='user_consume_card_event')\n        return f\n\n    def user_pay_from_pay_cell(self, f):\n        \"\"\"\n        \u4e3a\u5fae\u4fe1\u4e70\u5355\u5b8c\u6210 ``(user_pay_from_pay_cell_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='user_pay_from_pay_cell_event')\n        return f\n\n    def user_view_card(self, f):\n        \"\"\"\n        \u4e3a\u7528\u6237\u8fdb\u5165\u4f1a\u5458\u5361 ``(user_view_card_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='user_view_card_event')\n        return f\n\n    def user_enter_session_from_card(self, f):\n        \"\"\"\n        \u4e3a\u7528\u6237\u5361\u5238\u91cc\u70b9\u51fb\u67e5\u770b\u516c\u4f17\u53f7\u8fdb\u5165\u4f1a\u8bdd ``(user_enter_session_from_card_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='user_enter_session_from_card_event')\n        return f\n\n    def update_member_card(self, f):\n        \"\"\"\n        \u4e3a\u7528\u6237\u7684\u4f1a\u5458\u5361\u79ef\u5206\u4f59\u989d\u53d1\u751f\u53d8\u52a8 ``(update_member_card_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='update_member_card_event')\n        return f\n\n    def card_sku_remind(self, f):\n        \"\"\"\n        \u4e3a\u67d0\u4e2acard_id\u7684\u521d\u59cb\u5e93\u5b58\u6570\u5927\u4e8e200\u4e14\u5f53\u524d\u5e93\u5b58\u5c0f\u4e8e\u7b49\u4e8e100 ``(card_sku_remind_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='card_sku_remind_event')\n        return f\n\n    def card_pay_order(self, f):\n        \"\"\"\n        \u4e3a\u5238\u70b9\u53d1\u751f\u53d8\u52a8 ``(card_pay_order_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='card_pay_order_event')\n        return f\n\n    def submit_membercard_user_info(self, f):\n        \"\"\"\n        \u4e3a\u7528\u6237\u901a\u8fc7\u4e00\u952e\u6fc0\u6d3b\u7684\u65b9\u5f0f\u63d0\u4ea4\u4fe1\u606f\u5e76\u70b9\u51fb\u6fc0\u6d3b\u6216\u8005\u7528\u6237\u4fee\u6539\u4f1a\u5458\u5361\u4fe1\u606f ``(submit_membercard_user_info_event)``\n        \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='submit_membercard_user_info_event')\n        return f\n\n    def templatesendjobfinish_event(self, f):\n        \"\"\"\u5728\u6a21\u7248\u6d88\u606f\u53d1\u9001\u4efb\u52a1\u5b8c\u6210\u540e\uff0c\u5fae\u4fe1\u670d\u52a1\u5668\u4f1a\u5c06\u662f\u5426\u9001\u8fbe\u6210\u529f\u4f5c\u4e3a\u901a\u77e5\uff0c\u53d1\u9001\u5230\u5f00\u53d1\u8005\u4e2d\u5fc3\u4e2d\u586b\u5199\u7684\u670d\u52a1\u5668\u914d\u7f6e\u5730\u5740\u4e2d\n        \"\"\"\n        self.add_handler(f, type='templatesendjobfinish_event')\n        return f\n\n    def unknown_event(self, f):\n        \"\"\"\n        \u4e3a\u672a\u77e5\u7c7b\u578b ``(unknown_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n        \"\"\"\n        self.add_handler(f, type='unknown_event')\n        return f\n\n    def key_click(self, key):\n        \"\"\"\n        \u4e3a\u81ea\u5b9a\u4e49\u83dc\u5355 ``(click)`` \u4e8b\u4ef6\u6dfb\u52a0 handler \u7684\u7b80\u4fbf\u65b9\u6cd5\u3002\n\n        **@key_click('KEYNAME')** \u7528\u6765\u4e3a\u7279\u5b9a key \u7684\u70b9\u51fb\u4e8b\u4ef6\u6dfb\u52a0 handler \u65b9\u6cd5\u3002\n        \"\"\"\n\n        def wraps(f):\n            argc = len(signature(f).parameters.keys())\n\n            @self.click\n            def onclick(message, session=None):\n                if message.key == key:\n                    return f(*[message, session][:argc])\n\n            return f\n\n        return wraps\n\n    def filter(self, *args):\n        \"\"\"\n        \u4e3a\u6587\u672c ``(text)`` \u6d88\u606f\u6dfb\u52a0 handler \u7684\u7b80\u4fbf\u65b9\u6cd5\u3002\n\n        \u4f7f\u7528 ``@filter(\"xxx\")``, ``@filter(re.compile(\"xxx\"))``\n        \u6216 ``@filter(\"xxx\", \"xxx2\")`` \u7684\u5f62\u5f0f\u4e3a\u7279\u5b9a\u5185\u5bb9\u6dfb\u52a0 handler\u3002\n        \"\"\"\n\n        def wraps(f):\n            self.add_filter(func=f, rules=list(args))\n            return f\n\n        return wraps\n\n    def add_handler(self, func, type='all'):\n        \"\"\"\n        \u4e3a BaseRoBot \u5b9e\u4f8b\u6dfb\u52a0\u4e00\u4e2a handler\u3002\n\n        :param func: \u8981\u4f5c\u4e3a handler \u7684\u65b9\u6cd5\u3002\n        :param type: handler \u7684\u79cd\u7c7b\u3002\n        :return: None\n        \"\"\"\n        if not callable(func):\n            raise ValueError(\"{} is not callable\".format(func))\n\n        self._handlers[type].append(\n            (func, len(signature(func).parameters.keys()))\n        )\n\n    def get_handlers(self, type):\n        return self._handlers.get(type, []) + self._handlers['all']\n\n    def add_filter(self, func, rules):\n        \"\"\"\n        \u4e3a BaseRoBot \u6dfb\u52a0\u4e00\u4e2a ``filter handler``\u3002\n\n        :param func: \u5982\u679c rules \u901a\u8fc7\uff0c\u5219\u5904\u7406\u8be5\u6d88\u606f\u7684 handler\u3002\n        :param rules: \u4e00\u4e2a list\uff0c\u5305\u542b\u8981\u5339\u914d\u7684\u5b57\u7b26\u4e32\u6216\u8005\u6b63\u5219\u8868\u8fbe\u5f0f\u3002\n        :return: None\n        \"\"\"\n        if not callable(func):\n            raise ValueError(\"{} is not callable\".format(func))\n        if not isinstance(rules, list):\n            raise ValueError(\"{} is not list\".format(rules))\n        if len(rules) &gt; 1:\n            for x in rules:\n                self.add_filter(func, [x])\n        else:\n            target_content = rules[0]\n            if isinstance(target_content, str):\n                target_content = to_text(target_content)\n\n                def _check_content(message):\n                    return message.content == target_content\n            elif is_regex(target_content):\n\n                def _check_content(message):\n                    return target_content.match(message.content)\n            else:\n                raise TypeError(\"%s is not a valid rule\" % target_content)\n            argc = len(signature(func).parameters.keys())\n\n            @self.text\n            def _f(message, session=None):\n                _check_result = _check_content(message)\n                if _check_result:\n                    if isinstance(_check_result, bool):\n                        _check_result = None\n                    return func(*[message, session, _check_result][:argc])\n\n    def parse_message(\n        self, body, timestamp=None, nonce=None, msg_signature=None\n    ):\n        \"\"\"\n        \u89e3\u6790\u83b7\u53d6\u5230\u7684 Raw XML \uff0c\u5982\u679c\u9700\u8981\u7684\u8bdd\u8fdb\u884c\u89e3\u5bc6\uff0c\u8fd4\u56de ZgRoBot Message\u3002\n        :param body: \u5fae\u4fe1\u670d\u52a1\u5668\u53d1\u6765\u7684\u8bf7\u6c42\u4e2d\u7684 Body\u3002\n        :return: ZgRoBot Message\n        \"\"\"\n        message_dict = parse_xml(body)\n        if \"Encrypt\" in message_dict:\n            xml = self.crypto.decrypt_message(\n                timestamp=timestamp,\n                nonce=nonce,\n                msg_signature=msg_signature,\n                encrypt_msg=message_dict[\"Encrypt\"]\n            )\n            message_dict = parse_xml(xml)\n        return process_message(message_dict)\n\n    def get_reply(self, message):\n        \"\"\"\n        \u6839\u636e message \u7684\u5185\u5bb9\u83b7\u53d6 Reply \u5bf9\u8c61\u3002\n\n        :param message: \u8981\u5904\u7406\u7684 message\n        :return: \u83b7\u53d6\u7684 Reply \u5bf9\u8c61\n        \"\"\"\n        session_storage = self.session_storage\n\n        id = None\n        session = None\n        if session_storage and hasattr(message, \"source\"):\n            id = to_binary(message.source)\n            session = session_storage[id]\n\n        handlers = self.get_handlers(message.type)\n        try:\n            for handler, args_count in handlers:\n                args = [message, session][:args_count]\n                reply = handler(*args)\n                if session_storage and id:\n                    session_storage[id] = session\n                if reply:\n                    return process_function_reply(reply, message=message)\n        except Exception as e:\n            self.logger.exception(f\"Catch an exception: {e}\")\n            return \"success\"\n\n    @timeout(4.5)\n    def get_encrypted_reply(self, message):\n        \"\"\"\n        \u5bf9\u4e00\u4e2a\u6307\u5b9a\u7684 ZgRoBot Message \uff0c\u83b7\u53d6 handlers \u5904\u7406\u540e\u5f97\u5230\u7684 Reply\u3002\n        \u5982\u679c\u53ef\u80fd\uff0c\u5bf9\u8be5 Reply \u8fdb\u884c\u52a0\u5bc6\u3002\n        \u8fd4\u56de Reply Render \u540e\u7684\u6587\u672c\u3002\n\n        :param message: \u4e00\u4e2a ZgRoBot Message \u5b9e\u4f8b\u3002\n        :return: reply \uff08\u7eaf\u6587\u672c\uff09\n        \"\"\"\n        reply = self.get_reply(message)\n        if not reply:\n            self.logger.warning(\"No handler responded message %s\" % message)\n            return ''\n        if self.use_encryption:\n            return self.crypto.encrypt_message(reply)\n        else:\n            if type(reply) == str:\n                return reply\n            else:\n                return reply.render()\n\n    def check_signature(self, timestamp, nonce, signature):\n        \"\"\"\n        \u6839\u636e\u65f6\u95f4\u6233\u548c\u751f\u6210\u7b7e\u540d\u7684\u5b57\u7b26\u4e32 (nonce) \u68c0\u67e5\u7b7e\u540d\u3002\n\n        :param timestamp: \u65f6\u95f4\u6233\n        :param nonce: \u751f\u6210\u7b7e\u540d\u7684\u968f\u673a\u5b57\u7b26\u4e32\n        :param signature: \u8981\u68c0\u67e5\u7684\u7b7e\u540d\n        :return: \u5982\u679c\u7b7e\u540d\u5408\u6cd5\u5c06\u8fd4\u56de ``True``\uff0c\u4e0d\u5408\u6cd5\u5c06\u8fd4\u56de ``False``\n        \"\"\"\n        return check_signature(\n            self.config[\"TOKEN\"], timestamp, nonce, signature\n        )\n\n    def error_page(self, f):\n        \"\"\"\n        \u4e3a robot \u6307\u5b9a Signature \u9a8c\u8bc1\u4e0d\u901a\u8fc7\u65f6\u663e\u793a\u7684\u9519\u8bef\u9875\u9762\u3002\n\n        Usage::\n\n            @robot.error_page\n            def make_error_page(url):\n                return \"&lt;h1&gt;\u55b5\u55b5\u55b5 %s \u4e0d\u662f\u7ed9\u9ebb\u74dc\u8bbf\u95ee\u7684\u5feb\u8d70\u5f00&lt;/h1&gt;\" % url\n\n        \"\"\"\n        self.make_error_page = f\n        return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.__init__","title":"<code>__init__(token=None, logger=None, enable_session=None, session_storage=None, app_id=None, app_secret=None, encoding_aes_key=None, config=None, **kwargs)</code>","text":"Source code in <code>zgrobot/robot.py</code> <pre><code>def __init__(\n    self,\n    token=None,\n    logger=None,\n    enable_session=None,\n    session_storage=None,\n    app_id=None,\n    app_secret=None,\n    encoding_aes_key=None,\n    config=None,\n    **kwargs\n):\n\n    self._handlers = {k: [] for k in self.message_types}\n    self._handlers['all'] = []\n    self.make_error_page = make_error_page\n\n    if logger is None:\n        import zgrobot.logger\n        logger = zgrobot.logger.logger\n    self.logger = logger\n\n    if config is None:\n        self.config = Config(_DEFAULT_CONFIG)\n        self.config.update(\n            TOKEN=token,\n            APP_ID=app_id,\n            APP_SECRET=app_secret,\n            ENCODING_AES_KEY=encoding_aes_key\n        )\n        for k, v in kwargs.items():\n            self.config[k.upper()] = v\n\n        if enable_session is not None:\n            warnings.warn(\n                \"enable_session is deprecated.\"\n                \"set SESSION_STORAGE to False if you want to disable Session\",\n                DeprecationWarning,\n                stacklevel=2\n            )\n            if not enable_session:\n                self.config[\"SESSION_STORAGE\"] = False\n\n        if session_storage:\n            self.config[\"SESSION_STORAGE\"] = session_storage\n    else:\n        self.config = config\n\n    self.use_encryption = False\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.add_filter","title":"<code>add_filter(func, rules)</code>","text":"<p>\u4e3a BaseRoBot \u6dfb\u52a0\u4e00\u4e2a <code>filter handler</code>\u3002</p> <p>:param func: \u5982\u679c rules \u901a\u8fc7\uff0c\u5219\u5904\u7406\u8be5\u6d88\u606f\u7684 handler\u3002 :param rules: \u4e00\u4e2a list\uff0c\u5305\u542b\u8981\u5339\u914d\u7684\u5b57\u7b26\u4e32\u6216\u8005\u6b63\u5219\u8868\u8fbe\u5f0f\u3002 :return: None</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def add_filter(self, func, rules):\n    \"\"\"\n    \u4e3a BaseRoBot \u6dfb\u52a0\u4e00\u4e2a ``filter handler``\u3002\n\n    :param func: \u5982\u679c rules \u901a\u8fc7\uff0c\u5219\u5904\u7406\u8be5\u6d88\u606f\u7684 handler\u3002\n    :param rules: \u4e00\u4e2a list\uff0c\u5305\u542b\u8981\u5339\u914d\u7684\u5b57\u7b26\u4e32\u6216\u8005\u6b63\u5219\u8868\u8fbe\u5f0f\u3002\n    :return: None\n    \"\"\"\n    if not callable(func):\n        raise ValueError(\"{} is not callable\".format(func))\n    if not isinstance(rules, list):\n        raise ValueError(\"{} is not list\".format(rules))\n    if len(rules) &gt; 1:\n        for x in rules:\n            self.add_filter(func, [x])\n    else:\n        target_content = rules[0]\n        if isinstance(target_content, str):\n            target_content = to_text(target_content)\n\n            def _check_content(message):\n                return message.content == target_content\n        elif is_regex(target_content):\n\n            def _check_content(message):\n                return target_content.match(message.content)\n        else:\n            raise TypeError(\"%s is not a valid rule\" % target_content)\n        argc = len(signature(func).parameters.keys())\n\n        @self.text\n        def _f(message, session=None):\n            _check_result = _check_content(message)\n            if _check_result:\n                if isinstance(_check_result, bool):\n                    _check_result = None\n                return func(*[message, session, _check_result][:argc])\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.add_handler","title":"<code>add_handler(func, type='all')</code>","text":"<p>\u4e3a BaseRoBot \u5b9e\u4f8b\u6dfb\u52a0\u4e00\u4e2a handler\u3002</p> <p>:param func: \u8981\u4f5c\u4e3a handler \u7684\u65b9\u6cd5\u3002 :param type: handler \u7684\u79cd\u7c7b\u3002 :return: None</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def add_handler(self, func, type='all'):\n    \"\"\"\n    \u4e3a BaseRoBot \u5b9e\u4f8b\u6dfb\u52a0\u4e00\u4e2a handler\u3002\n\n    :param func: \u8981\u4f5c\u4e3a handler \u7684\u65b9\u6cd5\u3002\n    :param type: handler \u7684\u79cd\u7c7b\u3002\n    :return: None\n    \"\"\"\n    if not callable(func):\n        raise ValueError(\"{} is not callable\".format(func))\n\n    self._handlers[type].append(\n        (func, len(signature(func).parameters.keys()))\n    )\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.card_not_pass_check","title":"<code>card_not_pass_check(f)</code>","text":"<p>\u4e3a\u751f\u6210\u7684\u5361\u5238\u672a\u901a\u8fc7\u5ba1\u6838 <code>(card_not_pass_check_event)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def card_not_pass_check(self, f):\n    \"\"\"\n    \u4e3a\u751f\u6210\u7684\u5361\u5238\u672a\u901a\u8fc7\u5ba1\u6838 ``(card_not_pass_check_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='card_not_pass_check_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.card_pass_check","title":"<code>card_pass_check(f)</code>","text":"<p>\u4e3a\u751f\u6210\u7684\u5361\u5238\u901a\u8fc7\u5ba1\u6838 <code>(card_pass_check_event)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def card_pass_check(self, f):\n    \"\"\"\n    \u4e3a\u751f\u6210\u7684\u5361\u5238\u901a\u8fc7\u5ba1\u6838 ``(card_pass_check_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='card_pass_check_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.card_pay_order","title":"<code>card_pay_order(f)</code>","text":"<p>\u4e3a\u5238\u70b9\u53d1\u751f\u53d8\u52a8 <code>(card_pay_order_event)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def card_pay_order(self, f):\n    \"\"\"\n    \u4e3a\u5238\u70b9\u53d1\u751f\u53d8\u52a8 ``(card_pay_order_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='card_pay_order_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.card_sku_remind","title":"<code>card_sku_remind(f)</code>","text":"<p>\u4e3a\u67d0\u4e2acard_id\u7684\u521d\u59cb\u5e93\u5b58\u6570\u5927\u4e8e200\u4e14\u5f53\u524d\u5e93\u5b58\u5c0f\u4e8e\u7b49\u4e8e100 <code>(card_sku_remind_event)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def card_sku_remind(self, f):\n    \"\"\"\n    \u4e3a\u67d0\u4e2acard_id\u7684\u521d\u59cb\u5e93\u5b58\u6570\u5927\u4e8e200\u4e14\u5f53\u524d\u5e93\u5b58\u5c0f\u4e8e\u7b49\u4e8e100 ``(card_sku_remind_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='card_sku_remind_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.check_signature","title":"<code>check_signature(timestamp, nonce, signature)</code>","text":"<p>\u6839\u636e\u65f6\u95f4\u6233\u548c\u751f\u6210\u7b7e\u540d\u7684\u5b57\u7b26\u4e32 (nonce) \u68c0\u67e5\u7b7e\u540d\u3002</p> <p>:param timestamp: \u65f6\u95f4\u6233 :param nonce: \u751f\u6210\u7b7e\u540d\u7684\u968f\u673a\u5b57\u7b26\u4e32 :param signature: \u8981\u68c0\u67e5\u7684\u7b7e\u540d :return: \u5982\u679c\u7b7e\u540d\u5408\u6cd5\u5c06\u8fd4\u56de <code>True</code>\uff0c\u4e0d\u5408\u6cd5\u5c06\u8fd4\u56de <code>False</code></p> Source code in <code>zgrobot/robot.py</code> <pre><code>def check_signature(self, timestamp, nonce, signature):\n    \"\"\"\n    \u6839\u636e\u65f6\u95f4\u6233\u548c\u751f\u6210\u7b7e\u540d\u7684\u5b57\u7b26\u4e32 (nonce) \u68c0\u67e5\u7b7e\u540d\u3002\n\n    :param timestamp: \u65f6\u95f4\u6233\n    :param nonce: \u751f\u6210\u7b7e\u540d\u7684\u968f\u673a\u5b57\u7b26\u4e32\n    :param signature: \u8981\u68c0\u67e5\u7684\u7b7e\u540d\n    :return: \u5982\u679c\u7b7e\u540d\u5408\u6cd5\u5c06\u8fd4\u56de ``True``\uff0c\u4e0d\u5408\u6cd5\u5c06\u8fd4\u56de ``False``\n    \"\"\"\n    return check_signature(\n        self.config[\"TOKEN\"], timestamp, nonce, signature\n    )\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.click","title":"<code>click(f)</code>","text":"<p>\u4e3a\u81ea\u5b9a\u4e49\u83dc\u5355\u4e8b\u4ef6 <code>(click)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def click(self, f):\n    \"\"\"\n    \u4e3a\u81ea\u5b9a\u4e49\u83dc\u5355\u4e8b\u4ef6 ``(click)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='click_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.error_page","title":"<code>error_page(f)</code>","text":"<p>\u4e3a robot \u6307\u5b9a Signature \u9a8c\u8bc1\u4e0d\u901a\u8fc7\u65f6\u663e\u793a\u7684\u9519\u8bef\u9875\u9762\u3002</p> <p>Usage::</p> <pre><code>@robot.error_page\ndef make_error_page(url):\n    return \"&lt;h1&gt;\u55b5\u55b5\u55b5 %s \u4e0d\u662f\u7ed9\u9ebb\u74dc\u8bbf\u95ee\u7684\u5feb\u8d70\u5f00&lt;/h1&gt;\" % url\n</code></pre> Source code in <code>zgrobot/robot.py</code> <pre><code>def error_page(self, f):\n    \"\"\"\n    \u4e3a robot \u6307\u5b9a Signature \u9a8c\u8bc1\u4e0d\u901a\u8fc7\u65f6\u663e\u793a\u7684\u9519\u8bef\u9875\u9762\u3002\n\n    Usage::\n\n        @robot.error_page\n        def make_error_page(url):\n            return \"&lt;h1&gt;\u55b5\u55b5\u55b5 %s \u4e0d\u662f\u7ed9\u9ebb\u74dc\u8bbf\u95ee\u7684\u5feb\u8d70\u5f00&lt;/h1&gt;\" % url\n\n    \"\"\"\n    self.make_error_page = f\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.filter","title":"<code>filter(*args)</code>","text":"<p>\u4e3a\u6587\u672c <code>(text)</code> \u6d88\u606f\u6dfb\u52a0 handler \u7684\u7b80\u4fbf\u65b9\u6cd5\u3002</p> <p>\u4f7f\u7528 <code>@filter(\"xxx\")</code>, <code>@filter(re.compile(\"xxx\"))</code> \u6216 <code>@filter(\"xxx\", \"xxx2\")</code> \u7684\u5f62\u5f0f\u4e3a\u7279\u5b9a\u5185\u5bb9\u6dfb\u52a0 handler\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def filter(self, *args):\n    \"\"\"\n    \u4e3a\u6587\u672c ``(text)`` \u6d88\u606f\u6dfb\u52a0 handler \u7684\u7b80\u4fbf\u65b9\u6cd5\u3002\n\n    \u4f7f\u7528 ``@filter(\"xxx\")``, ``@filter(re.compile(\"xxx\"))``\n    \u6216 ``@filter(\"xxx\", \"xxx2\")`` \u7684\u5f62\u5f0f\u4e3a\u7279\u5b9a\u5185\u5bb9\u6dfb\u52a0 handler\u3002\n    \"\"\"\n\n    def wraps(f):\n        self.add_filter(func=f, rules=list(args))\n        return f\n\n    return wraps\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.get_encrypted_reply","title":"<code>get_encrypted_reply(message)</code>","text":"<p>\u5bf9\u4e00\u4e2a\u6307\u5b9a\u7684 ZgRoBot Message \uff0c\u83b7\u53d6 handlers \u5904\u7406\u540e\u5f97\u5230\u7684 Reply\u3002 \u5982\u679c\u53ef\u80fd\uff0c\u5bf9\u8be5 Reply \u8fdb\u884c\u52a0\u5bc6\u3002 \u8fd4\u56de Reply Render \u540e\u7684\u6587\u672c\u3002</p> <p>:param message: \u4e00\u4e2a ZgRoBot Message \u5b9e\u4f8b\u3002 :return: reply \uff08\u7eaf\u6587\u672c\uff09</p> Source code in <code>zgrobot/robot.py</code> <pre><code>@timeout(4.5)\ndef get_encrypted_reply(self, message):\n    \"\"\"\n    \u5bf9\u4e00\u4e2a\u6307\u5b9a\u7684 ZgRoBot Message \uff0c\u83b7\u53d6 handlers \u5904\u7406\u540e\u5f97\u5230\u7684 Reply\u3002\n    \u5982\u679c\u53ef\u80fd\uff0c\u5bf9\u8be5 Reply \u8fdb\u884c\u52a0\u5bc6\u3002\n    \u8fd4\u56de Reply Render \u540e\u7684\u6587\u672c\u3002\n\n    :param message: \u4e00\u4e2a ZgRoBot Message \u5b9e\u4f8b\u3002\n    :return: reply \uff08\u7eaf\u6587\u672c\uff09\n    \"\"\"\n    reply = self.get_reply(message)\n    if not reply:\n        self.logger.warning(\"No handler responded message %s\" % message)\n        return ''\n    if self.use_encryption:\n        return self.crypto.encrypt_message(reply)\n    else:\n        if type(reply) == str:\n            return reply\n        else:\n            return reply.render()\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.get_reply","title":"<code>get_reply(message)</code>","text":"<p>\u6839\u636e message \u7684\u5185\u5bb9\u83b7\u53d6 Reply \u5bf9\u8c61\u3002</p> <p>:param message: \u8981\u5904\u7406\u7684 message :return: \u83b7\u53d6\u7684 Reply \u5bf9\u8c61</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def get_reply(self, message):\n    \"\"\"\n    \u6839\u636e message \u7684\u5185\u5bb9\u83b7\u53d6 Reply \u5bf9\u8c61\u3002\n\n    :param message: \u8981\u5904\u7406\u7684 message\n    :return: \u83b7\u53d6\u7684 Reply \u5bf9\u8c61\n    \"\"\"\n    session_storage = self.session_storage\n\n    id = None\n    session = None\n    if session_storage and hasattr(message, \"source\"):\n        id = to_binary(message.source)\n        session = session_storage[id]\n\n    handlers = self.get_handlers(message.type)\n    try:\n        for handler, args_count in handlers:\n            args = [message, session][:args_count]\n            reply = handler(*args)\n            if session_storage and id:\n                session_storage[id] = session\n            if reply:\n                return process_function_reply(reply, message=message)\n    except Exception as e:\n        self.logger.exception(f\"Catch an exception: {e}\")\n        return \"success\"\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.handler","title":"<code>handler(f)</code>","text":"<p>\u4e3a\u6bcf\u4e00\u6761\u6d88\u606f\u6216\u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def handler(self, f):\n    \"\"\"\n    \u4e3a\u6bcf\u4e00\u6761\u6d88\u606f\u6216\u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='all')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.image","title":"<code>image(f)</code>","text":"<p>\u4e3a\u56fe\u50cf <code>(image)</code> \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def image(self, f):\n    \"\"\"\n    \u4e3a\u56fe\u50cf ``(image)`` \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='image')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.key_click","title":"<code>key_click(key)</code>","text":"<p>\u4e3a\u81ea\u5b9a\u4e49\u83dc\u5355 <code>(click)</code> \u4e8b\u4ef6\u6dfb\u52a0 handler \u7684\u7b80\u4fbf\u65b9\u6cd5\u3002</p> <p>@key_click('KEYNAME') \u7528\u6765\u4e3a\u7279\u5b9a key \u7684\u70b9\u51fb\u4e8b\u4ef6\u6dfb\u52a0 handler \u65b9\u6cd5\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def key_click(self, key):\n    \"\"\"\n    \u4e3a\u81ea\u5b9a\u4e49\u83dc\u5355 ``(click)`` \u4e8b\u4ef6\u6dfb\u52a0 handler \u7684\u7b80\u4fbf\u65b9\u6cd5\u3002\n\n    **@key_click('KEYNAME')** \u7528\u6765\u4e3a\u7279\u5b9a key \u7684\u70b9\u51fb\u4e8b\u4ef6\u6dfb\u52a0 handler \u65b9\u6cd5\u3002\n    \"\"\"\n\n    def wraps(f):\n        argc = len(signature(f).parameters.keys())\n\n        @self.click\n        def onclick(message, session=None):\n            if message.key == key:\n                return f(*[message, session][:argc])\n\n        return f\n\n    return wraps\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.link","title":"<code>link(f)</code>","text":"<p>\u4e3a\u94fe\u63a5 <code>(link)</code> \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def link(self, f):\n    \"\"\"\n    \u4e3a\u94fe\u63a5 ``(link)`` \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='link')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.location","title":"<code>location(f)</code>","text":"<p>\u4e3a\u4f4d\u7f6e <code>(location)</code> \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def location(self, f):\n    \"\"\"\n    \u4e3a\u4f4d\u7f6e ``(location)`` \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='location')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.location_event","title":"<code>location_event(f)</code>","text":"<p>\u4e3a\u4e0a\u62a5\u4f4d\u7f6e <code>(location_event)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def location_event(self, f):\n    \"\"\"\n    \u4e3a\u4e0a\u62a5\u4f4d\u7f6e ``(location_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='location_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.location_select","title":"<code>location_select(f)</code>","text":"<p>\u4e3a\u5f39\u51fa\u5730\u7406\u4f4d\u7f6e\u9009\u62e9\u5668\u7684\u4e8b\u4ef6\u63a8\u9001 <code>(location_select_event)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def location_select(self, f):\n    \"\"\"\n    \u4e3a\u5f39\u51fa\u5730\u7406\u4f4d\u7f6e\u9009\u62e9\u5668\u7684\u4e8b\u4ef6\u63a8\u9001 ``(location_select_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='location_select_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.parse_message","title":"<code>parse_message(body, timestamp=None, nonce=None, msg_signature=None)</code>","text":"<p>\u89e3\u6790\u83b7\u53d6\u5230\u7684 Raw XML \uff0c\u5982\u679c\u9700\u8981\u7684\u8bdd\u8fdb\u884c\u89e3\u5bc6\uff0c\u8fd4\u56de ZgRoBot Message\u3002 :param body: \u5fae\u4fe1\u670d\u52a1\u5668\u53d1\u6765\u7684\u8bf7\u6c42\u4e2d\u7684 Body\u3002 :return: ZgRoBot Message</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def parse_message(\n    self, body, timestamp=None, nonce=None, msg_signature=None\n):\n    \"\"\"\n    \u89e3\u6790\u83b7\u53d6\u5230\u7684 Raw XML \uff0c\u5982\u679c\u9700\u8981\u7684\u8bdd\u8fdb\u884c\u89e3\u5bc6\uff0c\u8fd4\u56de ZgRoBot Message\u3002\n    :param body: \u5fae\u4fe1\u670d\u52a1\u5668\u53d1\u6765\u7684\u8bf7\u6c42\u4e2d\u7684 Body\u3002\n    :return: ZgRoBot Message\n    \"\"\"\n    message_dict = parse_xml(body)\n    if \"Encrypt\" in message_dict:\n        xml = self.crypto.decrypt_message(\n            timestamp=timestamp,\n            nonce=nonce,\n            msg_signature=msg_signature,\n            encrypt_msg=message_dict[\"Encrypt\"]\n        )\n        message_dict = parse_xml(xml)\n    return process_message(message_dict)\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.pic_photo_or_album","title":"<code>pic_photo_or_album(f)</code>","text":"<p>\u4e3a\u5f39\u51fa\u62cd\u7167\u6216\u8005\u76f8\u518c\u53d1\u56fe\u7684\u4e8b\u4ef6\u63a8\u9001 <code>(pic_photo_or_album_event)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def pic_photo_or_album(self, f):\n    \"\"\"\n    \u4e3a\u5f39\u51fa\u62cd\u7167\u6216\u8005\u76f8\u518c\u53d1\u56fe\u7684\u4e8b\u4ef6\u63a8\u9001 ``(pic_photo_or_album_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='pic_photo_or_album_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.pic_sysphoto","title":"<code>pic_sysphoto(f)</code>","text":"<p>\u4e3a\u5f39\u51fa\u7cfb\u7edf\u62cd\u7167\u53d1\u56fe\u7684\u4e8b\u4ef6\u63a8\u9001 <code>(pic_sysphoto_event)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def pic_sysphoto(self, f):\n    \"\"\"\n    \u4e3a\u5f39\u51fa\u7cfb\u7edf\u62cd\u7167\u53d1\u56fe\u7684\u4e8b\u4ef6\u63a8\u9001 ``(pic_sysphoto_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='pic_sysphoto_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.pic_weixin","title":"<code>pic_weixin(f)</code>","text":"<p>\u4e3a\u5f39\u51fa\u5fae\u4fe1\u76f8\u518c\u53d1\u56fe\u5668\u7684\u4e8b\u4ef6\u63a8\u9001 <code>(pic_weixin_event)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def pic_weixin(self, f):\n    \"\"\"\n    \u4e3a\u5f39\u51fa\u5fae\u4fe1\u76f8\u518c\u53d1\u56fe\u5668\u7684\u4e8b\u4ef6\u63a8\u9001 ``(pic_weixin_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='pic_weixin_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.scan","title":"<code>scan(f)</code>","text":"<p>\u4e3a\u626b\u63cf\u63a8\u9001 <code>(scan)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def scan(self, f):\n    \"\"\"\n    \u4e3a\u626b\u63cf\u63a8\u9001 ``(scan)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='scan_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.scancode_push","title":"<code>scancode_push(f)</code>","text":"<p>\u4e3a\u626b\u63cf\u63a8\u9001 <code>(scancode_push)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def scancode_push(self, f):\n    \"\"\"\n    \u4e3a\u626b\u63cf\u63a8\u9001 ``(scancode_push)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='scancode_push_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.scancode_waitmsg","title":"<code>scancode_waitmsg(f)</code>","text":"<p>\u4e3a\u626b\u63cf\u5f39\u6d88\u606f <code>(scancode_waitmsg)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def scancode_waitmsg(self, f):\n    \"\"\"\n    \u4e3a\u626b\u63cf\u5f39\u6d88\u606f ``(scancode_waitmsg)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='scancode_waitmsg_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.shortvideo","title":"<code>shortvideo(f)</code>","text":"<p>\u4e3a\u5c0f\u89c6\u9891 <code>(shortvideo)</code> \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def shortvideo(self, f):\n    \"\"\"\n    \u4e3a\u5c0f\u89c6\u9891 ``(shortvideo)`` \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='shortvideo')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.submit_membercard_user_info","title":"<code>submit_membercard_user_info(f)</code>","text":"<p>\u4e3a\u7528\u6237\u901a\u8fc7\u4e00\u952e\u6fc0\u6d3b\u7684\u65b9\u5f0f\u63d0\u4ea4\u4fe1\u606f\u5e76\u70b9\u51fb\u6fc0\u6d3b\u6216\u8005\u7528\u6237\u4fee\u6539\u4f1a\u5458\u5361\u4fe1\u606f <code>(submit_membercard_user_info_event)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def submit_membercard_user_info(self, f):\n    \"\"\"\n    \u4e3a\u7528\u6237\u901a\u8fc7\u4e00\u952e\u6fc0\u6d3b\u7684\u65b9\u5f0f\u63d0\u4ea4\u4fe1\u606f\u5e76\u70b9\u51fb\u6fc0\u6d3b\u6216\u8005\u7528\u6237\u4fee\u6539\u4f1a\u5458\u5361\u4fe1\u606f ``(submit_membercard_user_info_event)``\n    \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='submit_membercard_user_info_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.subscribe","title":"<code>subscribe(f)</code>","text":"<p>\u4e3a\u88ab\u5173\u6ce8 <code>(subscribe)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def subscribe(self, f):\n    \"\"\"\n    \u4e3a\u88ab\u5173\u6ce8 ``(subscribe)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='subscribe_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.templatesendjobfinish_event","title":"<code>templatesendjobfinish_event(f)</code>","text":"<p>\u5728\u6a21\u7248\u6d88\u606f\u53d1\u9001\u4efb\u52a1\u5b8c\u6210\u540e\uff0c\u5fae\u4fe1\u670d\u52a1\u5668\u4f1a\u5c06\u662f\u5426\u9001\u8fbe\u6210\u529f\u4f5c\u4e3a\u901a\u77e5\uff0c\u53d1\u9001\u5230\u5f00\u53d1\u8005\u4e2d\u5fc3\u4e2d\u586b\u5199\u7684\u670d\u52a1\u5668\u914d\u7f6e\u5730\u5740\u4e2d</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def templatesendjobfinish_event(self, f):\n    \"\"\"\u5728\u6a21\u7248\u6d88\u606f\u53d1\u9001\u4efb\u52a1\u5b8c\u6210\u540e\uff0c\u5fae\u4fe1\u670d\u52a1\u5668\u4f1a\u5c06\u662f\u5426\u9001\u8fbe\u6210\u529f\u4f5c\u4e3a\u901a\u77e5\uff0c\u53d1\u9001\u5230\u5f00\u53d1\u8005\u4e2d\u5fc3\u4e2d\u586b\u5199\u7684\u670d\u52a1\u5668\u914d\u7f6e\u5730\u5740\u4e2d\n    \"\"\"\n    self.add_handler(f, type='templatesendjobfinish_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.text","title":"<code>text(f)</code>","text":"<p>\u4e3a\u6587\u672c <code>(text)</code> \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def text(self, f):\n    \"\"\"\n    \u4e3a\u6587\u672c ``(text)`` \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='text')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.unknown","title":"<code>unknown(f)</code>","text":"<p>\u4e3a\u672a\u77e5\u7c7b\u578b <code>(unknown)</code> \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def unknown(self, f):\n    \"\"\"\n    \u4e3a\u672a\u77e5\u7c7b\u578b ``(unknown)`` \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='unknown')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.unknown_event","title":"<code>unknown_event(f)</code>","text":"<p>\u4e3a\u672a\u77e5\u7c7b\u578b <code>(unknown_event)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def unknown_event(self, f):\n    \"\"\"\n    \u4e3a\u672a\u77e5\u7c7b\u578b ``(unknown_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='unknown_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.unsubscribe","title":"<code>unsubscribe(f)</code>","text":"<p>\u4e3a\u88ab\u53d6\u6d88\u5173\u6ce8 <code>(unsubscribe)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def unsubscribe(self, f):\n    \"\"\"\n    \u4e3a\u88ab\u53d6\u6d88\u5173\u6ce8 ``(unsubscribe)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='unsubscribe_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.update_member_card","title":"<code>update_member_card(f)</code>","text":"<p>\u4e3a\u7528\u6237\u7684\u4f1a\u5458\u5361\u79ef\u5206\u4f59\u989d\u53d1\u751f\u53d8\u52a8 <code>(update_member_card_event)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def update_member_card(self, f):\n    \"\"\"\n    \u4e3a\u7528\u6237\u7684\u4f1a\u5458\u5361\u79ef\u5206\u4f59\u989d\u53d1\u751f\u53d8\u52a8 ``(update_member_card_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='update_member_card_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.user_consume_card","title":"<code>user_consume_card(f)</code>","text":"<p>\u4e3a\u5361\u5238\u88ab\u6838\u9500 <code>(user_consume_card_event)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def user_consume_card(self, f):\n    \"\"\"\n    \u4e3a\u5361\u5238\u88ab\u6838\u9500 ``(user_consume_card_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='user_consume_card_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.user_del_card","title":"<code>user_del_card(f)</code>","text":"<p>\u4e3a\u7528\u6237\u5220\u9664\u5361\u5238 <code>(user_del_card_event)</code>  \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def user_del_card(self, f):\n    \"\"\"\n    \u4e3a\u7528\u6237\u5220\u9664\u5361\u5238 ``(user_del_card_event)``  \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='user_del_card_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.user_enter_session_from_card","title":"<code>user_enter_session_from_card(f)</code>","text":"<p>\u4e3a\u7528\u6237\u5361\u5238\u91cc\u70b9\u51fb\u67e5\u770b\u516c\u4f17\u53f7\u8fdb\u5165\u4f1a\u8bdd <code>(user_enter_session_from_card_event)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def user_enter_session_from_card(self, f):\n    \"\"\"\n    \u4e3a\u7528\u6237\u5361\u5238\u91cc\u70b9\u51fb\u67e5\u770b\u516c\u4f17\u53f7\u8fdb\u5165\u4f1a\u8bdd ``(user_enter_session_from_card_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='user_enter_session_from_card_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.user_get_card","title":"<code>user_get_card(f)</code>","text":"<p>\u4e3a\u7528\u6237\u9886\u53d6\u5361\u5238 <code>(user_get_card_event)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def user_get_card(self, f):\n    \"\"\"\n    \u4e3a\u7528\u6237\u9886\u53d6\u5361\u5238 ``(user_get_card_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='user_get_card_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.user_gifting_card","title":"<code>user_gifting_card(f)</code>","text":"<p>\u4e3a\u7528\u6237\u8f6c\u8d60\u5361\u5238 <code>(user_gifting_card_event)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def user_gifting_card(self, f):\n    \"\"\"\n    \u4e3a\u7528\u6237\u8f6c\u8d60\u5361\u5238 ``(user_gifting_card_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='user_gifting_card_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.user_pay_from_pay_cell","title":"<code>user_pay_from_pay_cell(f)</code>","text":"<p>\u4e3a\u5fae\u4fe1\u4e70\u5355\u5b8c\u6210 <code>(user_pay_from_pay_cell_event)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def user_pay_from_pay_cell(self, f):\n    \"\"\"\n    \u4e3a\u5fae\u4fe1\u4e70\u5355\u5b8c\u6210 ``(user_pay_from_pay_cell_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='user_pay_from_pay_cell_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.user_scan_product","title":"<code>user_scan_product(f)</code>","text":"<p>\u4e3a\u6253\u5f00\u5546\u54c1\u4e3b\u9875\u4e8b\u4ef6\u63a8\u9001 <code>(user_scan_product_event)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def user_scan_product(self, f):\n    \"\"\"\n    \u4e3a\u6253\u5f00\u5546\u54c1\u4e3b\u9875\u4e8b\u4ef6\u63a8\u9001 ``(user_scan_product_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='user_scan_product_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.user_scan_product_async","title":"<code>user_scan_product_async(f)</code>","text":"<p>\u4e3a\u5730\u7406\u4f4d\u7f6e\u4fe1\u606f\u5f02\u6b65\u63a8\u9001 <code>(user_scan_product_async_event)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def user_scan_product_async(self, f):\n    \"\"\"\n    \u4e3a\u5730\u7406\u4f4d\u7f6e\u4fe1\u606f\u5f02\u6b65\u63a8\u9001 ``(user_scan_product_async_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='user_scan_product_async_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.user_scan_product_enter_session","title":"<code>user_scan_product_enter_session(f)</code>","text":"<p>\u4e3a\u8fdb\u5165\u516c\u4f17\u53f7\u4e8b\u4ef6\u63a8\u9001 <code>(user_scan_product_enter_session_event)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def user_scan_product_enter_session(self, f):\n    \"\"\"\n    \u4e3a\u8fdb\u5165\u516c\u4f17\u53f7\u4e8b\u4ef6\u63a8\u9001 ``(user_scan_product_enter_session_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='user_scan_product_enter_session_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.user_scan_product_verify_action","title":"<code>user_scan_product_verify_action(f)</code>","text":"<p>\u4e3a\u5546\u54c1\u5ba1\u6838\u7ed3\u679c\u63a8\u9001 <code>(user_scan_product_verify_action_event)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def user_scan_product_verify_action(self, f):\n    \"\"\"\n    \u4e3a\u5546\u54c1\u5ba1\u6838\u7ed3\u679c\u63a8\u9001 ``(user_scan_product_verify_action_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='user_scan_product_verify_action_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.user_view_card","title":"<code>user_view_card(f)</code>","text":"<p>\u4e3a\u7528\u6237\u8fdb\u5165\u4f1a\u5458\u5361 <code>(user_view_card_event)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def user_view_card(self, f):\n    \"\"\"\n    \u4e3a\u7528\u6237\u8fdb\u5165\u4f1a\u5458\u5361 ``(user_view_card_event)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='user_view_card_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.video","title":"<code>video(f)</code>","text":"<p>\u4e3a\u89c6\u9891 <code>(video)</code> \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def video(self, f):\n    \"\"\"\n    \u4e3a\u89c6\u9891 ``(video)`` \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='video')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.view","title":"<code>view(f)</code>","text":"<p>\u4e3a\u94fe\u63a5 <code>(view)</code> \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def view(self, f):\n    \"\"\"\n    \u4e3a\u94fe\u63a5 ``(view)`` \u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='view_event')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.BaseRoBot.voice","title":"<code>voice(f)</code>","text":"<p>\u4e3a\u8bed\u97f3 <code>(voice)</code> \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def voice(self, f):\n    \"\"\"\n    \u4e3a\u8bed\u97f3 ``(voice)`` \u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a handler \u65b9\u6cd5\u7684\u88c5\u9970\u5668\u3002\n    \"\"\"\n    self.add_handler(f, type='voice')\n    return f\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.ZgRoBot","title":"<code>ZgRoBot</code>","text":"<p>             Bases: <code>BaseRoBot</code></p> <p>ZgRoBot \u662f\u4e00\u4e2a\u7ee7\u627f\u81ea BaseRoBot \u7684\u5bf9\u8c61\uff0c\u5728 BaseRoBot \u7684\u57fa\u7840\u4e0a\u4f7f\u7528\u4e86 bottle \u6846\u67b6\uff0c \u63d0\u4f9b\u63a5\u6536\u5fae\u4fe1\u670d\u52a1\u5668\u53d1\u6765\u7684\u8bf7\u6c42\u7684\u529f\u80fd\u3002</p> Source code in <code>zgrobot/robot.py</code> <pre><code>class ZgRoBot(BaseRoBot):\n    \"\"\"\n    ZgRoBot \u662f\u4e00\u4e2a\u7ee7\u627f\u81ea BaseRoBot \u7684\u5bf9\u8c61\uff0c\u5728 BaseRoBot \u7684\u57fa\u7840\u4e0a\u4f7f\u7528\u4e86 bottle \u6846\u67b6\uff0c\n    \u63d0\u4f9b\u63a5\u6536\u5fae\u4fe1\u670d\u52a1\u5668\u53d1\u6765\u7684\u8bf7\u6c42\u7684\u529f\u80fd\u3002\n    \"\"\"\n\n    @cached_property\n    def wsgi(self):\n        if not self._handlers:\n            raise RuntimeError('No Handler.')\n        from bottle import Bottle\n        from zgrobot.contrib.bottle import make_view\n\n        app = Bottle()\n        app.route('&lt;t:path&gt;', ['GET', 'POST'], make_view(self))\n        return app\n\n    def run(\n        self, server=None, host=None, port=None, enable_pretty_logging=True\n    ):\n        \"\"\"\n        \u8fd0\u884c ZgRoBot\u3002\n\n        :param server: \u4f20\u9012\u7ed9 Bottle \u6846\u67b6 run \u65b9\u6cd5\u7684\u53c2\u6570\uff0c\u8be6\u60c5\u89c1\\\n        `bottle \u6587\u6863 &lt;https://bottlepy.org/docs/dev/deployment.html#switching-the-server-backend&gt;`_\n        :param host: \u8fd0\u884c\u65f6\u7ed1\u5b9a\u7684\u4e3b\u673a\u5730\u5740\n        :param port: \u8fd0\u884c\u65f6\u7ed1\u5b9a\u7684\u4e3b\u673a\u7aef\u53e3\n        :param enable_pretty_logging: \u662f\u5426\u5f00\u542f log \u7684\u8f93\u51fa\u683c\u5f0f\u4f18\u5316\n        \"\"\"\n        if enable_pretty_logging:\n            from zgrobot.logger import enable_pretty_logging\n            enable_pretty_logging(self.logger)\n        if server is None:\n            server = self.config[\"SERVER\"]\n        if host is None:\n            host = self.config[\"HOST\"]\n        if port is None:\n            port = self.config[\"PORT\"]\n        try:\n            self.wsgi.run(server=server, host=host, port=port)\n        except KeyboardInterrupt:\n            exit(0)\n</code></pre>"},{"location":"api/robot.html#zgrobot.robot.ZgRoBot.run","title":"<code>run(server=None, host=None, port=None, enable_pretty_logging=True)</code>","text":"<p>\u8fd0\u884c ZgRoBot\u3002</p> <p>:param server: \u4f20\u9012\u7ed9 Bottle \u6846\u67b6 run \u65b9\u6cd5\u7684\u53c2\u6570\uff0c\u8be6\u60c5\u89c1        <code>bottle \u6587\u6863 &lt;https://bottlepy.org/docs/dev/deployment.html#switching-the-server-backend&gt;</code>_ :param host: \u8fd0\u884c\u65f6\u7ed1\u5b9a\u7684\u4e3b\u673a\u5730\u5740 :param port: \u8fd0\u884c\u65f6\u7ed1\u5b9a\u7684\u4e3b\u673a\u7aef\u53e3 :param enable_pretty_logging: \u662f\u5426\u5f00\u542f log \u7684\u8f93\u51fa\u683c\u5f0f\u4f18\u5316</p> Source code in <code>zgrobot/robot.py</code> <pre><code>def run(\n    self, server=None, host=None, port=None, enable_pretty_logging=True\n):\n    \"\"\"\n    \u8fd0\u884c ZgRoBot\u3002\n\n    :param server: \u4f20\u9012\u7ed9 Bottle \u6846\u67b6 run \u65b9\u6cd5\u7684\u53c2\u6570\uff0c\u8be6\u60c5\u89c1\\\n    `bottle \u6587\u6863 &lt;https://bottlepy.org/docs/dev/deployment.html#switching-the-server-backend&gt;`_\n    :param host: \u8fd0\u884c\u65f6\u7ed1\u5b9a\u7684\u4e3b\u673a\u5730\u5740\n    :param port: \u8fd0\u884c\u65f6\u7ed1\u5b9a\u7684\u4e3b\u673a\u7aef\u53e3\n    :param enable_pretty_logging: \u662f\u5426\u5f00\u542f log \u7684\u8f93\u51fa\u683c\u5f0f\u4f18\u5316\n    \"\"\"\n    if enable_pretty_logging:\n        from zgrobot.logger import enable_pretty_logging\n        enable_pretty_logging(self.logger)\n    if server is None:\n        server = self.config[\"SERVER\"]\n    if host is None:\n        host = self.config[\"HOST\"]\n    if port is None:\n        port = self.config[\"PORT\"]\n    try:\n        self.wsgi.run(server=server, host=host, port=port)\n    except KeyboardInterrupt:\n        exit(0)\n</code></pre>"},{"location":"api/session.html","title":"\u4f1a\u8bdd","text":""},{"location":"api/session.html#zgrobot.session.sqlitestorage.SQLiteStorage","title":"<code>SQLiteStorage</code>","text":"<p>             Bases: <code>SessionStorage</code></p> <p>SQLiteStorge \u4f1a\u628a Session \u6570\u636e\u50a8\u5b58\u5728\u4e00\u4e2a SQLite \u6570\u636e\u5e93\u6587\u4ef6\u4e2d ::</p> <pre><code>import zgrobot\nfrom zgrobot.session.sqlitestorage import SQLiteStorage\n\nsession_storage = SQLiteStorage\nrobot = zgrobot.ZgRoBot(token=\"token\", enable_session=True,\n                        session_storage=session_storage)\n</code></pre> <p>:param filename: SQLite\u6570\u636e\u5e93\u7684\u6587\u4ef6\u540d, \u9ed8\u8ba4\u662f <code>zgrobot_session.sqlite3</code></p> Source code in <code>zgrobot/session/sqlitestorage.py</code> <pre><code>class SQLiteStorage(SessionStorage):\n    \"\"\"\n    SQLiteStorge \u4f1a\u628a Session \u6570\u636e\u50a8\u5b58\u5728\u4e00\u4e2a SQLite \u6570\u636e\u5e93\u6587\u4ef6\u4e2d ::\n\n        import zgrobot\n        from zgrobot.session.sqlitestorage import SQLiteStorage\n\n        session_storage = SQLiteStorage\n        robot = zgrobot.ZgRoBot(token=\"token\", enable_session=True,\n                                session_storage=session_storage)\n\n    :param filename: SQLite\u6570\u636e\u5e93\u7684\u6587\u4ef6\u540d, \u9ed8\u8ba4\u662f ``zgrobot_session.sqlite3``\n    \"\"\"\n\n    def __init__(self, filename='zgrobot_session.sqlite3'):\n        self.db = sqlite3.connect(filename, check_same_thread=False)\n        self.db.text_factory = str\n        self.db.execute(__CREATE_TABLE_SQL__)\n\n    def get(self, id):\n        \"\"\"\n        \u6839\u636e id \u83b7\u53d6\u6570\u636e\u3002\n\n        :param id: \u8981\u83b7\u53d6\u7684\u6570\u636e\u7684 id\n        :return: \u8fd4\u56de\u53d6\u5230\u7684\u6570\u636e\uff0c\u5982\u679c\u662f\u7a7a\u5219\u8fd4\u56de\u4e00\u4e2a\u7a7a\u7684 ``dict`` \u5bf9\u8c61\n        \"\"\"\n        session_json = self.db.execute(\n            \"SELECT value FROM ZgRoBot WHERE id=? LIMIT 1;\", (id, )\n        ).fetchone()\n        if session_json is None:\n            return {}\n        return json_loads(session_json[0])\n\n    def set(self, id, value):\n        \"\"\"\n        \u6839\u636e id \u5199\u5165\u6570\u636e\u3002\n\n        :param id: \u8981\u5199\u5165\u7684 id\n        :param value: \u8981\u5199\u5165\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u662f\u4e00\u4e2a ``dict`` \u5bf9\u8c61\n        \"\"\"\n        self.db.execute(\n            \"INSERT OR REPLACE INTO ZgRoBot (id, value) VALUES (?,?);\",\n            (id, json_dumps(value))\n        )\n        self.db.commit()\n\n    def delete(self, id):\n        \"\"\"\n        \u6839\u636e id \u5220\u9664\u6570\u636e\u3002\n\n        :param id: \u8981\u5220\u9664\u7684\u6570\u636e\u7684 id\n        \"\"\"\n        self.db.execute(\"DELETE FROM ZgRoBot WHERE id=?;\", (id, ))\n        self.db.commit()\n</code></pre>"},{"location":"api/session.html#zgrobot.session.sqlitestorage.SQLiteStorage.delete","title":"<code>delete(id)</code>","text":"<p>\u6839\u636e id \u5220\u9664\u6570\u636e\u3002</p> <p>:param id: \u8981\u5220\u9664\u7684\u6570\u636e\u7684 id</p> Source code in <code>zgrobot/session/sqlitestorage.py</code> <pre><code>def delete(self, id):\n    \"\"\"\n    \u6839\u636e id \u5220\u9664\u6570\u636e\u3002\n\n    :param id: \u8981\u5220\u9664\u7684\u6570\u636e\u7684 id\n    \"\"\"\n    self.db.execute(\"DELETE FROM ZgRoBot WHERE id=?;\", (id, ))\n    self.db.commit()\n</code></pre>"},{"location":"api/session.html#zgrobot.session.sqlitestorage.SQLiteStorage.get","title":"<code>get(id)</code>","text":"<p>\u6839\u636e id \u83b7\u53d6\u6570\u636e\u3002</p> <p>:param id: \u8981\u83b7\u53d6\u7684\u6570\u636e\u7684 id :return: \u8fd4\u56de\u53d6\u5230\u7684\u6570\u636e\uff0c\u5982\u679c\u662f\u7a7a\u5219\u8fd4\u56de\u4e00\u4e2a\u7a7a\u7684 <code>dict</code> \u5bf9\u8c61</p> Source code in <code>zgrobot/session/sqlitestorage.py</code> <pre><code>def get(self, id):\n    \"\"\"\n    \u6839\u636e id \u83b7\u53d6\u6570\u636e\u3002\n\n    :param id: \u8981\u83b7\u53d6\u7684\u6570\u636e\u7684 id\n    :return: \u8fd4\u56de\u53d6\u5230\u7684\u6570\u636e\uff0c\u5982\u679c\u662f\u7a7a\u5219\u8fd4\u56de\u4e00\u4e2a\u7a7a\u7684 ``dict`` \u5bf9\u8c61\n    \"\"\"\n    session_json = self.db.execute(\n        \"SELECT value FROM ZgRoBot WHERE id=? LIMIT 1;\", (id, )\n    ).fetchone()\n    if session_json is None:\n        return {}\n    return json_loads(session_json[0])\n</code></pre>"},{"location":"api/session.html#zgrobot.session.sqlitestorage.SQLiteStorage.set","title":"<code>set(id, value)</code>","text":"<p>\u6839\u636e id \u5199\u5165\u6570\u636e\u3002</p> <p>:param id: \u8981\u5199\u5165\u7684 id :param value: \u8981\u5199\u5165\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u662f\u4e00\u4e2a <code>dict</code> \u5bf9\u8c61</p> Source code in <code>zgrobot/session/sqlitestorage.py</code> <pre><code>def set(self, id, value):\n    \"\"\"\n    \u6839\u636e id \u5199\u5165\u6570\u636e\u3002\n\n    :param id: \u8981\u5199\u5165\u7684 id\n    :param value: \u8981\u5199\u5165\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u662f\u4e00\u4e2a ``dict`` \u5bf9\u8c61\n    \"\"\"\n    self.db.execute(\n        \"INSERT OR REPLACE INTO ZgRoBot (id, value) VALUES (?,?);\",\n        (id, json_dumps(value))\n    )\n    self.db.commit()\n</code></pre>"},{"location":"api/utils.html","title":"\u5de5\u5177","text":""},{"location":"api/utils.html#zgrobot.utils.timeout","title":"<code>timeout</code>","text":"<p>\u8d85\u65f6\u8fd4\u56de success</p> <p>Attributes:</p> Name Type Description <code>secconds</code> <code>float</code> <p>\u8d85\u65f6\u65f6\u95f4</p> Source code in <code>zgrobot/utils.py</code> <pre><code>class timeout:\n    \"\"\"\u8d85\u65f6\u8fd4\u56de success\n\n    Attributes:\n        secconds (float): \u8d85\u65f6\u65f6\u95f4\n    \"\"\"\n    __executor = futures.ThreadPoolExecutor(1)\n\n    def __init__(self, seconds: float):\n        self.seconds = seconds\n\n    def __call__(self, func):\n\n        @functools.wraps(func)\n        def wrapper(*args, **kw):\n            future = timeout.__executor.submit(func, *args, **kw)\n            try:\n                result = future.result(timeout=self.seconds)\n                print(f\"\u6210\u529f\u8f93\u51fa\uff01{self.seconds}\")\n            except Exception as e:\n                print(e, \"======\")\n                result = \"success\"\n            return result\n\n        return wrapper\n</code></pre>"},{"location":"api/utils.html#zgrobot.utils.byte2int","title":"<code>byte2int(s, index=0)</code>","text":"<p>Get the ASCII int value of a character in a string.</p> <p>:param s: a string :param index: the position of desired character</p> <p>:return: ASCII int value</p> Source code in <code>zgrobot/utils.py</code> <pre><code>def byte2int(s, index=0):\n    \"\"\"Get the ASCII int value of a character in a string.\n\n    :param s: a string\n    :param index: the position of desired character\n\n    :return: ASCII int value\n    \"\"\"\n    return s[index]\n</code></pre>"},{"location":"api/utils.html#zgrobot.utils.is_string","title":"<code>is_string(value)</code>","text":"<p>Check if value's type is <code>str</code> or <code>bytes</code></p> Source code in <code>zgrobot/utils.py</code> <pre><code>def is_string(value) -&gt; bool:\n    \"\"\"Check if value's type is `str` or `bytes`\n    \"\"\"\n    return isinstance(value, string_types)\n</code></pre>"},{"location":"api/utils.html#zgrobot.utils.pay_sign_dict","title":"<code>pay_sign_dict(appid, pay_sign_key, add_noncestr=True, add_timestamp=True, add_appid=True, **kwargs)</code>","text":"<p>\u652f\u4ed8\u53c2\u6570\u7b7e\u540d</p> Source code in <code>zgrobot/utils.py</code> <pre><code>def pay_sign_dict(\n    appid,\n    pay_sign_key,\n    add_noncestr=True,\n    add_timestamp=True,\n    add_appid=True,\n    **kwargs\n):\n    \"\"\"\n    \u652f\u4ed8\u53c2\u6570\u7b7e\u540d\n    \"\"\"\n    assert pay_sign_key, \"PAY SIGN KEY IS EMPTY\"\n\n    if add_appid:\n        kwargs.update({'appid': appid})\n\n    if add_noncestr:\n        kwargs.update({'noncestr': generate_token()})\n\n    if add_timestamp:\n        kwargs.update({'timestamp': int(time.time())})\n\n    params = kwargs.items()\n\n    _params = [\n        (k.lower(), v) for k, v in kwargs.items() if k.lower() != \"appid\"\n    ]\n    _params += [('appid', appid), ('appkey', pay_sign_key)]\n    _params.sort()\n\n    sign = '&amp;'.join([\"%s=%s\" % (str(p[0]), str(p[1]))\n                     for p in _params]).encode(\"utf-8\")\n    sign = sha1(sign).hexdigest()\n    sign_type = 'SHA1'\n\n    return dict(params), sign, sign_type\n</code></pre>"},{"location":"api/utils.html#zgrobot.utils.str2button","title":"<code>str2button(button_txt, reply_txt)</code>","text":"<p>\u5c06\u666e\u901a\u6587\u672c\u5305\u88c5\u4e3a\u667a\u80fd\u6309\u94ae</p> <p>Parameters:</p> Name Type Description Default <code>button_txt</code> <code>str</code> <p>\u60f3\u8981\u8f6c\u6362\u4e3a\u667a\u80fd\u6309\u94ae\u7684\u6587\u672c</p> required <code>reply_txt</code> <code>str</code> <p>\u6309\u4e0b\u667a\u80fd\u6309\u94ae\u540e\u56de\u590d\u7684\u6587\u672c</p> required <p>Returns:</p> Name Type Description <code>str</code> <code>str</code> <p>\u667a\u80fd\u6309\u94ae\u7684\u5b57\u7b26\u4e32</p> Source code in <code>zgrobot/utils.py</code> <pre><code>def str2button(button_txt: str, reply_txt: str) -&gt; str:\n    \"\"\"\n    \u5c06\u666e\u901a\u6587\u672c\u5305\u88c5\u4e3a\u667a\u80fd\u6309\u94ae\n\n    Args:\n        button_txt (str): \u60f3\u8981\u8f6c\u6362\u4e3a\u667a\u80fd\u6309\u94ae\u7684\u6587\u672c\n        reply_txt (str): \u6309\u4e0b\u667a\u80fd\u6309\u94ae\u540e\u56de\u590d\u7684\u6587\u672c\n\n    Returns:\n        str: \u667a\u80fd\u6309\u94ae\u7684\u5b57\u7b26\u4e32\n    \"\"\"\n    return f\"&lt;a href='weixin://bizmsgmenu?msgmenuid=1&amp;msgmenucontent={button_txt}'&gt;{reply_txt}&lt;/a&gt;\"\n</code></pre>"},{"location":"api/messages/events.html","title":"\u4e8b\u4ef6","text":""},{"location":"api/messages/events.html#zgrobot.messages.events.TicketEvent","title":"<code>TicketEvent</code>","text":"<p>             Bases: <code>WeChatEvent</code></p> <p>\u70b9\u51fb\u4e8b\u4ef6</p> Source code in <code>zgrobot/messages/events.py</code> <pre><code>class TicketEvent(WeChatEvent):\n    \"\"\"\u70b9\u51fb\u4e8b\u4ef6\n    \"\"\"\n    key = StringEntry('EventKey')\n    ticket = StringEntry('Ticket')\n</code></pre>"},{"location":"api/messages/events.html#zgrobot.messages.events.WeChatEvent","title":"<code>WeChatEvent</code>","text":"<p>             Bases: <code>object</code></p> <p>\u57fa\u7840\u4e8b\u4ef6\uff0c\u9664\u4e86 UnknownEvent, \u6bcf\u4e00\u79cd Event \u90fd\u5305\u62ec\u4ee5\u4e0b\u5c5e\u6027</p> <p>Attributes:</p> Name Type Description <code>message_id</code> <code>int</code> <p>\u6d88\u606fid</p> <code>target</code> <code>str</code> <p>\u5f00\u53d1\u8005\u8d26\u53f7(OpenID)</p> <code>source</code> <code>str</code> <p>\u53d1\u9001\u65b9\u8d26\u53f7(OpenID)</p> <code>time</code> <code>int</code> <p>\u4fe1\u606f\u53d1\u9001\u7684\u65f6\u95f4\uff0c\u4e00\u4e2aUNIX\u65f6\u95f4\u6233</p> <code>raw</code> <code>str</code> <p>\u4fe1\u606f\u7684\u539f\u59cb XML \u683c\u5f0f</p> Source code in <code>zgrobot/messages/events.py</code> <pre><code>class WeChatEvent(object, metaclass=EventMetaClass):\n    \"\"\"\u57fa\u7840\u4e8b\u4ef6\uff0c\u9664\u4e86 UnknownEvent, \u6bcf\u4e00\u79cd Event \u90fd\u5305\u62ec\u4ee5\u4e0b\u5c5e\u6027\n\n    Attributes:\n        message_id (int): \u6d88\u606fid\n        target (str): \u5f00\u53d1\u8005\u8d26\u53f7(OpenID)\n        source (str): \u53d1\u9001\u65b9\u8d26\u53f7(OpenID)\n        time (int): \u4fe1\u606f\u53d1\u9001\u7684\u65f6\u95f4\uff0c\u4e00\u4e2aUNIX\u65f6\u95f4\u6233\n        raw (str): \u4fe1\u606f\u7684\u539f\u59cb XML \u683c\u5f0f\n    \"\"\"\n    target = StringEntry('ToUserName')\n    source = StringEntry('FromUserName')\n    time = IntEntry('CreateTime')\n    message_id = IntEntry('MsgID', 0)\n\n    def __init__(self, message):\n        self.__dict__.update(message)\n</code></pre>"},{"location":"api/messages/messages.html","title":"\u6d88\u606f","text":""},{"location":"api/messages/messages.html#zgrobot.messages.messages.Message","title":"<code>Message</code>","text":"<p>             Bases: <code>WeChatMessage</code></p> <p>\u7528\u4e8e\u5904\u7406\u5fae\u4fe1\u670d\u52a1\u5668\u63a8\u9001\u8fc7\u6765\u7684\u6d88\u606f</p> <p>Attributes:</p> Name Type Description <code>__type__</code> <code>str</code> <p>\u3010\u516c\u5171\u5c5e\u6027\u3011\u6d88\u606f\u7c7b\u578b</p> <code>content</code> <code>str</code> <p>\u3010\u6587\u672c\u4fe1\u606f\u3011\u6587\u672c\u6d88\u606f\u5185\u5bb9</p> <code>img</code> <p>\u3010\u56fe\u7247\u4fe1\u606f\u3011\u56fe\u7247\u94fe\u63a5</p> <code>title</code> <p>\u3010\u94fe\u63a5\u4fe1\u606f\u3011\u6d88\u606f\u6807\u9898</p> <code>description</code> <p>\u3010\u94fe\u63a5\u4fe1\u606f\u3011\u6d88\u606f\u63cf\u8ff0</p> <code>url</code> <p>\u3010\u94fe\u63a5\u4fe1\u606f\u3011\u6d88\u606f\u94fe\u63a5</p> <code>location_x</code> <p>\u3010\u4f4d\u7f6e\u4fe1\u606f\u3011\u5730\u7406\u4f4d\u7f6e\u7ef4\u5ea6</p> <code>location_y</code> <p>\u3010\u4f4d\u7f6e\u4fe1\u606f\u3011\u5730\u7406\u4f4d\u7f6e\u7ecf\u5ea6</p> <code>label</code> <p>\u3010\u4f4d\u7f6e\u4fe1\u606f\u3011\u5730\u7406\u4f4d\u7f6e\u4fe1\u606f</p> <code>scale</code> <p>\u3010\u4f4d\u7f6e\u4fe1\u606f\u3011\u5730\u56fe\u7f29\u653e\u5927\u5c0f</p> <code>media_id</code> <p>\u3010\u97f3\u9891\u4fe1\u606f\u3011\u6d88\u606f\u5a92\u4f53ID</p> <code>format</code> <p>\u3010\u8bed\u97f3\u4fe1\u606f\u3011\u8bed\u97f3\u683c\u5f0f\uff0c\u5982amr\uff0cspeex\u7b49</p> <code>recognition</code> <p>\u3010\u8bed\u97f3\u4fe1\u606f\u3011\u8bed\u97f3\u8bc6\u522b\u7ed3\u679c\uff0cUTF8\u7f16\u7801</p> <code>thumb_media_id</code> <p>\u3010\u89c6\u9891\u4fe1\u606f\u3011\u89c6\u9891\u6d88\u606f\u7f29\u7565\u56fe\u7684\u5a92\u4f53id\uff0c\u53ef\u4ee5\u8c03\u7528\u591a\u5a92\u4f53\u6587\u4ef6\u4e0b\u8f7d\u63a5\u53e3\u62c9\u53d6\u6570\u636e</p> Source code in <code>zgrobot/messages/messages.py</code> <pre><code>class Message(WeChatMessage):\n    \"\"\"\n    \u7528\u4e8e\u5904\u7406\u5fae\u4fe1\u670d\u52a1\u5668\u63a8\u9001\u8fc7\u6765\u7684\u6d88\u606f\n\n    Attributes:\n        __type__: \u3010\u516c\u5171\u5c5e\u6027\u3011\u6d88\u606f\u7c7b\u578b\n        content (str): \u3010\u6587\u672c\u4fe1\u606f\u3011\u6587\u672c\u6d88\u606f\u5185\u5bb9\n        img: \u3010\u56fe\u7247\u4fe1\u606f\u3011\u56fe\u7247\u94fe\u63a5\n        title: \u3010\u94fe\u63a5\u4fe1\u606f\u3011\u6d88\u606f\u6807\u9898\n        description: \u3010\u94fe\u63a5\u4fe1\u606f\u3011\u6d88\u606f\u63cf\u8ff0\n        url: \u3010\u94fe\u63a5\u4fe1\u606f\u3011\u6d88\u606f\u94fe\u63a5\n        location_x: \u3010\u4f4d\u7f6e\u4fe1\u606f\u3011\u5730\u7406\u4f4d\u7f6e\u7ef4\u5ea6\n        location_y: \u3010\u4f4d\u7f6e\u4fe1\u606f\u3011\u5730\u7406\u4f4d\u7f6e\u7ecf\u5ea6\n        label: \u3010\u4f4d\u7f6e\u4fe1\u606f\u3011\u5730\u7406\u4f4d\u7f6e\u4fe1\u606f\n        scale: \u3010\u4f4d\u7f6e\u4fe1\u606f\u3011\u5730\u56fe\u7f29\u653e\u5927\u5c0f\n        media_id: \u3010\u97f3\u9891\u4fe1\u606f\u3011\u6d88\u606f\u5a92\u4f53ID\n        format: \u3010\u8bed\u97f3\u4fe1\u606f\u3011\u8bed\u97f3\u683c\u5f0f\uff0c\u5982amr\uff0cspeex\u7b49\n        recognition: \u3010\u8bed\u97f3\u4fe1\u606f\u3011\u8bed\u97f3\u8bc6\u522b\u7ed3\u679c\uff0cUTF8\u7f16\u7801\n        thumb_media_id: \u3010\u89c6\u9891\u4fe1\u606f\u3011\u89c6\u9891\u6d88\u606f\u7f29\u7565\u56fe\u7684\u5a92\u4f53id\uff0c\u53ef\u4ee5\u8c03\u7528\u591a\u5a92\u4f53\u6587\u4ef6\u4e0b\u8f7d\u63a5\u53e3\u62c9\u53d6\u6570\u636e\n    \"\"\"\n    __type__: str\n    content = StringEntry('Content')\n    img = StringEntry('PicUrl')\n    title = StringEntry('Title')\n    description = StringEntry('Description')\n    url = StringEntry('Url')\n    location_x = FloatEntry('Location_X')\n    location_y = FloatEntry('Location_Y')\n    label = StringEntry('Label')\n    scale = IntEntry('Scale')\n    media_id = StringEntry('MediaId')\n    format = StringEntry('Format')\n    recognition = StringEntry('Recognition')\n    thumb_media_id = StringEntry('ThumbMediaId')\n</code></pre>"},{"location":"api/messages/messages.html#zgrobot.messages.messages.TextMessage","title":"<code>TextMessage</code>","text":"<p>             Bases: <code>WeChatMessage</code></p> <p>\u6587\u672c\u4fe1\u606f</p> <p>Attributes:</p> Name Type Description <code>type</code> <code>str</code> <p>text</p> <code>content</code> <code>str</code> <p>\u4fe1\u606f\u7684\u5185\u5bb9</p> Source code in <code>zgrobot/messages/messages.py</code> <pre><code>class TextMessage(WeChatMessage):\n    \"\"\"\u6587\u672c\u4fe1\u606f\n\n    Attributes:\n        type (str): text\n        content (str): \u4fe1\u606f\u7684\u5185\u5bb9\n    \"\"\"\n    __type__ = 'text'\n    content = StringEntry('Content')\n</code></pre>"},{"location":"api/messages/messages.html#zgrobot.messages.messages.WeChatMessage","title":"<code>WeChatMessage</code>","text":"<p>             Bases: <code>object</code></p> <p>\u7528\u4e8e\u5904\u7406\u5fae\u4fe1\u670d\u52a1\u5668\u63a8\u9001\u8fc7\u6765\u7684\u6d88\u606f</p> <p>Attributes:</p> Name Type Description <code>message_id</code> <p>\u3010\u516c\u5171\u5c5e\u6027\u3011\u6d88\u606fid\uff0c64\u4f4d\u6574\u578b</p> <code>target</code> <p>\u3010\u516c\u5171\u5c5e\u6027\u3011\u5f00\u53d1\u8005\u8d26\u53f7\uff08 OpenID \uff09</p> <code>source</code> <p>\u3010\u516c\u5171\u5c5e\u6027\u3011\u53d1\u9001\u65b9\u8d26\u53f7\uff08 OpenID \uff09</p> <code>time</code> <p>\u3010\u516c\u5171\u5c5e\u6027\u3011\u4fe1\u606f\u53d1\u9001\u7684\u65f6\u95f4\uff0c\u4e00\u4e2aUNIX\u65f6\u95f4\u6233\u3002</p> Source code in <code>zgrobot/messages/messages.py</code> <pre><code>class WeChatMessage(object, metaclass=MessageMetaClass):\n    \"\"\"\n    \u7528\u4e8e\u5904\u7406\u5fae\u4fe1\u670d\u52a1\u5668\u63a8\u9001\u8fc7\u6765\u7684\u6d88\u606f\n\n    Attributes:\n        message_id: \u3010\u516c\u5171\u5c5e\u6027\u3011\u6d88\u606fid\uff0c64\u4f4d\u6574\u578b\n        target: \u3010\u516c\u5171\u5c5e\u6027\u3011\u5f00\u53d1\u8005\u8d26\u53f7\uff08 OpenID \uff09\n        source: \u3010\u516c\u5171\u5c5e\u6027\u3011\u53d1\u9001\u65b9\u8d26\u53f7\uff08 OpenID \uff09\n        time: \u3010\u516c\u5171\u5c5e\u6027\u3011\u4fe1\u606f\u53d1\u9001\u7684\u65f6\u95f4\uff0c\u4e00\u4e2aUNIX\u65f6\u95f4\u6233\u3002\n    \"\"\"\n    message_id = IntEntry('MsgId', 0)\n    target = StringEntry('ToUserName')\n    source = StringEntry('FromUserName')\n    time = IntEntry('CreateTime', 0)\n\n    def __init__(self, message):\n        self.__dict__.update(message)\n</code></pre>"},{"location":"tutorial/QA.html","title":"Q&A","text":""},{"location":"tutorial/QA.html#\u81ea\u5b9a\u4e49-token-\u7684\u5b58\u50a8","title":"\u81ea\u5b9a\u4e49 token \u7684\u5b58\u50a8","text":"<p>\u901a\u8fc7\u91cd\u5199 get_access_token \u51fd\u6570\u6765\u81ea\u5b9a\u4e49 token \u7684\u5b58\u50a8\uff0c\u9996\u5148\u6211\u4eec\u770b <code>get_access_token()</code> \u7684\u6e90\u7801</p> <pre><code>def get_access_token(self) -&gt; str:\n    \"\"\"\n    \u5224\u65ad\u73b0\u6709\u7684token\u662f\u5426\u8fc7\u671f\u3002\n    \u7528\u6237\u9700\u8981\u591a\u8fdb\u7a0b\u6216\u8005\u591a\u673a\u90e8\u7f72\u53ef\u4ee5\u624b\u52a8\u91cd\u5199\u8fd9\u4e2a\u51fd\u6570\n    \u6765\u81ea\u5b9a\u4e49token\u7684\u5b58\u50a8\uff0c\u5237\u65b0\u7b56\u7565\u3002\n\n    :return: \u8fd4\u56de ``token``\n    \"\"\"\n    if self._token:\n        now = time.time()\n        if self.token_expires_at - now &gt; 60:\n            return self._token\n    with LOCK:\n        json_str = self.grant_token()\n        self._token = json_str[\"access_token\"]\n        self.token_expires_at = int(time.time()) + json_str[\"expires_in\"]\n    return self._token\n</code></pre> <p>\u8fd9\u5176\u4e2d\u5305\u542b\u4e86\u4e24\u4e2a\u529f\u80fd\uff1a</p> <ul> <li>\u901a\u8fc7\u65f6\u95f4\u6233\u5bf9\u73b0\u6709 <code>token</code> \u5224\u65ad\u662f\u5426\u8fc7\u671f\uff1b\u82e5\u672a\u8fc7\u671f\uff0c\u5219\u76f4\u63a5\u8fd4\u56de\u73b0\u6709\u7684 <code>token</code></li> <li>\u5bf9\u73b0\u6709 <code>token</code> \u5224\u65ad\u662f\u5426\u8fc7\u671f\uff1b\u82e5\u8fc7\u671f\u4e86\uff0c\u5bf9\u8fdb\u7a0b\u8fdb\u884c\u4e0a\u9501\uff0c\u5e76\u91cd\u65b0\u83b7\u53d6 <code>token</code></li> </ul> <p>\u56e0\u6b64\uff0c\u5728\u91cd\u5199 <code>get_access_token()</code> \u65f6\uff0c\u8bf7\u52a1\u5fc5\u4fdd\u8bc1\u8fd9\u4e24\u4e2a\u529f\u80fd\u7684\u5b9e\u73b0\uff0c\u5e76\u5728\u91cd\u65b0\u83b7\u53d6 <code>token</code> \u548c <code>token_expires_at</code> \u540e\uff0c\u5373\u53ef\u5bf9\u5176\u8fdb\u884c\u81ea\u5b9a\u4e49\u64cd\u4f5c\uff0c\u4f8b\u5982:</p> <pre><code>def get_access_token(self) -&gt; str:\n    if self._token:\n        now = time.time()\n        if self.token_expires_at - now &gt; 60:\n            return self._token\n    with LOCK:\n        json_str = self.grant_token()\n        self._token = json_str[\"access_token\"]\n        self.token_expires_at = int(time.time()) + json_str[\"expires_in\"]\n\n    # \u4ece\u8fd9\u91cc\u5f00\u59cb\u5373\u53ef\u8fdb\u884c\u81ea\u5b9a\u4e49 ``token`` \u7684\u64cd\u4f5c\n    return self._token\n</code></pre>"},{"location":"tutorial/config.html","title":"\u914d\u7f6e","text":""},{"location":"tutorial/config.html#\u8bf4\u660e","title":"\u8bf4\u660e","text":"<p>ZgRoBot \u4f7f\u7528 <code>ZgRoBot.Config</code> \u7c7b\u6765\u5b58\u50a8\u914d\u7f6e\u4fe1\u606f\u3002  <code>ZgRoBot</code> \u7c7b\u5b9e\u4f8b\u7684 <code>config</code> \u5c5e\u6027\u662f\u4e00\u4e2a Config() \u5b9e\u4f8b\u3002</p> <p>Config() \u7ee7\u627f\u81ea dict \u56e0\u6b64\uff0c \u4f60\u53ef\u4ee5\u50cf\u4f7f\u7528\u666e\u901a <code>dict</code> \u4e00\u6837\u4f7f\u7528\u5b83</p> bot.py<pre><code>from zgrobot import ZgRoBot\nrobot = ZgRoBot(token='2333')\n\nrobot.config.update(\n    HOST='0.0.0.0',\n    PORT=80\n)\n</code></pre> <p>\u5f53\u7136\uff0c \u4f60\u4e5f\u53ef\u4ee5\u5148\u521b\u5efa\u4e00\u4e2a <code>Config</code> \uff0c\u7136\u540e\u5728\u521d\u59cb\u5316 <code>ZgRobot</code> \u7684\u65f6\u5019\u4f20\u5165\u81ea\u5df1\u7684 <code>Config</code> ::</p> bot.py<pre><code>from zgrobot.config import Config\nconfig = Config(\n    TOKEN=\"token from config!\"\n)\nrobot = ZgRoBot(config=config, token=\"token from init\")\nassert robot.token == \"token from config!\"\n</code></pre> <p>Note</p> <p>\u5982\u679c\u4f60\u5728\u521d\u59cb\u5316 <code>ZgRoBot</code> \u65f6\u4f20\u5165\u4e86 <code>config</code> \u53c2\u6570\uff0c <code>ZgRoBot</code> \u4f1a\u5ffd\u7565\u9664 <code>logger</code> \u5916\u5176\u4ed6\u6240\u6709\u7684\u521d\u59cb\u5316\u53c2\u6570\u3002 \u5982\u679c\u4f60\u9700\u8981\u5bf9 <code>ZgRoBot</code> \u8fdb\u884c\u4e00\u4e9b\u914d\u7f6e\u64cd\u4f5c\uff0c \u8bf7\u4fee\u6539 <code>Config</code> \u3002</p> <p>\u4e0e\u666e\u901a <code>dict</code> \u4e0d\u540c\u7684\u662f\uff0c \u4f60\u53ef\u4ee5\u5148\u628a\u914d\u7f6e\u6587\u4ef6\u4fdd\u5b58\u5728\u4e00\u4e2a\u5bf9\u8c61\u6216\u662f\u6587\u4ef6\u4e2d\uff0c \u7136\u540e\u5728 Config() \u4e2d\u5bfc\u5165\u914d\u7f6e</p> bot.py<pre><code>from zgrobot import ZgRoBot\nrobot = ZgRoBot(token='2333')\n\nclass MyConfig(object):\n    HOST = '0.0.0.0'\n    PORT = 80\n\nrobot.config.from_object(MyConfig)\nrobot.config.from_pyfile(\"config.py\")\n</code></pre>"},{"location":"tutorial/config.html#\u9ed8\u8ba4\u914d\u7f6e","title":"\u9ed8\u8ba4\u914d\u7f6e","text":"<pre><code>dict(\n    TOKEN=None,\n    SERVER=\"auto\",\n    HOST=\"127.0.0.1\",\n    PORT=\"8888\",\n    SESSION_STORAGE=None,\n    APP_ID=None,\n    APP_SECRET=None,\n    ENCODING_AES_KEY=None\n)\n</code></pre>"},{"location":"tutorial/contrib.html","title":"\u96c6\u6210","text":"<p>ZgRoBot \u53ef\u4ee5\u4f5c\u4e3a\u72ec\u7acb\u670d\u52a1\u8fd0\u884c\uff0c\u4e5f\u53ef\u4ee5\u96c6\u6210\u5728\u5176\u4ed6 Web \u6846\u67b6\u4e2d\u4e00\u540c\u8fd0\u884c\u3002</p> <p>\u5148\u5199\u597d\u4f60\u7684\u673a\u5668\u4eba</p> robot.py<pre><code>from zgrobot import ZgRoBot\n\nmyrobot = ZgRoBot(token='token')\n\n@myrobot.handler\ndef hello():\n    return \"Hello World\"\n</code></pre>"},{"location":"tutorial/contrib.html#fastapi","title":"FastApi","text":"<p>ZgRoBot \u652f\u6301 fastapi 0.78+</p> <p>\u7136\u540e\u521b\u5efa\u6700\u7b80\u5355\u7684 FastApi \u9879\u76ee <code>main.py</code></p> main.py<pre><code>from zgrobot.contrib.fastapi import make_view\nfrom fastapi import FastAPI\n\nfrom robot import myrobot\n\napp = FastAPI()\n\napp.add_route(\"/\", make_view(robot=robot), methods=[\"GET\", \"POST\"])\n</code></pre> <p>\u6216\u8005\u4f7f\u7528 FastApi \u7684\u4e2d\u95f4\u4ef6 main.py<pre><code>from fastapi import FastAPI\nfrom fastapi.middleware.wsgi import WSGIMiddleware\n\nfrom robot import myrobot\n\napp = FastAPI()\n\napp.mount(\"/\", WSGIMiddleware(myrobot.wsgi))\n</code></pre></p>"},{"location":"tutorial/contrib.html#django","title":"Django","text":"<p>ZgRoBot \u652f\u6301 Django 2.2+ </p> <p>\u5728\u4f60 Django \u9879\u76ee\u4e2d\u7684 <code>urls.py</code> \u4e2d\u8c03\u7528 <code>make_view</code>\uff0c\u5c06 ZgRoBot \u96c6\u6210\u8fdb Django </p> main.py<pre><code>from django.conf.urls import patterns, include, url\nfrom zgrobot.contrib.django import make_view\nfrom robot import myrobot\n\nurlpatterns = patterns('',\n    url(r'^robot/', make_view(myrobot)),\n)\n</code></pre>"},{"location":"tutorial/contrib.html#flask","title":"Flask","text":"<p>\u5728 Flask \u9879\u76ee\u4e2d\u4e3a Flask \u5b9e\u4f8b\u96c6\u6210 ZgRoBot</p> main.py<pre><code>from flask import Flask\nfrom robot import myrobot\nfrom zgrobot.contrib.flask import make_view\n\napp = Flask(__name__)\napp.add_url_rule(\n    rule='/robot', # ZgRoBot \u6302\u8f7d\u5730\u5740\n    endpoint='zgrobot', # Flask \u7684 endpoint\n    view_func=make_view(myrobot),\n    methods=['GET', 'POST']\n)\n</code></pre>"},{"location":"tutorial/contrib.html#bottle","title":"Bottle","text":"<p>\u5728\u4f60\u7684 Bottle App \u4e2d\u96c6\u6210 ZgRoBot</p> main.py<pre><code>from bottle import Bottle\nfrom zgrobot.contrib.bottle import make_view\nfrom robot import myrobot\n\napp = Bottle()\napp.route(\n    '/robot',  # ZgRoBot \u6302\u8f7d\u5730\u5740\n    ['GET', 'POST'],\n    make_view(myrobot)\n)\n</code></pre>"},{"location":"tutorial/contrib.html#tornado","title":"Tornado","text":"<p>\u6700\u7b80\u5355\u7684 Hello World</p> main.py<pre><code>import tornado.ioloop\nimport tornado.web\nfrom zgrobot.contrib.tornado import make_handler\nfrom robot import myrobot\n\napplication = tornado.web.Application([\n    (r\"/robot/\", make_handler(myrobot)),\n])\n\nif __name__ == \"__main__\":\n    application.listen(8888)\n    tornado.ioloop.IOLoop.instance().start()\n</code></pre>"},{"location":"tutorial/contribution-guide.html","title":"\u8d21\u732e\u6307\u5357","text":""},{"location":"tutorial/contribution-guide.html#\u8d21\u732e\u6307\u5357","title":"\u8d21\u732e\u6307\u5357","text":"<p>\u6709\u8bb8\u591a\u79cd\u4e3a ZgRoBot \u505a\u8d21\u732e\u7684\u65b9\u5f0f\uff0c \u5305\u62ec\u4f46\u5e76\u4e0d\u4ec5\u9650\u4e8e</p> <ul> <li>\u4e0a\u62a5 bug</li> <li>\u63d0\u4ea4 Feature Request</li> <li>\u628a ZgRoBot \u5b89\u5229\u7ed9\u4f60\u5468\u56f4\u7684\u4eba :)</li> </ul>"},{"location":"tutorial/contribution-guide.html#\u8d21\u732e\u4ee3\u7801","title":"\u8d21\u732e\u4ee3\u7801","text":"<p>\u5982\u679c\u4f60\u5e0c\u671b\u4e3a ZgRoBot \u8d21\u732e\u4ee3\u7801\uff0c \u8bf7\u73b0\u5728 GitHub \u4e0a Fork ZgRobot \u4ed3\u5e93\uff0c \u7136\u540e \\ \u5728 <code>develop</code> \u5206\u652f\u4e0a\u5f00\u4e00\u4e2a\u65b0\u7684\u5206\u652f\u3002</p> <p>Note</p> <p>\u8bf7\u6ce8\u610f\uff0c\u662f\u5728 <code>develop</code> \u5206\u652f\u4e0a\u65b0\u5efa\u5206\u652f\uff0c<code>master</code> \u5206\u652f\u4ec5\u5141\u8bb8\u6765\u81ea <code>develop</code> \u5206\u652f\u7684\u5408\u5e76\u3002</p> <p>\u5982\u679c\u4f60\u7684\u8d21\u732e\u7684\u4ee3\u7801\u662f\u4fee\u590d Bug \uff0c \u8bf7\u786e\u8ba4\u8fd9\u4e2a Bug \u5df2\u7ecf\u6709\u4e86\u5bf9\u5e94\u7684 Issue \uff08\u5982\u679c\u6ca1\u6709\uff0c \u8bf7\u5148\u521b\u5efa\u4e00\u4e2a\uff09\uff1b \u7136\u540e\u5728 Pull Request \u7684\u63cf\u8ff0\u91cc\u9762\u5f15\u7528\u8fd9\u4e2a Bug \u7684 Issue ID \uff0c \u5c31\u50cf\u8fd9\u6837(\u5047\u8bbe Issue ID \u4e3a 153)</p> <pre><code>Fix #153\n</code></pre>"},{"location":"tutorial/contribution-guide.html#\u73af\u5883\u642d\u5efa","title":"\u73af\u5883\u642d\u5efa","text":"<p>\u5efa\u8bae\u4f7f\u7528 <code>virtualenv</code> \u521b\u5efa\u865a\u62df\u73af\u5883\u8fdb\u884c\u5f00\u53d1, \u7136\u540e\u5b89\u88c5\u5f00\u53d1\u73af\u5883\u9700\u8981\u7684 <code>packages</code>\u3002 \u5173\u4e8e Python \u7248\u672c, \u63a8\u8350\u4f7f\u7528 Python 3.11 \u8fdb\u884c\u5f00\u53d1\u3002</p> <p>\u5982\u679c\u4f7f\u7528\u7684\u662f 3.x \u7248\u672c</p> <pre><code>python -m venv .venv\n</code></pre> <p>\u5982\u679c\u662f\u5176\u4ed6\u7248\u672c</p> <pre><code># virtualenv is highly recommended.\nvirtualenv venv\n# Activate virtualenv.\nsource venv/bin/activate\n# Install dev packages.\npip install -r dev-requirements.txt\n</code></pre>"},{"location":"tutorial/contribution-guide.html#\u4ee3\u7801\u98ce\u683c","title":"\u4ee3\u7801\u98ce\u683c","text":"<p>\u6211\u4eec\u4f7f\u7528 yapf\u8fdb\u884c\u4ee3\u7801\u683c\u5f0f\u5316\u3002 \u5728\u63d0\u4ea4\u4ee3\u7801\u4e4b\u524d\uff0c\u8bf7\u683c\u5f0f\u5316\u4e00\u4e0b\u4f60\u7684\u4ee3\u7801</p> <p>\u5b89\u88c5 <code>yapf</code> <pre><code>pip install yapf\n</code></pre></p> <p>\u4ee3\u7801\u683c\u5f0f\u5316 <pre><code>yapf -i -p -r zgrobot/ tests/ *.py\n</code></pre></p> <p>\u4f60\u4e5f\u53ef\u4ee5 \u5b89\u88c5 yapf Pre-Commit Hook \u6765\u81ea\u52a8\u8fdb\u884c\u4ee3\u7801\u683c\u5f0f\u5316\u5de5\u4f5c\u3002</p>"},{"location":"tutorial/contribution-guide.html#\u6d4b\u8bd5","title":"\u6d4b\u8bd5","text":"<p>\u5728\u4ee3\u7801\u63d0\u4ea4\u4e4b\u524d, \u8bf7\u5148\u8fd0\u884c\u672c\u5730\u7684\u6d4b\u8bd5\u3002\u6bcf\u6b21\u63d0\u4ea4\u4e4b\u540e\u4f1a\u6709\u5728\u7ebf\u7684 CI \u8fd0\u884c\u66f4\u591a\u7248\u672c\u517c\u5bb9\u6027\u7684\u6d4b\u8bd5, \u8bf7\u5bc6\u5207\u5173\u6ce8\u6d4b\u8bd5\u7ed3\u679c\u3002</p> <pre><code>python setup.py test\n</code></pre> <p>\u5f53\u7136\u4e5f\u53ef\u4ee5\u4f7f\u7528 tox \u5728\u672c\u5730\u8fd0\u884c\u591a\u7248\u672c\u7684\u517c\u5bb9\u6027\u6d4b\u8bd5\u3002</p> <pre><code>tox\n</code></pre> <p>\u5982\u679c\u4f60\u7684 Pull Request \u6dfb\u52a0\u4e86\u65b0\u7684\u6a21\u5757\u6216\u8005\u529f\u80fd\uff0c\u8bf7\u4e3a\u8fd9\u4e9b\u4ee3\u7801\u6dfb\u52a0\u5fc5\u8981\u7684\u6d4b\u8bd5\u3002 \u6240\u6709\u7684\u6d4b\u8bd5\u6587\u4ef6\u90fd\u5728 tests \u6587\u4ef6\u5939\u4e0b\u3002</p> <p>\u5f53\u4e00\u5207\u5f00\u53d1\u5b8c\u6210\u4e4b\u540e, \u53ef\u4ee5\u53d1 Pull Request \u5230 <code>develop</code> \u5206\u652f, \u6211\u4eec\u4f1a\u4e3a\u4f60\u7684\u4ee3\u7801\u505a Review\u3002\u540c\u65f6 CI \u4e5f\u4f1a\u81ea\u52a8\u8fd0\u884c\u6d4b\u8bd5\u3002</p> <p>Note</p> <p>\u6211\u4eec\u53ea\u4f1a Merge \u901a\u8fc7\u4e86\u6d4b\u8bd5\u7684\u4ee3\u7801\u3002</p>"},{"location":"tutorial/deploy.html","title":"\u90e8\u7f72","text":"<p>\u6ce8\u610f</p> <p>\u672c\u8282\u6240\u8ba8\u8bba\u7684\u662f\u5c06 ZgRoBot \u4f5c\u4e3a\u72ec\u7acb\u670d\u52a1\u8fd0\u884c\u60c5\u51b5\u4e0b\u7684\u90e8\u7f72\u64cd\u4f5c\u3002 \u5982\u679c\u4f60\u5e0c\u671b\u5c06 ZgRoBot \u96c6\u6210\u5230\u5176\u4ed6 Web \u6846\u67b6\u5185\uff0c\u8bf7\u9605\u8bfb\u96c6\u6210</p>"},{"location":"tutorial/deploy.html#\u539f\u751f\u90e8\u7f72","title":"\u539f\u751f\u90e8\u7f72","text":"<p>\u4f60\u53ef\u4ee5\u5728<code>Config()</code> \u4e2d\u914d\u7f6e\u597d ZgRoBot \u9700\u8981\u76d1\u542c\u7684\u5730\u5740\u548c\u7aef\u53e3\u53f7\uff0c \u7136\u540e\u4f7f\u7528\u4f60\u751f\u6210\u7684 <code>robot</code> \u8c03\u7528 <code>ZgRoBot.run()</code> \u65b9\u6cd5\u6765\u542f\u52a8\u670d\u52a1\u5668\uff1a</p> bot.py<pre><code>import zgrobot\n\nrobot = zgrobot.ZgRoBot(token='tokenhere')\n\n@robot.handler\ndef echo(message):\n    return 'Hello World!'\n\nrobot.config['HOST'] = '0.0.0.0'\nrobot.config['PORT'] = 80\n\nrobot.run()\n</code></pre> <p>Tip</p> <p>\u4f60\u9700\u8981 root \u6216\u7ba1\u7406\u5458\u6743\u9650\u624d\u80fd\u76d1\u542c 1024 \u4ee5\u4e0b\u7684\u7aef\u53e3\u3002</p> <p>\u4f60\u53ef\u4ee5\u901a\u8fc7\u4f20\u9012 <code>server</code> \u53c2\u6570\u6765\u624b\u52a8\u6307\u5b9a\u4f7f\u7528\u7684\u670d\u52a1\u5668\uff1a</p> bot.py<pre><code>import zgrobot\n\nrobot = zgrobot.ZgRoBot(token='tokenhere')\n\n@robot.handler\ndef echo(message):\n    return 'Hello World!'\n\nrobot.config['HOST'] = '0.0.0.0'\nrobot.config['PORT'] = 80\n\nrobot.run(server='gevent')\n</code></pre> <p><code>server</code> \u652f\u6301\u4ee5\u4e0b\u51e0\u79cd\uff1a</p> <ul> <li>cgi</li> <li>flup</li> <li>wsgiref</li> <li>waitress</li> <li>cherrypy</li> <li>paste</li> <li>fapws3</li> <li>tornado</li> <li>gae</li> <li>twisted</li> <li>diesel</li> <li>meinheld</li> <li>gunicorn</li> <li>eventlet</li> <li>gevent</li> <li>rocket</li> <li>bjoern</li> <li>auto</li> </ul> <p>\u5f53 <code>server</code> \u4e3a <code>auto</code> \u65f6\uff0c ZgRoBot \u4f1a\u81ea\u52a8\u4f9d\u6b21\u5c1d\u8bd5\u4ee5\u4e0b\u51e0\u79cd\u670d\u52a1\u5668\uff1a</p> <ul> <li>Waitress</li> <li>Paste</li> <li>Twisted</li> <li>CherryPy</li> <li>WSGIRef</li> </ul> <p>\u6240\u4ee5\uff0c\u53ea\u8981\u4f60\u5b89\u88c5\u4e86\u76f8\u5e94\u7684\u670d\u52a1\u5668\u8f6f\u4ef6\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528 <code>zgrobot.run</code> \u76f4\u63a5\u8dd1\u5728\u751f\u4ea7\u73af\u5883\u4e0b\u3002</p> <p>Info</p> <p><code>server</code> \u7684\u9ed8\u8ba4\u503c\u4e3a <code>auto</code> \u3002</p> <p>Waring</p> <p>WSGIRef \u7684\u6027\u80fd\u975e\u5e38\u5dee\uff0c \u4ec5\u80fd\u7528\u4e8e\u5f00\u53d1\u73af\u5883\u3002 \u5982\u679c\u4f60\u8981\u5728\u751f\u4ea7\u73af\u5883\u4e0b\u90e8\u7f72 ZgRoBot \uff0c \u8bf7\u786e\u4fdd\u4f60\u5728\u4f7f\u7528\u5176\u4ed6 server \u3002</p>"},{"location":"tutorial/deploy.html#wsgi-http-server","title":"WSGI HTTP Server","text":"<p><code>zgrobot.wsgi</code> \u66b4\u9732\u4e86\u4e00\u4e2a WSGI Application \uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u4efb\u4f55\u4f60\u559c\u6b22\u7684 WSGI HTTP Server \u6765\u90e8\u7f72 ZgRoBot\u3002</p> <p>\u6bd4\u5982\uff0c \u5982\u679c\u4f60\u60f3\u7528 Gunicorn \u6765\u90e8\u7f72\uff1a</p> robot.py<pre><code>from zgrobot import ZgRoBot\nrobot = ZgRoBot()\n</code></pre> <p>\u90a3\u4e48\u4f60\u53ea\u9700\u8981\u5728 Shell \u4e0b\u8fd0\u884c:</p> <pre><code>gunicorn robot:robot.wsgi\n</code></pre> <p>\u5c31\u53ef\u4ee5\u4e86\u3002</p>"},{"location":"tutorial/deploy.html#supervisor-\u5b88\u62a4\u8fdb\u7a0b","title":"Supervisor \u5b88\u62a4\u8fdb\u7a0b","text":"<p>\u8bf7\u6ce8\u610f\uff0c <code>zgrobot.run</code> \u662f\u8dd1\u5728 \u975e\u5b88\u62a4\u8fdb\u7a0b\u6a21\u5f0f\u4e0b \u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e00\u65e6\u4f60\u5173\u95ed\u7ec8\u7aef\uff0c\u8fdb\u7a0b\u5c31\u4f1a\u81ea\u52a8\u9000\u51fa\u3002</p> <p>\u6211\u4eec\u5efa\u8bae\u60a8\u4f7f\u7528 Supervisor \u6765\u7ba1\u7406 ZgRoBot \u7684\u8fdb\u7a0b\u3002</p> <p>\u914d\u7f6e\u6587\u4ef6\u6837\u4f8b\uff1a supervisord.conf<pre><code>[program:wechat_robot]\ncommand = python /home/&lt;username&gt;/robot.py\nuser = &lt;username&gt;\nredirect_stderr = true\nstdout_logfile = /home/&lt;username&gt;/logs/robot.log\nstdout_errfile = /home/&lt;username&gt;/logs/robot_error.log\n</code></pre></p>"},{"location":"tutorial/deploy.html#nginx-\u53cd\u5411\u4ee3\u7406","title":"Nginx \u53cd\u5411\u4ee3\u7406","text":"<p>\u5fae\u4fe1\u670d\u52a1\u5668\u53ea\u652f\u630180\u7aef\u53e3\u7684\u673a\u5668\u4eba\u2014\u2014\u663e\u7136\uff0c\u4f60\u7684\u670d\u52a1\u5668\u4e0a\u4e0d\u4f1a\u53ea\u8dd1\u7740\u4e00\u4e2a\u5fae\u4fe1\u673a\u5668\u4eba\u3002\u5bf9\u4e8e\u8fd9\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u5efa\u8bae\u60a8\u4f7f\u7528 Nginx \u6765\u8fdb\u884c\u53cd\u5411\u4ee3\u7406\u3002</p> <p>Note</p> <p>\u5efa\u8bae\u65b0\u5efa\u4e00\u4e2a\u5b50\u914d\u7f6e\u6587\u4ef6\u5bf9\u673a\u5668\u4eba\u8fdb\u884c\u914d\u7f6e\uff0c\u5e76\u5728\u4e3b\u914d\u7f6e\u6587\u4ef6\u7684 <code>server</code> \u4e2d\u6dfb\u52a0 <code>include xxx/*.conf;</code> \uff08\u914d\u7f6e\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84\uff09\uff0c\u7136\u540e\u91cd\u65b0\u52a0\u8f7d <code>nginx</code> \u670d\u52a1\u3002</p> <p>\u914d\u7f6e\u6587\u4ef6\u6837\u4f8b\uff1a zgrobot.conf<pre><code>server {\n    server_name example.com;\n    listen 80;\n\n    location / {\n        proxy_pass_header Server;\n        proxy_redirect off;\n        proxy_pass http://127.0.0.1:12233;\n    }\n}\n</code></pre></p> <p>Note</p> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c ZgRoBot \u7684\u7aef\u53e3\u53f7\u4e3a 12233\u3002\u4f60\u5e94\u8be5\u5728\u5fae\u4fe1\u7ba1\u7406\u540e\u53f0\u4e2d\u5c06\u670d\u52a1\u5668\u5730\u5740\u8bbe\u4e3a <code>http://example.com</code> \u3002</p> <p>Tip</p> <p>\u66f4\u591a\u7684 <code>Nginx</code> \u914d\u7f6e\u8bf7\u53c2\u770b \u4e07\u5b57\u957f\u6587\u770bNginx\u914d\u7f6e\u8be6\u89e3!</p>"},{"location":"tutorial/develop.html","title":"\u5f00\u53d1","text":"<p>\u4f17\u6240\u5468\u77e5\uff0c\u5fae\u4fe1\u516c\u4f17\u53f7\u540e\u53f0\u7684\u670d\u52a1\u5668\u914d\u7f6e\u7684 URL \u5fc5\u987b\u4ee5http://\u6216https://\u5f00\u5934\uff0c\u4ec5\u652f\u630180\u7aef\u53e3\u548c443\u7aef\u53e3\uff0c\u4f46\u662f\u6211\u4eec\u4e00\u822c\u90fd\u662f\u672c\u5730\u5f00\u53d1\u5b8c\u6210\u4e4b\u540e\u518d\u90e8\u7f72\u81f3\u670d\u52a1\u5668\u7aef\uff0c\u90a3\u672c\u5730\u5f00\u53d1\u8be5\u600e\u4e48\u8c03\u8bd5\u5462\uff1f\u8fd9\u5c31\u9700\u8981\u4f7f\u7528\u5185\u7f51\u7a7f\u900f\u5de5\u5177\u4e86</p> <p>\u77e5\u4e4e\u63a8\u8350\u5185\u7f51\u7a7f\u900f\u5de5\u5177</p>"},{"location":"tutorial/encryption.html","title":"\u6d88\u606f\u52a0\u89e3\u5bc6","text":"<p>ZgRoBot \u652f\u6301\u5bf9\u6d88\u606f\u7684\u52a0\u89e3\u5bc6\uff0c\u5373\u5fae\u4fe1\u516c\u4f17\u53f7\u7684\u5b89\u5168\u6a21\u5f0f\u3002 \u5728\u5f00\u542f\u6d88\u606f\u52a0\u89e3\u5bc6\u529f\u80fd\u4e4b\u524d\uff0c\u8bf7\u5148\u9605\u8bfb\u5fae\u4fe1\u5b98\u65b9\u7684 \u6d88\u606f\u52a0\u89e3\u5bc6\u8bf4\u660e</p> <p>\u4e3a ZgRoBot \u5f00\u542f\u6d88\u606f\u52a0\u5bc6\u529f\u80fd\uff0c\u9996\u5148\u9700\u8981\u5b89\u88c5 <code>cryptography</code></p> <pre><code>pip install cryptography\n</code></pre> <p>\u4e4b\u540e\uff0c \u4f60\u53ea\u9700\u8981\u5c06\u5f00\u53d1\u8005 ID( <code>AppID</code> ) \u548c\u5fae\u4fe1\u516c\u4f17\u5e73\u53f0\u540e\u53f0\u8bbe\u7f6e\u7684 <code>EncodingAESKey</code> \u52a0\u5230 ZgRoBot \u7684 <code>Config</code> \u91cc\u9762\u5c31\u53ef\u4ee5\u4e86\u3002</p> bot.py<pre><code>from zgrobot import ZgRoBot\nrobot = ZgRoBot()\nrobot.config[\"APP_ID\"] = \"Your AppID\"\nrobot.config['ENCODING_AES_KEY'] = 'Your Encoding AES Key'\n</code></pre> <p>ZgRoBot \u4e4b\u540e\u4f1a\u81ea\u52a8\u8fdb\u884c\u6d88\u606f\u7684\u52a0\u89e3\u5bc6\u5de5\u4f5c\u3002</p>"},{"location":"tutorial/error-page.html","title":"\u9519\u8bef\u9875\u9762","text":"<p><code>ZgRoBot</code> \u81ea\u5e26\u4e86\u4e00\u4e2a\u9519\u8bef\u9875\u9762\uff0c\u5b83\u5c06\u4f1a\u5728 Signature \u9a8c\u8bc1\u4e0d\u901a\u8fc7\u7684\u65f6\u5019\u8fd4\u56de\u9519\u8bef\u9875\u9762\u3002</p>"},{"location":"tutorial/error-page.html#\u5b9a\u5236\u9519\u8bef\u9875\u9762","title":"\u5b9a\u5236\u9519\u8bef\u9875\u9762","text":"<p>\u5982\u679c\u4f60\u60f3\u4e3a <code>ZgRoBot</code> \u6307\u5b9a Signature \u9a8c\u8bc1\u4e0d\u901a\u8fc7\u65f6\u663e\u793a\u7684\u9519\u8bef\u9875\u9762\uff0c\u53ef\u4ee5\u8fd9\u4e48\u505a:</p> <pre><code>@robot.error_page\ndef make_error_page(url):\n    return \"&lt;h1&gt;\u55b5\u55b5\u55b5 %s \u4e0d\u662f\u7ed9\u9ebb\u74dc\u8bbf\u95ee\u7684\u5feb\u8d70\u5f00&lt;/h1&gt;\" % url\n</code></pre>"},{"location":"tutorial/examples.html","title":"\u4f8b\u5b50","text":""},{"location":"tutorial/examples.html#helloworld","title":"HelloWorld","text":"helloworld.py<pre><code>import zgrobot\n\nrobot = zgrobot.ZgRoBot(token='tokenhere')\n\n@robot.filter(\"\u5e2e\u52a9\")\ndef show_help(message):\n    return \"\"\"\n    \u5e2e\u52a9\n    XXXXX\n    \"\"\"\n\n@robot.text\ndef hello_world(message):\n    return 'Hello World!'\n\nrobot.run()\n</code></pre>"},{"location":"tutorial/examples.html#\u5173\u6ce8\u56de\u590d","title":"\u5173\u6ce8\u56de\u590d","text":"fork.py<pre><code>import zgrobot\n\nrobot = zgrobot.ZgRoBot(token='tokenhere')\n\n# \u5173\u6ce8\u56de\u590d\n@robot.subscribe\ndef subscribe_reply(message):\n    return \"\u611f\u8c22\u8fd9\u4f4d\u5c0f\u53ef\u7231\u7684\u5173\u6ce8~\"\n\nrobot.run()\n</code></pre>"},{"location":"tutorial/examples.html#\u5feb\u901f\u56de\u590d\u56fe\u7247","title":"\u5feb\u901f\u56de\u590d\u56fe\u7247","text":"image.py<pre><code>import zgrobot\n\nrobot = zgrobot.ZgRoBot(token='tokenhere')\n\n# \u56fe\u7247\u56de\u590d\uff0c\u56de\u590d\u539f\u56fe\u7247\n@robot.image\ndef img_reply(message):\n    return ImageReply(message=message, media_id=message.media_id)\n\nrobot.run()\n</code></pre>"},{"location":"tutorial/examples.html#\u5173\u952e\u8bcd\u56de\u590d","title":"\u5173\u952e\u8bcd\u56de\u590d","text":"keyword.py<pre><code>import zgrobot\n\nrobot = zgrobot.ZgRoBot(token='tokenhere')\n\n# \u5173\u952e\u8bcd\u56de\u590d\n@robot.filter(\"\u4f60\u597d\u5440\")\ndef key_reply(message):\n    return \"\u4f60\u4e5f\u597d\u5440\"\n\nrobot.run()\n</code></pre>"},{"location":"tutorial/examples.html#\u591a\u6b21\u56de\u590d","title":"\u591a\u6b21\u56de\u590d","text":"keyword.py<pre><code>import zgrobot\n\nrobot = zgrobot.ZgRoBot(token='tokenhere')\nmy_client = robot.client\n\n# \u591a\u6b21\u56de\u590d\n@robot.filter(\"\u591a\u6b21\u56de\u590d\")\ndef reply_again(message):\n    kf_account = my_client.get_custom_service_account_list().get(\"kf_list\")\n    my_client.send_text_message(user_id=message.source, content=\"\u8fd9\u662f\u5ba2\u670d\u53d1\u7684\u6d88\u606f\", kf_account=kf_account)\n    return \"\u8fd9\u662f\u7b2c\u4e8c\u6b21\u56de\u590d\u54e6\"\n\nrobot.run()\n</code></pre>"},{"location":"tutorial/examples.html#\u5bfc\u5165\u5176\u4ed6\u6587\u4ef6","title":"\u5bfc\u5165\u5176\u4ed6\u6587\u4ef6","text":"<p>\u5982\u679c\u4f60\u4e3a\u4e86\u4fdd\u8bc1\u4f60\u7684 <code>bot.py</code> \uff08\u6216\u8005\u5176\u4ed6\uff09\u6587\u4ef6\u7684\u5e72\u51c0\u6574\u6d01\uff0c\u6216\u8005\u4e0d\u60f3\u5c06\u6240\u6709\u7684\u529f\u80fd\u90fd\u5199\u5230\u4e00\u4e2a\u6587\u4ef6\u91cc\u9762\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5c06\u5176\u4ed6\u7684\u529f\u80fd\u5199\u5230\u5176\u4ed6\u7684\u6587\u4ef6\u5185\uff0c\u53ea\u5728\u6267\u884c\u6587\u4ef6\u5185\u8fdb\u884c\u673a\u5668\u4eba\u7684\u521b\u5efa\u3001\u914d\u7f6e\u548c\u529f\u80fd\u7684\u5bfc\u5165\uff0c\u4f60\u53ef\u4ee5\u5411\u4e0b\u9762\u4e00\u6837\uff1a</p> bot.py<pre><code>import zgrobot\nimport menu\n\nrobot = zgrobot.ZgRoBot(token='tokenhere')\nmy_client = robot.client\n\nmenu.create_menu(robot, my_client)\n\nrobot.run()\n</code></pre> menu.py<pre><code>import zgrobot\nfrom zgrobot.client import Client\n\n\ndef create_menu(robot: zgrobot.ZgRoBot, client: Client):\n    client.create_menu({\n        \"button\": [\n            {\n                \"type\": \"miniprogram\",\n                \"name\": \"\u6253\u5361\",\n                \"url\": \"https://www.dengtadaka.com/website/index.html\",\n                \"appid\": \"wxf3ca7ea27608450c\",\n                \"pagepath\": \"/pages/supervise/groupDetail?id=10025\"\n            },\n            {\n                \"type\": \"view\",\n                \"name\": \"\u4e3b\u9875\",\n                \"url\": \"https://mp.weixin.qq.com/s?__biz=Mzg3NzU1MjgxOA==&amp;mid=100002639&amp;idx=1&amp;sn\"\n                       \"=3d7e9959038e0a3d01fa3f76ba715200&amp;chksm\"\n                       \"=4f207e927857f78482f85af737e719c3eef35afcba6e58510bc65a6296284c2999fda51babf0#rd \"\n            },\n            {\n                \"type\": \"click\",\n                \"name\": \"\u5e2e\u52a9\",\n                \"key\": \"help\"\n            }]\n    })\n\n    @robot.key_click(\"help\")\n    def music():\n        return \"\u73b0\u5728\u8fd8\u6ca1\u6709\u4ec0\u4e48\u5e2e\u52a9\u54e6~\"\n</code></pre>"},{"location":"tutorial/handlers.html","title":"\u5904\u7406\u5668","text":""},{"location":"tutorial/handlers.html#\u6dfb\u52a0\u5904\u7406\u5668","title":"\u6dfb\u52a0\u5904\u7406\u5668","text":"<p>ZgRoBot \u4f1a\u5c06\u5408\u6cd5\u7684\u8bf7\u6c42\u53d1\u9001\u7ed9 <code>Handlers</code> \u4f9d\u6b21\u6267\u884c\u3002</p> <p>\u5982\u679c\u67d0\u4e00\u4e2a <code>Handler</code> \u8fd4\u56de\u4e86\u975e\u7a7a\u503c\uff0c ZgRoBot \u5c31\u4f1a\u6839\u636e\u8fd9\u4e2a\u503c\u521b\u5efa\u56de\u590d\uff0c\u540e\u9762\u7684 <code>handlers</code> \u5c06\u4e0d\u4f1a\u88ab\u6267\u884c\u3002</p> <p>\u4f60\u53ef\u4ee5\u901a\u8fc7\u4fee\u9970\u7b26\u6216<code>add_handler</code>\u6dfb\u52a0 <code>handler</code></p> bot.py<pre><code>import zgrobot\n\nrobot = zgrobot.ZgRoBot(token='tokenhere')\n\n# \u901a\u8fc7\u4fee\u9970\u7b26\u6dfb\u52a0handler\n@robot.handler\ndef echo(message):\n    return 'Hello World!'\n\n# \u901a\u8fc7`add_handler`\u6dfb\u52a0handler\ndef echo(message):\n    return 'Hello World!'\nrobot.add_handler(echo)\n</code></pre>"},{"location":"tutorial/handlers.html#\u7c7b\u578b\u8fc7\u6ee4","title":"\u7c7b\u578b\u8fc7\u6ee4","text":"<p>\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c \u4e00\u4e2a <code>Handler</code> \u5e76\u4e0d\u80fd\u5904\u7406\u6240\u6709\u7c7b\u578b\u7684\u6d88\u606f\u3002\u5e78\u8fd0\u7684\u662f\uff0c ZgRoBot \u53ef\u4ee5\u5e2e\u4f60\u8fc7\u6ee4\u6536\u5230\u7684\u6d88\u606f\u3002</p> <p>\u53ea\u60f3\u5904\u7406\u88ab\u65b0\u7528\u6237\u5173\u6ce8\u7684\u6d88\u606f\uff1f</p> bot.py<pre><code>import zgrobot\n\nrobot = zgrobot.ZgRoBot(token='tokenhere')\n\n@robot.subscribe\ndef subscribe(message):\n    return 'Hello My Friend!'\n\nrobot.run()\n</code></pre> <p>\u6216\u8005\uff0c\u4f60\u7684 <code>Handler</code> \u53ea\u5411\u7528\u6765\u5904\u7406\u6587\u672c\uff1f</p> bot.py<pre><code>import zgrobot\n\nrobot = zgrobot.ZgRoBot(token='tokenhere')\n\n@robot.text\ndef echo(message):\n    return message.content\n\nrobot.run()\n</code></pre> <p>\u989d\uff0c\u8fd9\u4e2a <code>handler</code> \u60f3\u5904\u7406\u6587\u672c\u4fe1\u606f\u548c\u5730\u7406\u4f4d\u7f6e\u4fe1\u606f\uff1f </p> bot.py<pre><code>import zgrobot\n\nrobot = zgrobot.ZgRoBot(token='tokenhere')\n\n@robot.text\n@robot.location\ndef handler(message):\n    # Do what you love to do\n    pass\n\nrobot.run()\n</code></pre> <p>\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u7528 <code>add_handler</code> \u51fd\u6570\u6dfb\u52a0handler\uff0c\u5c31\u50cf\u8fd9\u6837\uff1a</p> bot.py<pre><code>import zgrobot\n\nrobot = zgrobot.ZgRoBot(token='tokenhere')\n\ndef handler(message):\n    # Do what you love to do\n    pass\n\nrobot.add_handler(handler, type='text')\nrobot.add_handler(handler, type='location')\n\nrobot.run()\n</code></pre> <p>Note</p> <p>\u901a\u8fc7 <code>add_handler</code> \u6dfb\u52a0\u7684 handler \u5c06\u6536\u5230\u6240\u6709\u4fe1\u606f\uff0c\u5e76\u4e14\u53ea\u6709\u5728\u5176\u5b83 handler \u6ca1\u6709\u7ed9\u51fa\u8fd4\u56de\u503c\u7684\u60c5\u51b5\u4e0b\uff0c\u901a\u8fc7 <code>add_handler</code> \u6dfb\u52a0\u7684 handler \u624d\u4f1a\u88ab\u8c03\u7528\u3002</p> <p>\u5728 ZgRobot \u4e2d\u6211\u4eec\u628a\u8bf7\u6c42\u5206\u6210\u4e86 <code>messages</code> \u548c <code>events</code> \u4e24\u79cd\u7c7b\u578b,\u9488\u5bf9\u4e24\u79cd\u7c7b\u578b\u7684\u8bf7\u6c42\u5206\u522b\u6709\u4e0d\u540c\u7684 <code>Handler</code>\u3002</p>"},{"location":"tutorial/handlers.html#\u81ea\u5b9a\u4e49\u83dc\u5355\u7684\u5904\u7406\u5668","title":"\u81ea\u5b9a\u4e49\u83dc\u5355\u7684\u5904\u7406\u5668","text":"<p>\u4f60\u53ef\u4ee5\u4f7f\u7528 <code>key_click</code> \u56de\u5e94\u81ea\u5b9a\u4e49\u83dc\u5355\u3002</p> <p><code>key_click</code> \u662f\u5bf9 <code>click</code> \u4fee\u9970\u7b26\u7684\u6539\u8fdb\u3002</p> <p>\u5982\u679c\u4f60\u5728\u81ea\u5b9a\u4e49\u83dc\u5355\u4e2d\u5b9a\u4e49\u4e86\u4e00\u4e2a Key \u4e3a <code>abort</code> \u7684\u83dc\u5355\uff0c\u54cd\u5e94\u8fd9\u4e2a\u83dc\u5355\u7684 <code>handler</code> \u53ef\u4ee5\u5199\u6210\u8fd9\u6837\uff1a</p> bot.py<pre><code>@robot.key_click(\"abort\")\ndef abort():\n    return \"I'm a robot\"\n</code></pre> <p>\u5f53\u7136\uff0c\u5982\u679c\u4f60\u4e0d\u559c\u6b22\u7528 <code>key_click</code> \uff0c\u4e5f\u53ef\u4ee5\u5199\u6210\u8fd9\u6837</p> bot.py<pre><code>@robot.click\ndef abort(message):\n    if message.key == \"abort\":\n        return \"I'm a robot\"\n</code></pre> <p>\u4e24\u8005\u662f\u7b49\u4ef7\u7684\u3002</p>"},{"location":"tutorial/handlers.html#\u6587\u672c\u8fc7\u6ee4\u5668","title":"\u6587\u672c\u8fc7\u6ee4\u5668","text":"<p>\u4f60\u53ef\u4ee5\u4f7f\u7528 <code>filter</code> \u56de\u5e94\u6709\u6307\u5b9a\u6587\u672c\u7684\u6d88\u606f\uff0c<code>filter</code> \u662f\u5bf9 <code>text</code> \u4fee\u9970\u7b26\u7684\u6539\u8fdb\u3002</p> <p>\u73b0\u5728\u4f60\u53ef\u4ee5\u5199\u8fd9\u6837\u7684\u4ee3\u7801\uff1a</p> bot.py<pre><code>@robot.filter(\"a\")\ndef a():\n    return \"\u6b63\u6587\u4e3a a \"\n\nimport re\n\n\n@robot.filter(re.compile(\".*?bb.*?\"))\ndef b():\n    return \"\u6b63\u6587\u4e2d\u542b\u6709 bb \"\n\n@robot.filter(re.compile(\".*?c.*?\"), \"d\")\ndef c():\n    return \"\u6b63\u6587\u4e2d\u542b\u6709 c \u6216\u6b63\u6587\u4e3a d\"\n\n@robot.filter(re.compile(\"(.*)?e(.*)?\"), \"f\")\ndef d(message, session, match):\n    if match:\n        return \"\u6b63\u6587\u4e3a \" + match.group(1) + \"e\" + match.group(2)\n    return \"\u6b63\u6587\u4e3a f\"\n</code></pre> <p>\u8fd9\u6bb5\u4ee3\u7801\u7b49\u4ef7\u4e8e </p> bot.py<pre><code>@robot.text\ndef a(message):\n    if message.content == \"a\":\n        return \"\u6b63\u6587\u4e3a a \"\nimport re\n\n\n@robot.text\ndef b(message):\n    if re.compile(\".*?bb.*?\").match(message.content):\n        return \"\u6b63\u6587\u4e2d\u542b\u6709 b \"\n\n@robot.text\ndef c(message):\n    if re.compile(\".*?c.*?\").match(message.content) or message.content == \"d\":\n        return \"\u6b63\u6587\u4e2d\u542b\u6709 c \u6216\u6b63\u6587\u4e3a d\"\n\n@robot.text\ndef d(message):\n    match = re.compile(\"(.*)?e(.*)?\").match(message.content)\n    if match:\n        return \"\u6b63\u6587\u4e3a \" + match.group(1) + \"e\" + match.group(2)\n    if  message.content == \"f\":\n        return \"\u6b63\u6587\u4e3a f\"\n</code></pre> <p>\u5982\u679c\u4f60\u60f3\u901a\u8fc7\u4fee\u9970\u7b26\u4ee5\u5916\u7684\u65b9\u6cd5\u6dfb\u52a0 filter\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>add_filter</code> \u65b9\u6cd5\uff1a</p> bot.py<pre><code>def say_hello():\n    return \"hello!\"\n\nrobot.add_filter(func=say_hello, rules=[\"hello\", \"hi\", re.compile(\".*?hello.*?\")])\n</code></pre> <p>\u66f4\u591a\u5185\u5bb9\u8be6\u89c1 <code>BaseRoBot()</code></p>"},{"location":"tutorial/session.html","title":"\u4f1a\u8bdd","text":""},{"location":"tutorial/session.html#session","title":"Session","text":"<p>\u4f60\u53ef\u4ee5\u901a\u8fc7 <code>Session</code> \u5b9e\u73b0\u7528\u6237\u72b6\u6001\u7684\u8bb0\u5f55\u3002</p> <p>\u4e00\u4e2a\u7b80\u5355\u7684\u4f7f\u7528 <code>Session</code> \u7684 Demo</p> bot.py<pre><code>from zgrobot import ZgRoBot\nrobot = ZgRoBot(token=zgrobot.utils.generate_token())\n\n@robot.text\ndef first(message, session):\n    if 'last' in session:\n        return\n    session['last'] = message.content\n    return message.content\n\nrobot.run()\n</code></pre>"},{"location":"tutorial/session.html#\u5f00\u542f\u5173\u95ed-session","title":"\u5f00\u542f/\u5173\u95ed Session","text":"<p>Session \u5728 ZgRoBot \u4e2d\u9ed8\u8ba4\u5f00\u542f\uff0c \u5e76\u4f7f\u7528 <code>SQLiteStorage()</code> \u4f5c\u4e3a\u5b58\u50a8\u540e\u7aef\u3002 \u5982\u679c\u60f3\u8981\u66f4\u6362\u5b58\u50a8\u540e\u7aef\uff0c\u53ef\u4ee5\u4fee\u6539 <code>config</code> \u4e2d\u7684 <code>SESSION_STORAGE</code> \u503c\uff1a</p> bot.py<pre><code>from zgrobot import ZgRoBot\nfrom zgrobot.session.filestorage import FileStorage\nrobot = ZgRoBot(token=\"token\")\nrobot.config['SESSION_STORAGE'] = FileStorage()\n</code></pre> <p>\u5982\u679c\u60f3\u8981\u5173\u95ed Session \u529f\u80fd\uff0c \u53ea\u9700\u628a <code>SESSION_STORAGE</code> \u8bbe\u4e3a <code>False</code> \u5373\u53ef</p> bot.py<pre><code>from zgrobot import ZgRoBot\nrobot = ZgRoBot(token=\"token\")\nrobot.config['SESSION_STORAGE'] = False\n</code></pre>"},{"location":"tutorial/session.html#\u4fee\u6539-handler-\u4ee5\u4f7f\u7528-session","title":"\u4fee\u6539 Handler \u4ee5\u4f7f\u7528 Session","text":"<p>\u6ca1\u6709\u6253\u5f00 <code>Session</code> \u7684\u65f6\u5019\uff0c\u4e00\u4e2a\u6807\u51c6\u7684 ZgRoBot <code>Handler</code> \u5e94\u8be5\u662f\u8fd9\u6837\u7684</p> bot.py<pre><code>@robot.text\ndef hello(message):\n    return \"Hello!\"\n</code></pre> <p>\u800c\u5728\u6253\u5f00 <code>Session</code> \u4e4b\u540e\uff0c \u5982\u679c\u4f60\u7684 <code>handler</code> \u4e0d\u9700\u8981\u4f7f\u7528 <code>Session</code> \uff0c\u53ef\u4ee5\u4fdd\u6301\u4e0d\u53d8\uff1b \u5982\u679c\u9700\u8981\u4f7f\u7528 <code>Session</code> \uff0c\u5219\u8fd9\u4e2a <code>Handler</code> \u9700\u8981\u4fee\u6539\u4e3a\u63a5\u53d7\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff1a <code>session</code>\u3002</p> bot.py<pre><code>@robot.subscribe_event\ndef intro(message):\n    return \"Hello!\"\n\n@robot.text\ndef hello(message, session):\n    count = session.get(\"count\", 0) + 1\n    session[\"count\"] = count\n    return \"Hello! You have sent %s messages to me\" % count\n</code></pre> <p>\u4f20\u5165\u7684 <code>session</code> \u53c2\u6570\u662f\u4e00\u4e2a\u6807\u51c6\u7684 Python \u5b57\u5178\u3002</p> <p>\u66f4\u591a\u53ef\u7528\u7684 Session Storage \u8be6\u89c1 <code>Session \u5bf9\u8c61</code>\u3002</p>"},{"location":"tutorial/start.html","title":"\u5f00\u59cb","text":""},{"location":"tutorial/start.html#hello-world","title":"Hello World","text":"<p>\u6700\u7b80\u5355\u7684 <code>Hello World</code> \u4f8b\u5b50\uff0c \u4f1a\u7ed9\u6536\u5230\u7684\u6bcf\u4e00\u6761\u4fe1\u606f\u56de\u590d <code>Hello World</code></p> hello.py<pre><code>import zgrobot\n\nrobot = zgrobot.ZgRoBot(token='tokenhere')\n\n@robot.text\ndef hello_world(message):\n    return 'Hello World!'\n\nif __name__ == '__main__':\n    # \u8ba9\u670d\u52a1\u5668\u76d1\u542c\u5728 127.0.0.1:8080\n    robot.run(host='127.0.0.1', port=8080)\n</code></pre>"},{"location":"tutorial/start.html#\u6d88\u606f\u5904\u7406","title":"\u6d88\u606f\u5904\u7406","text":"<p>ZgRoBot \u4f1a\u89e3\u6790\u5fae\u4fe1\u670d\u52a1\u5668\u53d1\u6765\u7684\u6d88\u606f\uff0c \u5e76\u5c06\u6d88\u606f\u8f6c\u6362\u6210\u6210<code>Message</code> \u6216\u8005\u662f<code>Event</code> \u3002</p> <p><code>Message</code> \u8868\u793a\u7528\u6237\u53d1\u6765\u7684\u6d88\u606f\uff0c\u5982\u6587\u672c\u6d88\u606f\u3001\u56fe\u7247\u6d88\u606f\uff1b<code>Event</code> \u5219\u8868\u793a\u7528\u6237\u89e6\u53d1\u7684\u4e8b\u4ef6\uff0c \u5982\u5173\u6ce8\u4e8b\u4ef6\u3001\u626b\u63cf\u4e8c\u7ef4\u7801\u4e8b\u4ef6\u3002</p> <p>\u5728\u6d88\u606f\u89e3\u6790\u3001\u8f6c\u6362\u5b8c\u6210\u540e\uff0c ZgRoBot \u4f1a\u5c06\u6d88\u606f\u8f6c\u4ea4\u7ed9<code>Handler</code> \u8fdb\u884c\u5904\u7406\uff0c\u5e76\u5c06<code>Handler</code> \u7684\u8fd4\u56de\u503c\u8fd4\u56de\u7ed9\u5fae\u4fe1\u670d\u52a1\u5668\u3002</p> <p>\u5728\u521a\u624d\u7684 Hello World \u4e2d\uff0c \u6211\u4eec\u7f16\u5199\u7684\uff1a</p> hello.py<pre><code>@robot.text\ndef hello_world(message):\n    return 'Hello World!'\n</code></pre> <p>\u5c31\u662f\u4e00\u4e2a\u7b80\u5355\u7684<code>Handler</code> \uff0c <code>@robot.handler</code> \u610f\u5473\u7740 <code>robot</code> \u4f1a\u5c06\u6240\u6709\u63a5\u6536\u5230\u7684\u6d88\u606f\uff08 \u5305\u62ec<code>Message</code> \u548c<code>Event</code> \uff09 \u90fd\u8f6c\u4ea4\u7ed9\u8fd9\u4e2a<code>Handler</code> \u6765\u5904\u7406\u3002 \u5f53\u7136\uff0c \u4f60\u4e5f\u53ef\u4ee5\u7f16\u5199\u4e00\u4e9b\u53ea\u80fd\u5904\u7406\u7279\u5b9a\u6d88\u606f\u7684<code>Handler</code>\uff1a </p> handler.py<pre><code># @robot.text \u4fee\u9970\u7684 Handler \u53ea\u5904\u7406\u6587\u672c\u6d88\u606f\n@robot.text\ndef echo(message):\n    return message.content\n\n# @robot.image \u4fee\u9970\u7684 Handler \u53ea\u5904\u7406\u56fe\u7247\u6d88\u606f\n@robot.image\ndef img(message):\n    return message.img\n</code></pre>"},{"location":"tutorial/start.html#\u4f7f\u7528-session-\u8bb0\u5f55\u7528\u6237\u72b6\u6001","title":"\u4f7f\u7528 Session \u8bb0\u5f55\u7528\u6237\u72b6\u6001","text":"<p>ZgRoBot \u63d0\u4f9b\u4e86<code>Session</code> \u529f\u80fd\uff0c \u53ef\u4ee5\u8ba9\u4f60\u65b9\u4fbf\u7684\u8bb0\u5f55\u7528\u6237\u72b6\u6001\u3002 \u6bd4\u5982\uff0c \u8fd9\u4e2a<code>Handler</code> \u53ef\u4ee5\u5224\u65ad\u53d1\u6d88\u606f\u7684\u7528\u6237\u4e4b\u524d\u6709\u6ca1\u6709\u53d1\u9001\u8fc7\u6d88\u606f</p> session.py<pre><code>@robot.text\n    def first(message, session):\n        if 'first' in session:\n            return '\u4f60\u4e4b\u524d\u7ed9\u6211\u53d1\u8fc7\u6d88\u606f'\n        session['first'] = True\n        return '\u4f60\u4e4b\u524d\u6ca1\u7ed9\u6211\u53d1\u8fc7\u6d88\u606f'\n</code></pre> <p>Note</p> <p><code>Session</code> \u529f\u80fd\u9ed8\u8ba4\u5f00\u542f\uff0c \u5e76\u4f7f\u7528 <code>SQLite</code> \u5b58\u50a8 <code>Session</code> \u6570\u636e\u3002 \u8be6\u60c5\u8bf7\u53c2\u8003 <code>session</code> \u6587\u6863</p>"},{"location":"tutorial/start.html#\u521b\u5efa\u81ea\u5b9a\u4e49\u83dc\u5355","title":"\u521b\u5efa\u81ea\u5b9a\u4e49\u83dc\u5355","text":"<p>\u81ea\u5b9a\u4e49\u83dc\u5355\u80fd\u591f\u5e2e\u52a9\u516c\u4f17\u53f7\u4e30\u5bcc\u754c\u9762\uff0c\u8ba9\u7528\u6237\u66f4\u597d\u66f4\u5feb\u5730\u7406\u89e3\u516c\u4f17\u53f7\u7684\u529f\u80fd\u3002 <code>Client</code> \u5c01\u88c5\u4e86\u5fae\u4fe1\u7684\u90e8\u5206 API \u63a5\u53e3\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>Client.create_menu</code> \u6765\u521b\u5efa\u81ea\u5b9a\u4e49\u83dc\u5355\u3002\u5728\u4f7f\u7528 <code>Client</code> \u4e4b\u524d\uff0c \u6211\u4eec\u9700\u8981\u5148\u63d0\u4f9b\u5fae\u4fe1\u516c\u4f17\u5e73\u53f0\u5185\u7684 <code>AppID</code> \u548c <code>AppSecret</code> </p> menu.py<pre><code>from zgrobot import ZgRoBot\n\nrobot = ZgRoBot()\nrobot.config[\"APP_ID\"] = \"\u4f60\u7684 AppID\"\nrobot.config[\"APP_SECRET\"] = \"\u4f60\u7684 AppSecret\"\n\nclient = robot.client\n</code></pre> <p>\u7136\u540e\uff0c \u6211\u4eec\u5c31\u53ef\u4ee5\u521b\u5efa\u81ea\u5b9a\u4e49\u83dc\u5355\u4e86</p> menu.py<pre><code>client.create_menu({\n    \"button\":[{ \n         \"type\": \"click\",\n         \"name\": \"\u4eca\u65e5\u6b4c\u66f2\",\n         \"key\": \"music\"\n    }]\n})\n</code></pre> <p>\u6ce8\u610f\u4ee5\u4e0a\u4ee3\u7801\u53ea\u9700\u8981\u8fd0\u884c\u4e00\u6b21\u5c31\u53ef\u4ee5\u4e86\u3002\u5728\u521b\u5efa\u5b8c\u81ea\u5b9a\u4e49\u83dc\u5355\u4e4b\u540e\uff0c \u6211\u4eec\u8fd8\u9700\u8981\u5199\u4e00\u4e2a<code>handler</code> \u6765\u54cd\u5e94\u83dc\u5355\u7684\u70b9\u51fb\u64cd\u4f5c</p> menu.py<pre><code>@robot.key_click(\"music\")\n    def music(message):\n        return '\u4f60\u70b9\u51fb\u4e86\u201c\u4eca\u65e5\u6b4c\u66f2\u201d\u6309\u94ae'\n</code></pre>"},{"location":"tutorial/utils.html","title":"\u5c0f\u5de5\u5177","text":""},{"location":"tutorial/utils.html#token-\u751f\u6210\u5668","title":"Token \u751f\u6210\u5668","text":"<p>ZgRoBot \u5e2e\u4f60\u51c6\u5907\u4e86\u4e00\u4e2a <code>Token</code> \u751f\u6210\u5668</p> <pre><code>import zgrobot.utils\n\nprint(zgrobot.utils.generate_token())\n</code></pre>"}]}